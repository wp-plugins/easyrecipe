window.EASYRECIPE=window.EASYRECIPE||{};EASYRECIPE.widget=EASYRECIPE.widget||jQuery.widget;EASYRECIPE.button=EASYRECIPE.button||jQuery.fn.button;
(function(a){function Db(d,a){Qa.show();W.hide();Ra.show();switch(a.newTab?a.newTab.index():a.index){case 0:W.css("right","10px");W.show();break;case 3:W.css("right","inherit");Ra.hide();W.show();break;case 4:Qa.hide()}}function Sa(){ya.off("change",Sa);P=!0}function g(a){return a?(a+"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," "):""}function X(d){return d?a("<div />").text(d).html():""}function s(d){return a.trim(X(d.val()))||!1}function Eb(a,c){var b=za.tabs("option",
"active");za.tabs("option","active",++b)}function w(a){var c,b=/\[img +(.*?) *\/?\]/i,f=/\[url ([^\]]+)\](.*?\[\/url\])/i,e=/\[cap ([^\]]+)\](.*])(.*?)\[\/cap\]/i;if(""!==a){for(c=b.exec(a);null!==c;)Y.push(c[1].replace(/</g,"&lt;").replace(/>/g,"&gt;")),a=a.replace(b,"[img:"+Y.length+"]"),c=b.exec(a);for(c=f.exec(a);null!==c;)D.push(c[1]),a=a.replace(f,"[url:"+D.length+"]$2"),c=f.exec(a);for(c=e.exec(a);null!==c;)ga.push(c[1]),Ta.push(c[3].replace(/</g,"&lt;").replace(/>/g,"&gt;")),a=a.replace(e,
"[cap:"+ga.length+"]$2[/cap]"),c=e.exec(a)}return a}function x(a){var c,b,f=/\[img:(\d+)\]/i,e=/\[url:(\d+)\](.*?)\[\/url\]/i,n=/\[cap:(\d+)\](.*\])\[\/cap\]/i;if(a){for(b=f.exec(a);null!==b;)c=Y[b[1]-1].replace(/&quot;/g,"&amp;quot;"),a=a.replace(f,"[img "+c+"]"),b=f.exec(a);for(b=e.exec(a);null!==b;)c=D[b[1]-1],a=a.replace(e,"[url "+c+"]$2[/url]"),b=e.exec(a);for(b=n.exec(a);null!==b;)c=ga[b[1]-1],b=Ta[b[1]-1],a=a.replace(n,"[cap "+c+"]$2"+b+"[/cap]"),b=e.exec(a)}return a}function mb(a,c){var b,
f,e,n=0,l="",k,g,h,p,q;b=a;for(c=c||{};;){e=b.length;f=b.indexOf("#",n);-1!==f&&(e=f,k=0);f=b.indexOf("\x3c!-- START REPEAT ",n);-1!==f&&f<e&&(e=f,k=1);f=b.indexOf("\x3c!-- START INCLUDEIF ",n);-1!==f&&f<e&&(e=f,k=2);if(e===b.length)return l+b.substr(n);f=e-n;l+=b.substr(n,f);n=e;switch(k){case 2:e=b.substr(n,44);e=Fb.exec(e);if(null!==e)f=e[1],g="!"!==f,h=e[2];else break;p="\x3c!-- END INCLUDEIF "+f+h+" --\x3e";e=p.length;p=b.indexOf(p);if(-1===p){n++;break}q=typeof c[h]!==Aa&&!1!==c[h];q===g?(f=
"\x3c!-- START INCLUDEIF "+f+h+" --\x3e",f=f.length,b=b.substr(0,n)+b.substr(n+f,p-n-f)+b.substr(p+e)):b=b.substr(0,n)+b.substr(p+e);break;case 0:e=b.substr(n,22);e=Gb.exec(e);if(null===e){l+="#";n++;continue}e=e[1];if(""!==c[e]&&!c[e]){l+="#"+e+"#";n+=e.length+2;continue}l+=c[e];n+=e.length+2;break;case 1:e=b.substr(n,45);e=Hb.exec(e);if(null===e){l+="<";n++;continue}e=e[1];if(!(c[e]&&c[e]instanceof Array)){l+="<";n++;continue}n+=e.length+22;f=b.indexOf("\x3c!-- END REPEAT "+e+" --\x3e",n);if(-1===
f){l+="\x3c!-- START REPEAT "+e+" --\x3e";continue}g=f-n;p=b.substr(n,g);h=c[e];for(f=0;f<h.length;f++)l+=mb(p,h[f]);n+=e.length+g+20}}}function Ba(d){var c=a.trim(d.val()),b=0,f=0;Ua.hide();if(""===c)return!0;m=Va.exec(c);if(null===m){m=Ib.exec(c);if(null===m)return Ua.show(),!1;b=0;f=m[1]}else b=m[1]?parseInt(m[1],10):0,f=m[2]?parseInt(m[2],10):0;0===b&&0===f?d.val(""):(c=0<b?b+" hour":"",1<b&&(c+="s"),b=0<f?f+" min":"",1<f&&(b+="s"),d.val(a.trim(c+" "+b)));return!0}function nb(d){var c,b,f="";
for(c=0;c<d.length;c++)b=d[c],3===b.nodeType?(b=a.trim(b.nodeValue),""!==b&&(f+=b+"\n")):1===b.nodeType&&0<b.childNodes.length&&(f+=nb(b.childNodes));return f}function ob(){var d;a(Wa,t).remove();d=Q.selection.getNode();"#document"===d.nodeName&&(d=Ca[0]);if("BODY"===d.nodeName.toUpperCase())a(d).hasClass("mceContentBody")||(d=Ca[0]),/^<p><br[^>]*><\/p>$/.test(d.innerHTML)?a(d).prepend(ha):a(d).append("&nbsp;"+ha);else{for(;d.parentNode&&"BODY"!==d.parentNode.nodeName.toUpperCase();)d=d.parentNode;
d.parentNode?"DIV"===d.nodeName.toUpperCase()||"SPAN"===d.nodeName.toUpperCase()?a(d,t).after(ha):a(d,t).before(ha):(d=Ca[0],a(d).append("&nbsp;"+ha))}Z=-1;return a(Wa,t)}function Jb(a,c,b){}function Kb(d){switch(d.type){case "js":a("head").append(a('<script type="text/javascript">'+d.js+"\x3c/script>"));q[d.f]();break;case "html":a(d.dest).html(d.html)}}function Lb(){Da.unbind(F);Ea.unbind(F);R.dialog(K);Xa=!0;Ya()}function Mb(a,c){var b,f="",e;e=a.recipe;"success"!==c&&(R.dialog(K),Xa=!0,Ya());
L.val(g(e.recipe_title));y=e.recipe_image;M.val("");e.author?C.val(g(e.author)):C.val("");S.val(e.cuisine||"");M.val(e.mealType||"");Za.val("");N.val(g(e.summary));m=pb.exec(e.prep_time);null!==m?(b=m[1]?m[1]+"h ":"",z.val(b+m[2]+"m")):z.val(g(e.prep_time));m=pb.exec(e.cook_time);null!==m?(b=m[1]?m[1]+"h ":"",A.val(b+m[2]+"m")):A.val(g(e.cook_time));T.val(g(e.yield));$.val(g(e.serving_size));e.nutrition?(b=e.nutrition,aa.val(g(b.calories)),ba.val(g(b.totalFat)),ia.val(g(b.saturatedFat)),ja.val(g(b.unsaturatedFat)),
ka.val(g(b.transFat)),la.val(g(b.totalCarbohydrates)),ma.val(g(b.sugars)),na.val(g(b.sodium)),oa.val(g(b.dietaryFiber)),pa.val(g(b.protein)),qa.val(g(b.cholesterol))):(aa.val(g(e.calories)),ba.val(g(e.fat)));for(b=0;b<a.ingredients.length;b++)f+=Nb(g(a.ingredients[b]))+"\n";ra.val(f);sa.val(g(e.instructions.replace("\r","")));ta.val(g(e.notes));B.easyrecipeDialog("option","title","Update Recipe");R.dialog(K);Fa.hide();Ga.show();Ha.hide();""!==y&&qb(y,u.length,!0);h=ob();B.easyrecipeDialog(G)}function Ob(){Ia.show();
Da.unbind(F);Ea.unbind(F);a.post(ajaxurl,{action:"easyrecipeConvert",id:$a,type:Ja},Mb,"json")}function ab(d){var c,b,f=0,e="",n="",g="",k="",h=["instruction","method","cooking method","procedure","direction"];b=["ingredients?"];var v=["note","cooking note"],p,m;p=a.parseJSON(q.ingredients);m=a.parseJSON(q.instructions);c=a.parseJSON(q.notes);-1===a.inArray(p,b)&&b.push(p);p="^\\s*(?:"+b.join("|")+")";p=new RegExp(p,"i");-1===a.inArray(m,h)&&b.push(m);h="^\\s*(?:"+h.join("|")+")";h=new RegExp(h,"i");
-1===a.inArray(c,v)&&v.push(c);v="^\\s*(?:"+v.join("|")+")\\s*$";v=new RegExp(v,"i");d=a("<div>"+d+"</div>");d=nb(d[0].childNodes);d=d.split("\n");for(c=0;c<d.length;c++)if(b=a.trim(d[c]),""!==b)if(h.test(b))f=2;else if(p.test(b))f=1;else if(v.test(b))f=3;else switch(f){case 0:e+=b+"\n";break;case 1:n+=b+"\n";break;case 2:g+=b+"\n";break;case 3:k+=b+"\n"}return{summary:e,ingredients:n,instructions:g,notes:k}}function ca(d,c,b){H.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+
c+'" /></div>');u[c]=a("#ERPhoto_"+c,H);u[c].data("src",d);b&&(a(".ERPhoto",H).removeClass(da),u[c].parent().addClass(da),I=c,y=d);""===Ka&&(Ka=d);b=new Image;a.data(b,"index",c);b.onload=function(){var b,d,c=a.data(this,"index");b=this.width/150;d=this.height/112;b=b>d?b:d;d=Math.floor(this.height/b);b=Math.floor(this.width/b);u[c].height(d);u[c].width(b);u[c].css("top",(112-d)/2);u[c].attr("src",this.src);0===c&&a("#ERDTabs").find(".divERNoPhotos").remove()};b.src=d}function Pb(){ca(bb.val(),u.length,
!0);bb.val("");cb.hide();a(".divERNoPhotos").remove()}function La(a,c){var b,f=!1;for(b=0;b<u.length;b++)if(u[b].data("src")===a){f=!0;break}f||ca(a,u.length,c)}function Ma(d,c){var b,f,e,n,l,k,m,v={},p=l="",s="";e="";if(c===ua&&0!==E)U.dialog(G);else if(d&&d.data===Na&&(c=Na,d=d.delegateTarget),typeof c===Aa&&typeof d===Aa&&(Z=0),E=1,Z=0,h=a(".easyrecipe:first",t),c!==ua&&1<h.length&&(h=a(h[c]),Z=c),k=a.support.cors?"json":"jsonp",a.ajax(Qb,{dataType:k,data:{v:q.version,p:0,u:q.wpurl},success:Kb,
error:Jb}),db=!1,typeof tinyMCE!==Aa&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()&&(db=!0),db){L.val("");M.val("");S.val("");Za.val("");C.val("");N.val("");z.val("");A.val("");T.val("");ra.val("");sa.val("");$.val("");aa.val("");ba.val("");ia.val("");ja.val("");ka.val("");la.val("");ma.val("");na.val("");oa.val("");pa.val("");qa.val("");ta.val("");if(c!==ua&&1===h.length)B.easyrecipeDialog("option","title","Update Recipe"),Ha.hide(),Fa.hide(),Ga.show(),eb=!0;else{Oa=Q.getContent();if(!Xa&&
((k=Rb.exec(Oa)||Sb.exec(Oa)||Tb.exec(Oa))||(b=a("#hasRecipe").is(":checked")),k||b)){b?(Ja="recipress",$a=q.postID):(Ja=k[2],$a=k[3]);Ia.hide();Da.click(Lb);Ea.click(Ob);e=Ub[Ja];l=a("#txtERCNVText1",R);l.html(l.html().replace("#plugin#",e));H.html("");I=-1;u=[];H.html(rb);R.dialog(G);return}q.isGuest&&(k=a("#inpERAuthor").val()||"",C.val(k));Fa.show();Ga.hide();Ha.show();B.easyrecipeDialog("option","title","Add a New Recipe");eb=!1;!1!==Pa?v=ab(Pa):(k=Q.selection.getContent(),20<k.length&&(v=ab(k)));
v.summary&&(l=v.summary);v.ingredients&&(p=v.ingredients);v.instructions&&(s=v.instructions);v.notes&&(e=v.notes);h=ob()}v=h;h=a("<div>"+h.html()+"</div>");a("#inpERCuisine").autocomplete({source:a.parseJSON(q.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');a("#inpERType").autocomplete({source:a.parseJSON(q.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');P=!1;ya.off("change",Sa).on("change",Sa);fb=!1;0<a(".hrecipe",t).length&&confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")&&
(fb=!0);ea=c!==ua?h.find(".endeasyrecipe").text():q.version;""===ea&&(ea="2.2");y=a('link[itemprop="image"]',h).attr("href")||"";H.html("");I=-1;Ka="";u=[];t.find("img").each(function(b){var d=!1;"3">ea?a(this).hasClass("photo")&&(d=!0):d=this.src===y;ca(this.src,b,d)});b=t.contents().text();k=sb.exec(b);for(m=u.length;null!==k;)f=Vb.exec(k[0]),null!==f&&(f=f[1],ca(f,m),"3"<ea?y===f&&(u[m].parent().addClass(da),I=m):Wb.test(k[0])&&(u[m].parent().addClass(da),I=m,y=f),m++),k=sb.exec(b);""!==y&&La(y,
!0);(tb=a("#set-post-thumbnail").find("img").attr("src"))&&La(tb,-1===I);-1===I&&0<u.length&&(I=0,y=Ka,u[0].parent().addClass(da));H.click(function(){U.dialog(G)});0===u.length?H.html(rb):-1===I&&u[0].parent().addClass(da);Y=[];D=[];(k=h.find(".ERName .fn").html()||h.find(".ERName").html())&&""!==k?L.val(w(g(k))):L.val(w(g(a("#title").val())));M.val(w(g(h.find(".type").html())));C.val(w(g(h.find(".author").html())));""===C.val()&&C.val(w(a.parseJSON(q.author)));S.val(w(g(h.find(".cuisine").html())));
N.val(w(l+g(h.find(".summary").html())));"3"<ea?(l=h.find('time[itemprop="prepTime"]').html()||"",z.val(g(l)),l=h.find('time[itemprop="cookTime"]').html()||"",A.val(g(l))):(l=h.find(".preptime").html()||"",k=ub.exec(l),null!==k?z.val(g(k[1])):z.val(""),l=h.find(".cooktime").html()||"",k=ub.exec(l),null!==k?A.val(g(k[1])):A.val(""));T.val(g(h.find(".yield").html()));h.find(".ingredients li").each(function(b,d){p=a(d).hasClass(vb)?p+("!"+w(g(d.innerHTML))+"\n"):p+(w(g(d.innerHTML))+"\n")});ra.val(p);
h.find(".instructions li, .instructions .ERSeparator").each(function(b,d){n=a.trim(d.innerHTML.replace(/^[ 0-9.]*(.*)$/ig,"$1"));s=a(d).hasClass(vb)?s+("!"+n+"\n"):s+(n+"\n")});sa.val(w(g(s)));$.val(g(h.find(".servingSize").html()));aa.val(g(h.find(".calories").html()));ba.val(g(h.find(".fat").html()));ia.val(g(h.find(".saturatedFat").html()));ja.val(g(h.find(".unsaturatedFat").html()));ka.val(g(h.find(".transFat").html()));la.val(g(h.find(".carbohydrates").html()));ma.val(g(h.find(".sugar").html()));
na.val(g(h.find(".sodium").html()));oa.val(g(h.find(".fiber").html()));pa.val(g(h.find(".protein").html()));qa.val(g(h.find(".cholesterol").html()));n=(g(h.find(".ERNotes").html())||"").replace(/<\/p>\n*<p>/ig,"\n\n").replace(/(?:<p>|<\/p>)/ig,"").replace(/<br *\/?>/ig,"\n");""===n&&""!==e&&(n=e);n=w(n);n=n.replace(/\[br(?: ?\/)?\]/ig,"\n");ta.val(w(n));r&&(r.name&&L.val(w(g(r.name))),r.author&&C.val(w(r.author)),r.summary&&N.val(w(r.summary)),r.yield&&T.val(g(r.yield)),r.type&&M.val(w(g(r.type))),
r.cuisine&&S.val(w(g(r.cuisine))),r.prepTime&&z.val(g(r.prepTime)),r.cookTime&&A.val(g(r.cookTime)),r.summary&&N.val(w(r.summary)));h=v;B.easyrecipeDialog(G);B.easyrecipeDialog("option","position","center")}else alert("You must use the Visual Editor to add or update an EasyRecipe")}function gb(d){E=a(".easyrecipe",t).length;Xb||0===E?Ma(d,ua):U.dialog(G)}function Yb(){B.easyrecipeDialog(K)}function Zb(){confirm("Are you sure you want to delete this recipe?")&&(h.remove(),P=h=!1);B.easyrecipeDialog(K)}
function $b(){var d=a("#inpERPaste"),c,b=d.val();c=ab(b);if(0!==c.ingredients.length||0!==c.instructions.length)Pa=b,d.val(""),r={name:x(X(L.val())),author:x(s(C)),yield:s(T),type:x(s(M)),cuisine:x(s(S)),summary:x(s(N)),servesize:s($),prepTime:z.val(),cookTime:A.val()},P=!1,B.easyrecipeDialog(K),gb(null)}function hb(d){d=a(d.target).parent();var c=d.parent();d.hasClass("easyrecipeAbove")?c.before(wb):c.after(wb);d.remove();xb()}function xb(){var d,c;c=a("<div>"+t[0].body.innerHTML+"</div>");c.find(".easyrecipeAbove,.easyrecipeBelow").remove();
d=c.find(".easyrecipe");d.each(function(){var b=a(this);b.parent().hasClass("easyrecipeWrapper")&&b.unwrap();yb(b)});d=c.html();Q.setContent(d);d=t.find(".easyrecipe");d.on("mousedown",null,Na,Ma);t.find(".ERInsertLine").on(F,hb)}function ac(a){var c,b;c=a.prev();b=a.next();if(c=0===c.length||c.hasClass("easyrecipe")||c.hasClass("easyrecipeWrapper"))try{c=!(a[0].previousSibling&&3===a[0].previousSibling.nodeType)}catch(f){}if(b=0===b.length||b.hasClass("easyrecipe")||b.hasClass("easyrecipeWrapper"))try{b=
!(a[0].nextSibling&&3===a[0].nextSibling.nodeType)}catch(e){}if(c||b)a.wrap('<div class="easyrecipeWrapper mceNonEditable" />'),a=a.parent(),c&&(a.prepend('<div class="easyrecipeAbove mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line above" /></div>'),a.find("input").on(F,hb),bc.push(a.find(".easyrecipeAbove")[0])),b&&(a.append('<div class="easyrecipeBelow mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line below" /></div>'),
a.find("input").on(F,hb))}function ib(){var d=a(".easyrecipe",t);0!==d.length&&(d.on("mousedown",null,Na,Ma),xb())}function zb(){var d,c="",b,f="",e=0,g="",l,k,r,v=[],p,u;if(Ba(z)&&Ba(A)){b=a.trim(z.val());""!==b?(m=Va.exec(b),l=m[1]?parseInt(m[1],10):0,k=m[2]?parseInt(m[2],10):0,e=60*l+k,f="PT"+(0<l?l+"H":"")+(0<k?k+"M":"")):b=!1;d=a.trim(A.val());""!==d?(m=Va.exec(d),l=m[1]?parseInt(m[1],10):0,k=m[2]?parseInt(m[2],10):0,e+=60*l+k,c="PT"+(0<l?l+"H":"")+(0<k?k+"M":"")):d=!1;0<e?(l=Math.floor(e/60),
k=e%60,e=0<l?l+" hour":"",1<l&&(e+="s"),g=0<k?k+" min":"",1<k&&(g+="s"),e=a.trim(e+" "+g),g="PT"+(0<l?l+"H":"")+(0<k?k+"M":"")):e=!1;l=ra.val().split("\n");for(r=0;r<l.length;r++)k=l[r],""!==k&&("!"===k.charAt(0)?(p=!0,k=k.substr(1)):p=!1,v.push({ingredient:x(X(k)),hasHeading:p}));l=sa.val().split("\n");u=[];p={INSTRUCTIONS:[]};for(r=0;r<l.length;r++)k=a.trim(l[r].replace(/^[ 0-9\.]*(.*)$/ig,"$1")),""!==k&&("!"===k.charAt(0)?((0<p.INSTRUCTIONS.length||p.heading)&&u.push(p),k=k.substr(1),p={INSTRUCTIONS:[]},
p.heading=X(k)):p.INSTRUCTIONS.push({instruction:x(X(k))}));(0<p.INSTRUCTIONS.length||p.heading)&&u.push(p);(k=s(ta))&&(k=k.replace(/\n/g,"[br]"));d={version:q.version,hasPhoto:""!==y,photoURL:y,name:x(X(L.val())),author:x(s(C)),preptime:b,cooktime:d,totaltime:e,preptimeISO:f,cooktimeISO:c,totaltimeISO:g,yield:s(T),type:x(s(M)),cuisine:x(s(S)),summary:x(s(N)),servesize:s($),calories:s(aa),fat:s(ba),satfat:s(ia),unsatfat:s(ja),transfat:s(ka),carbs:s(la),sugar:s(ma),sodium:s(na),fiber:s(oa),protein:s(pa),
cholesterol:s(qa),notes:x(k),INGREDIENTS:v,STEPS:u};""===d.name&&(d.name=!1);d=mb(q.recipeTemplate,d);fb&&a(".hrecipe",t).remove();-1===Z?h=a(Wa,t):(h=a(".easyrecipe",t),0<h.length&&(h=a(h[Z])));h.before(d);h.remove();h=!1;V.css("display","inline-block");P=!1;B.easyrecipeDialog(K);E=a(".easyrecipe",t).length;ib()}}function cc(d,c,b){r=!1;if("3"<tinymce.majorVersion){if(c.id!==J&&"wp_mce_fullscreen"!==c.id){a("#"+c.controlManager.buttons.easyrecipeTest._id).hide();a("#"+c.controlManager.buttons.easyrecipeEdit._id).hide();
a("#"+c.controlManager.buttons.easyrecipeAdd._id).hide();return}c.id===J?(t=a("#"+J+"_ifr").contents(),d=a("#"+c.controlManager.buttons.easyrecipeTest._id),V=a("#"+c.controlManager.buttons.easyrecipeEdit._id)):(t=a("#wp_mce_fullscreen_ifr").contents(),d=a("#mce_fullscreen_easyrecipeTest"),V=a("#mce_fullscreen_easyrecipeEdit"))}else{if(c.editorId!==J&&"wp_mce_fullscreen"!==c.editorId){a("#"+c.editorId+"_easyrecipeTest").hide();a("#"+c.editorId+"_easyrecipeEdit").hide();a("#"+c.editorId+"_easyrecipeAdd").hide();
return}c.editorId===J?(t=a("#"+J+"_ifr").contents(),d=a("#"+J+"_easyrecipeTest"),V=a("#"+J+"_easyrecipeEdit")):(t=a("#wp_mce_fullscreen_ifr").contents(),d=a("#mce_fullscreen_easyrecipeTest"),V=a("#mce_fullscreen_easyrecipeEdit"))}Ca=a("body",t);c=a(".easyrecipe",t);Q=tinyMCE.activeEditor;c.each(function(){a(this).addClass("mceNonEditable");a(".ERRatingOuter",this).remove();a(".ERHDPrint",this).remove();a(".ERLinkback",this).remove()});E=c.length;0<E&&""!==q.testURL?d.show():d.hide();0<E?V.css("display",
"inline-block"):V.hide();t.hasERCSS||(a("head",t).append('<link rel="stylesheet" type="text/css" href="'+q.easyrecipeURL+"/css/easyrecipe-entry.css?ver="+q.version+'" />'),t.hasERCSS=!0);ib()}function dc(){Ab.toggleClass("ERNone");jb.toggleClass("ERContract")}function ec(){Bb.toggleClass("ERNone");kb.toggleClass("ERContract")}function fc(d){var c;c=a("#ertmp_"+Cb,t);D.push('href="'+d.href+'"'+(d.target?' target="'+d.target+'"':"")+(d.title?' title="'+d.title+'"':""));fa.val(O.substring(0,va)+"[url:"+
D.length+"]"+O.substring(va,wa)+"[/url]"+O.substring(wa));fa[0].focus();c.remove()}function gc(d){var c,b,f;q.isEntryDialog&&(c=a("#ertmp_"+Cb,t),"string"===typeof d?b=a(d):(d=c.html(),"link"===d?c=b=c.parent("a"):b=a(c.html())),b.is("a")&&(d=b.attr("href"),f=b.attr("title"),b=b.attr("target"),d='href="'+d+'"'+(b?' target="'+b+'"':"")+(f?' title="'+f+'"':""),D.push(d),fa.val(O.substring(0,va)+"[url:"+D.length+"]"+O.substring(va,wa)+"[/url]"+O.substring(wa))),fa[0].focus(),c.remove())}function hc(d,
c){var b,f,e,g,h,k,m,q,p,r,s,t;b=d.sizes[c.size];f=b.url;h=b.width;k=b.height;ca(f,u.length);m=tinymce.html.Entities.encodeAllRaw(a.trim(d.title));m=m.replace(/&quot;/g,"&amp;quot;");q=tinymce.html.Entities.encodeAllRaw(a.trim(d.alt));q=q.replace(/&quot;/g,"&amp;quot;");p=tinymce.html.Entities.encodeAllRaw(a.trim(d.caption));m=""!==m?' title="'+m+'"':"";q=""!==q?' alt="'+q+'"':"";r="align"+c.align;g=d.uploadedTo?'id="attachment_'+d.uploadedTo+'" ':"";b=O.substring(0,va);""!==p?(ga.push(g+'align="'+
r+'" width="'+h+'"'),Ta.push(p),g="[cap:"+ga.length+"]",p="[/cap]",r=""):g=p="";"none"===c.link?e=s=t="":"file"===c.link?e=f:"post"===c.link?e=d.link:"custom"===c.link&&(e=c.linkUrl);""!==e&&(D.push('href="'+e+'"'),s="[url:"+D.length+"]",t="[/url]");Y.push('src="'+f+'" width="'+h+'" height="'+k+'" class="'+r+" size-"+c.size+'"'+m+q);b+=g+s+"[img:"+Y.length+"]"+t+p;b+=O.substring(wa);fa.val(b);fa[0].focus()}function ic(a){a.stopPropagation();U.dialog(G)}function jc(){r=!1;gb()}function kc(){r=!1;Ma()}
function lc(){0<E&&!q.noHTMLWarn&&(q.noHTMLWarn=!0,xa.dialog(G))}function mc(d){var c,b;if("dopreview"===a("#wp-preview",d.target).val()||0===E)return!0;(d=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden())?c=a("<div>"+Q.getContent()+"</div>"):(b=a("#wp-content-editor-container").find("textarea"),c=a("<div>"+b.val()+"</div>"));var f=a(".easyrecipeWrapper",c);a(".easyrecipeAbove,.easyrecipeBelow",f).remove();a(".easyrecipe",f).unwrap();a(".easyrecipe",c).removeClass("mceNonEditable");c=a.trim(c.html());
d?Q.setContent(c):b.val(c);return!0}function nc(d){""!=d.target.innerHTML&&(d=a(d.target).find("img").attr("src"))&&La(d,!1)}function oc(d){var c,b;d=d[0];for(c=0;c<d.addedNodes.length;c++)if(b=a(d.addedNodes[c].innerHTML),b=b.find("img").attr("src")){La(b,!1);break}}var Nb=jQuery.trim,Q,db,L,N,ra,sa,z,A,T,J,C,M,S,Za,Ua,Xa=!1,fb,Oa,h,eb,Fb=/\x3c!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) --\x3e/i,Gb=/^#([_a-z][_0-9a-z]{0,19})#/im,Hb=/\x3c!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) --\x3e/m,
tb,ub=/^([^<]*)/,Va=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,Ib=/^([0-9]+)$/,Rb=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/,Sb=/(.*)\[(yumprint)-recipe\s+id='(\d+)'\](.*)/i,Tb=/(.*)\[(gmc)_recipe\s+([0-9]+)\](.*)/,$a,Ja,Ya,Pa,pb=/PT(?:([0-9]*)+H)?([0-9]+)+M/i,sb=/\[(?:img) +(?:[^\]]+?)\]/ig,Wb=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i,Vb=/src\s*=\s*" *([^"]+?) *"/i,Ub={recipeseo:"Recipe SEO",ziplist:"ZipList",zlrecipe:"ZipList",yumprint:"Yumprint Recipe Card",
recipress:"ReciPress",gmc:"GetMeCooking"},D=[],Y=[],ga=[],Ta=[],va,wa,O,Cb=0,fa,q,xa,ha='<div class="easyrecipeholder">EasyRecipe</div>',Wa=".easyrecipeholder",vb="ERSeparator",B,U,R,t=null,Ca,m,za,Qa,Ra,u,H,Ha,Ia,Da,Ea,Fa,Ga,Ab,jb,Bb,kb,$,aa,ba,ia,ja,ka,la,ma,na,oa,pa,qa,ta,V,E=0,Z,Xb=!0,cb,bb,I,lb,W,K="close",F="click",Aa="undefined",G="open",da="ERPhotoSelected",Qb="http://www.easyrecipeplugin.com/checkUpdates.php",rb='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>',
ea,ua=-1,Na=-2,y="",Ka,wb="&nbsp;",yb,qb,r,bc=[],P=!1,ya;"use strict";a(function(){var d,c;c=null;q=EASYRECIPE;q.dialogs=a("<div>").addClass("easyrecipeUI").prop("id","er-dialogs").appendTo("body");a.widget("custom.easyrecipeDialog",a.ui.dialog,{_allowInteraction:function(b){return this._super(b)||!!a(b.target).parents(".media-modal-content, #wp-link").length}});q.button!==a.fn.button&&(c=a.fn.button,a.fn.button=q.button);B=a("#easyrecipeEntry");U=a("#easyrecipeUpgrade");xa=a("#easyrecipeHTMLWarn");
J=q.isGuest?"guestpost":"content";B.easyrecipeDialog({autoOpen:!1,width:655,modal:!0,appendTo:q.dialogs,dialogClass:"easyrecipeEntry",beforeClose:function(){if(P){if(!window.confirm("Are you sure you want to close without saving the recipe?"))return!1;P=!1}return!0},close:function(){q.isEntryDialog=!1;h&&!eb&&h.remove();h=!1;a(".easyrecipeEntry").filter(function(){return""===a(this).text()}).remove()},open:function(){q.isEntryDialog=!0;za.tabs({active:0,beforeActivate:Db});setTimeout(function(){var b=
a(".easyrecipeEntry"),c=b.offset();c.top<lb&&(c.top=lb,b.offset(c))},250)}});ya=a("#divERContainer").show();xa.dialog({autoOpen:!1,width:420,modal:!0,dialogClass:"easyrecipeHTMLWarn",appendTo:q.dialogs,close:function(){a(".easyrecipeHTMLWarn").filter(function(){return""===a(this).text()}).remove()}});a(".divERHTMLWarnContainer").show();U.dialog({autoOpen:!1,width:420,modal:!0,dialogClass:"easyrecipeUpgrade",appendTo:q.dialogs,close:function(){a(".easyrecipeUpgrade").filter(function(){return""===a(this).text()}).remove()}});
a(".divERUPGContainer").show();R=a("#easyrecipeConvert");Ia=a("#divERCNVSpinner");Da=a("#btnERCNVCancel");Ea=a("#btnERCNVOK");Ia.hide();R.dialog({autoOpen:!1,width:390,modal:!0,dialogClass:"easyrecipeConvert",appendTo:q.dialogs,close:function(){a(".easyrecipeConvert").filter(function(){return""===a(this).text()}).remove()}});a("#divERCNVContainer").show();a(window).bind("easyrecipeadd",jc);a(window).bind("easyrecipeedit",kc);a(window).bind("easyrecipeload",cc);Ra=a("#divERNext");Qa=a("#btnERButtons");
za=a("#ERDTabs");H=a("#divERPhotos");a("input:submit",".easyrecipeUI").button();a("#ed_toolbar");L=a("#inpERName");C=a("#inpERAuthor");M=a("#inpERType");S=a("#inpERCuisine");Za=a("#inpERTags");N=a("textarea#taERSummary");ra=a("textarea#taERIngredients");sa=a("textarea#taERInstructions");z=a("#inpERPrepTime");A=a("#inpERCookTime");T=a("#inpERYield");$=a("#inpERServeSize");aa=a("#inpERCalories");ba=a("#inpERFat");ia=a("#inpERSatFat");ja=a("#inpERUnsatFat");ka=a("#inpERTransFat");la=a("#inpERCarbs");
ma=a("#inpERSugar");na=a("#inpERSodium");oa=a("#inpERFiber");pa=a("#inpERProtein");qa=a("#inpERCholesterol");ta=a("textarea#taERNotes");cb=a("#divERAddImageURL");d=a("#lnkERPhotoURL");Ua=a(".ERTimeError");Fa=a("#divERAdd");Ga=a("#divERChange");a("#divERHeader");Ab=a("#divEROther");jb=a("#divEROtherLabel");Bb=a("#divERNotes");kb=a("#divERNotesLabel");Ha=a("#ERDPasteTab");bb=a("#fldERAPUImageURL");a("#btnERAdd").click(zb);a("#btnERNext").click(Eb);a("#btnERChange").click(zb);a("#btnERDelete").click(Zb);
a("#btnERCancel").click(Yb);d.click(function(){U.dialog(G)});a("#btnERAIUCancel").click(function(){cb.hide()});a("#btnERAIUOK").click(Pb);jb.click(dc);kb.click(ec);z.change(function(b){Ba(a(b.target))});A.change(function(b){Ba(a(b.target))});a("#btnERPaste").click($b);lb=a("#wpadminbar").height();W=a("#divEREditBtns").on("mousedown","li",ic);ya.find('input[type="text"], textarea').on("blur",function(){}).on("focus",function(){a(this)});a("#wp-link").bind("wpdialogclose",gc);q.insertLink=fc;Ya=gb;
Pa=!1;q.insertUploadedImage=hc;yb=ac;qb=ca;q.addListener=ib;xa.find("input").on(F,function(){xa.dialog(K)});a("#wp-content-editor-tools").on(F,"#content-html",lc);a("#post").on("submit",mc);null!==c&&(a.fn.button=c);d=a("#postimagediv").find(".inside");if(window.MutationObserver&&0<d.length)c=new MutationObserver(oc),c.observe(d[0],{childList:!0});else d.on("DOMSubtreeModified",nc);window.QTags&&QTags.addButton("easyrecipe","EasyRecipe",function(){alert("Switch to the Visual Editor to add or edit an EasyRecipe")},
"","","",900)})})(jQuery);
