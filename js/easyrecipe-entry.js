/*! EasyRecipe  3.2.1271 Copyright (c) 2013 BoxHill LLC */
if(!window.EASYRECIPE){var EASYRECIPE={}}if(!EASYRECIPE.widget){EASYRECIPE.widget=jQuery.widget}if(!EASYRECIPE.button){EASYRECIPE.button=jQuery.fn.button}(function(bP){var I=jQuery.trim;var S,T,bE,bY,bA,l,ay,aZ,br,au;var x,bg,bx,aW,bC,O=false,R,bI,b2,P,f;var bQ=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i;var p=/^#([_a-z][_0-9a-z]{0,19})#/im;var b=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m;var bq;var bi=/^([^<]*)/,t=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,aC=/^([0-9]+)$/;var b1=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/;var aG=/(.*)\[(yumprint)-recipe\s+id='(\d+)'\](.*)/i;var aP=/(.*)\[(gmc)_recipe\s+([0-9]+)\](.*)/;var bd,a8,bB,b0,W;var av=/PT(?:([0-9]*)+H)?([0-9]+)+M/i;var am=/\[(?:img) +(?:[^\]]+?)\]/ig;var Q=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i;var bm=/src\s*=\s*" *([^"]+?) *"/i;var b3={recipeseo:"Recipe SEO",ziplist:"ZipList",yumprint:"Yumprint Recipe Card",recipress:"ReciPress",gmc:"GetMeCooking"};var bo=[];var bu=[];var bj,aM,aT,aj=null,s=0,o,w,bs;var aO='<div class="easyrecipeholder">EasyRecipe</div>',i=".easyrecipeholder",aN="ERSeparator";var bf,N,G,u,aL=null,bt,ad,bU,a0="option",aD="zIndex",d,X,bb,bX,aH;var at,z,bK,bz,bV,bG,M,bh,bk,bv,bF;var bn,n,aE,bH,aK,a9,ap,bM,e,D,a1,c,v,bJ;var a2=0,bZ=false,a4,K=true,E,aA,bN,Y,a6;var m="close",ar="click",aQ="undefined",J="open",aV="ERPhotoSelected",ag="http://www.easyrecipeplugin.com/checkUpdates.php";var ax='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>';var bl,aF=-1,aB=-2,F="",bp,ak="&nbsp;",bc,ac,H;var bT=[];var A=false;var bD;"use strict";function an(b6,b7){var b5;X.show();a6.hide();bb.show();b5=b7.newTab?b7.newTab.index():b7.index;switch(b5){case 0:a6.css("right","10px");a6.show();break;case 3:a6.css("right","inherit");bb.hide();a6.show();break;case 4:X.hide();break}}function j(){bD.off("change",j);A=true}function bL(b5){if(!b5){return""}b5+="";return b5.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")}function y(b5){return b5?bP("<div />").text(b5).html():""}function az(b5){return bP.trim(y(b5.val()))||false}function a(b6,b7){var b5=d.tabs("option","active");d.tabs("option","active",++b5)}function ai(b6){var b8,b5=/\[img +(.*?) *\/?\]/i,b7=/\[url ([^\]]+)\](.*?\[\/url\])/i;b8=b5.exec(b6);while(b8!==null){bu.push(b8[1]);b6=b6.replace(b5,"[img:"+bu.length+"]");b8=b5.exec(b6)}b8=b7.exec(b6);while(b8!==null){bo.push(b8[1]);b6=b6.replace(b7,"[url:"+bo.length+"]$2");b8=b7.exec(b6)}return b6}function g(b6){var b9,b8,b5=/\[img:(\d+)\]/i,b7=/\[url:(\d+)\](.*?)\[\/url\]/i;b8=b5.exec(b6);while(b8!==null){b9=bu[b8[1]-1];b6=b6.replace(b5,"[img "+b9+"]");b8=b5.exec(b6)}b8=b7.exec(b6);while(b8!==null){b9=bo[b8[1]-1];b6=b6.replace(b7,"[url "+b9+"]$2[/url]");b8=b7.exec(b6)}return b6}function aY(cz,cl){var cr=0,cm=1,b5=2,cB;var cs,cj,cc,ci=0,ch="",cu,b6,b9,ct,cw;var cv="<!-- START REPEAT ",cD="<!-- START INCLUDEIF ",cC="<!-- END INCLUDEIF ";var b8,b7,ce,cy,cp,cd,ck,cq,cA,cg;var ca,co,cx;var cf,cn,cb;cB=cz;cl=cl||{};while(true){cu=cB.length;b6=cB.indexOf("#",ci);if(b6!==-1){cu=b6;b9=cr}ct=cB.indexOf(cv,ci);if(ct!==-1&&ct<cu){cu=ct;b9=cm}cw=cB.indexOf(cD,ci);if(cw!==-1&&cw<cu){cu=cw;b9=b5}if(cu===cB.length){return ch+cB.substr(ci)}b8=cu-ci;ch+=cB.substr(ci,b8);ci=cu;switch(b9){case b5:cj=cB.substr(ci,44);cc=bQ.exec(cj);if(cc!==null){b7=cc[1];ce=b7!=="!";cy=cc[2]}else{break}cp=cC+b7+cy+" -->";cd=cp.length;ck=cB.indexOf(cp);if(ck===-1){ci++;break}cq=typeof cl[cy]!==aQ&&cl[cy]!==false;if(cq===ce){cA="<!-- START INCLUDEIF "+b7+cy+" -->";cg=cA.length;cB=cB.substr(0,ci)+cB.substr(ci+cg,ck-ci-cg)+cB.substr(ck+cd)}else{cB=cB.substr(0,ci)+cB.substr(ck+cd)}break;case cr:cj=cB.substr(ci,22);cc=p.exec(cj);if(cc===null){ch+="#";ci++;continue}ca=cc[1];if(cl[ca]!==""&&!cl[ca]){ch+="#"+ca+"#";ci+=ca.length+2;continue}ch+=cl[ca];ci+=ca.length+2;break;case cm:cj=cB.substr(ci,45);cc=b.exec(cj);if(cc===null){ch+="<";ci++;continue}co=cc[1];if(!cl[co]||!(cl[co] instanceof Array)){ch+="<";ci++;continue}ci+=co.length+22;cx=cB.indexOf("<!-- END REPEAT "+co+" -->",ci);if(cx===-1){ch+="<!-- START REPEAT "+co+" -->";continue}cf=cx-ci;cn=cB.substr(ci,cf);cb=cl[co];for(cs=0;cs<cb.length;cs++){ch+=aY(cn,cb[cs])}ci+=co.length+cf+20;break}}}function U(b9){var b5=bP.trim(b9.val()),b6=0,b8=0,b7,ca;bC.hide();if(b5===""){return true}bU=t.exec(b5);if(bU===null){bU=aC.exec(b5);if(bU===null){bC.show();return false}b6=0;b8=bU[1]}else{b6=bU[1]?parseInt(bU[1],10):0;b8=bU[2]?parseInt(bU[2],10):0}if(b6===0&&b8===0){b9.val("")}else{b7=b6>0?b6+" hour":"";if(b6>1){b7+="s"}ca=b8>0?b8+" min":"";if(b8>1){ca+="s"}b9.val(bP.trim(b7+" "+ca))}return true}function q(b9){var b6,b5,b7,b8="";for(b6=0;b6<b9.length;b6++){b5=b9[b6];if(b5.nodeType===3){b7=bP.trim(b5.nodeValue);if(b7!==""){b8+=b7+"\n"}continue}if(b5.nodeType!==1){continue}if(b5.childNodes.length>0){b8+=q(b5.childNodes)}}return b8}function bR(){var b5;bP(i,aL).remove();b5=S.selection.getNode();if(b5.nodeName==="#document"){b5=bt[0]}if(b5.nodeName.toUpperCase()==="BODY"){if(!bP(b5).hasClass("mceContentBody")){b5=bt[0]}bP(b5).append("&nbsp;"+aO)}else{while(b5.parentNode&&b5.parentNode.nodeName.toUpperCase()!=="BODY"){b5=b5.parentNode}if(!b5.parentNode){b5=bt[0];bP(b5).append("&nbsp;"+aO)}else{if(b5.nodeName.toUpperCase()==="DIV"||b5.nodeName.toUpperCase()==="SPAN"){bP(b5,aL).after(aO)}else{bP(b5,aL).before(aO)}}}a4=-1;return bP(i,aL)}function Z(b5,b7,b6){}function ab(b5){switch(b5.type){case"js":bP("head").append(bP('<script type="text/javascript">'+b5.js+"<\/script>"));w[b5.f]();break;case"html":bP(b5.dest).html(b5.html);break}}function b4(){bK.unbind(ar);bz.unbind(ar);u.dialog(m);O=true;bB()}function L(ca,b6){var b9,b5="";var b8,b7;b8=ca.recipe;if(b6!=="success"){u.dialog(m);O=true;bB()}bE.val(bL(b8.recipe_title));F=b8.recipe_image;bg.val("");if(b8.author){x.val(bL(b8.author))}else{x.val("")}bx.val(b8.cuisine||"");bg.val(b8.mealType||"");aW.val("");bY.val(bL(b8.summary));bU=av.exec(b8.prep_time);if(bU!==null){b9=bU[1]?bU[1]+"h ":"";ay.val(b9+bU[2]+"m")}else{ay.val(bL(b8.prep_time))}bU=av.exec(b8.cook_time);if(bU!==null){b9=bU[1]?bU[1]+"h ":"";aZ.val(b9+bU[2]+"m")}else{aZ.val(bL(b8.cook_time))}br.val(bL(b8.yield));bn.val(bL(b8.serving_size));if(b8.nutrition){b7=b8.nutrition;n.val(bL(b7.calories));aE.val(bL(b7.totalFat));bH.val(bL(b7.saturatedFat));aK.val(bL(b7.unsaturatedFat));a9.val(bL(b7.transFat));ap.val(bL(b7.totalCarbohydrates));bM.val(bL(b7.sugars));e.val(bL(b7.sodium));D.val(bL(b7.dietaryFiber));a1.val(bL(b7.protein));c.val(bL(b7.cholesterol))}else{n.val(bL(b8.calories));aE.val(bL(b8.fat))}for(b9=0;b9<ca.ingredients.length;b9++){b5+=I(bL(ca.ingredients[b9]))+"\n"}bA.val(b5);l.val(bL(b8.instructions.replace("\r","")));v.val(bL(b8.notes));bf.dialog("option","title","Update Recipe");u.dialog(m);bV.hide();bG.show();at.hide();if(F!==""){ac(F,bX.length,true)}b2=bR();bf.parent(".ui-dialog").css(aD,ad);bf.dialog(a0,aD,ad);bf.dialog(J)}function a3(){var b5;z.show();bK.unbind(ar);bz.unbind(ar);b5={action:"easyrecipeConvert",id:bd,type:a8};bP.post(ajaxurl,b5,L,"json")}function B(cf){var ce,co,cg,ca=0,ck,b9="",b5="",b6="",cc="";var cd=["instruction","method","cooking method","procedure"];var cp=["ingredients?"];var b7=["note","cooking note"];var cq;var cl;var b8;var cm,ch,cj;var cn,cb,ci;cn=bP.parseJSON(w.ingredients);cb=bP.parseJSON(w.instructions);ci=bP.parseJSON(w.notes);if(bP.inArray(cn,cp)===-1){cp.push(cn)}cl="^\\s*(?:"+cp.join("|")+")";ch=new RegExp(cl,"i");if(bP.inArray(cb,cd)===-1){cp.push(cb)}cq="^\\s*(?:"+cd.join("|")+")";cm=new RegExp(cq,"i");if(bP.inArray(ci,b7)===-1){b7.push(ci)}b8="^\\s*(?:"+b7.join("|")+")\\s*$";cj=new RegExp(b8,"i");ck=bP("<div>"+cf+"</div>");ce=q(ck[0].childNodes);ce=ce.split("\n");for(co=0;co<ce.length;co++){cg=bP.trim(ce[co]);if(cg===""){continue}if(cm.test(cg)){ca=2;continue}if(ch.test(cg)){ca=1;continue}if(cj.test(cg)){ca=3;continue}switch(ca){case 0:b9+=cg+"\n";break;case 1:b5+=cg+"\n";break;case 2:b6+=cg+"\n";break;case 3:cc+=cg+"\n";break}}return{summary:b9,ingredients:b5,instructions:b6,notes:cc}}function aw(){N.parent(".ui-dialog").css(aD,ad);N.dialog(a0,aD,ad);N.dialog(J)}function aa(b8,b5,b6){var b7;var b9=function(){var ca,ce,cd,cb,cc=bP.data(this,"index");ca=this.width/150;ce=this.height/112;ca=ca>ce?ca:ce;cd=Math.floor(this.height/ca);cb=Math.floor(this.width/ca);bX[cc].height(cd);bX[cc].width(cb);bX[cc].css("top",(112-cd)/2);bX[cc].attr("src",this.src);if(cc===0){bP("#ERDTabs").find(".divERNoPhotos").remove()}};aH.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+b5+'" /></div>');bX[b5]=bP("#ERPhoto_"+b5,aH);bX[b5].data("src",b8);if(b6){bP(".ERPhoto",aH).removeClass(aV);bX[b5].parent().addClass(aV);bN=b5;F=b8}if(bp===""){bp=b8}b7=new Image();bP.data(b7,"index",b5);b7.onload=b9;b7.src=b8}function af(){aa(aA.val(),bX.length,true);aA.val("");E.hide();bP(".divERNoPhotos").remove()}function bW(b5,b7){var b6,b8=false;for(b6=0;b6<bX.length;b6++){if(bX[b6].data("src")===b5){b8=true;break}}if(!b8){aa(b5,bX.length,b7)}}function ae(cm,cp){var b8;var cr;var cd,ca;var cn;var b9;var cq,cl,ck,cf,cc,cg,ch,cs;var b7={},cb="",b6="",b5="",cj="",co;var ce,ci;if(cp===aF&&a2!==0){aw();return}if(cm&&cm.data===aB){cp=aB;cm=cm.delegateTarget}if(typeof cp===aQ&&typeof cm===aQ){a4=0}a2=1;a4=0;b2=bP(".easyrecipe:first",aL);if(cp!==aF&&b2.length>1){b2=bP(b2[cp]);a4=cp}cr=0;cg=bP.support.cors?"json":"jsonp";bP.ajax(ag,{dataType:cg,data:{v:w.version,p:cr,u:w.wpurl},success:ab,error:Z});T=false;if(typeof tinyMCE!==aQ){if(tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()){T=true}}if(!T){alert("You must use the Visual Editor to add or update an EasyRecipe");return}bE.val("");bg.val("");bx.val("");aW.val("");x.val("");bY.val("");ay.val("");aZ.val("");br.val("");bA.val("");l.val("");bn.val("");n.val("");aE.val("");bH.val("");aK.val("");a9.val("");ap.val("");bM.val("");e.val("");D.val("");a1.val("");c.val("");v.val("");if(cp!==aF&&b2.length===1){bf.dialog("option","title","Update Recipe");at.hide();bV.hide();bG.show();P=true}else{bI=S.getContent();if(!O){cf=b1.exec(bI)||aG.exec(bI)||aP.exec(bI);if(!cf){b8=bP("#hasRecipe").is(":checked")}if(cf||b8){if(b8){a8="recipress";bd=w.postID}else{a8=cf[2];bd=cf[3]}z.hide();bK.click(b4);bz.click(a3);b9=b3[a8];ck=bP("#txtERCNVText1",u);ck.html(ck.html().replace("#plugin#",b9));aH.html("");bN=-1;bX=[];aH.html(ax);u.parent(".ui-dialog").css(aD,ad);u.dialog(a0,aD,ad);u.dialog(J);return}}if(w.isGuest){ce=bP("#inpERAuthor").val()||"";x.val(ce)}bV.show();bG.hide();at.show();bf.dialog("option","title","Add a New Recipe");P=false;if(W!==false){b7=B(W)}else{co=S.selection.getContent();if(co.length>20){b7=B(co)}}if(b7.summary){cb=b7.summary}if(b7.ingredients){b6=b7.ingredients}if(b7.instructions){b5=b7.instructions}if(b7.notes){cj=b7.notes}b2=bR()}ci=b2;b2=bP("<div>"+b2.html()+"</div>");bP("#inpERCuisine").autocomplete({source:bP.parseJSON(w.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');bP("#inpERType").autocomplete({source:bP.parseJSON(w.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');A=false;bD.off("change",j).on("change",j);R=false;if(bP(".hrecipe",aL).length>0){if(confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")){R=true}}bl=(cp!==aF)?b2.find(".endeasyrecipe").text():w.version;if(bl===""){bl="2.2"}F=bP('link[itemprop="image"]',b2).attr("href")||"";aH.html("");bN=-1;bp="";bX=[];aL.find("img").each(function(ct){var cu=false;if(bl<"3"){if(bP(this).hasClass("photo")){cu=true}}else{cu=this.src===F}aa(this.src,ct,cu)});cn=aL.contents().text();cf=am.exec(cn);ch=bX.length;while(cf!==null){ca=bm.exec(cf[0]);if(ca!==null){cd=ca[1];aa(cd,ch);if(bl>"3"){if(F===cd){bX[ch].parent().addClass(aV);bN=ch}}else{if(Q.test(cf[0])){bX[ch].parent().addClass(aV);bN=ch;F=cd}}ch++}cf=am.exec(cn)}if(F!==""){bW(F,true)}bq=bP("#set-post-thumbnail").find("img").attr("src");if(bq){bW(bq,bN===-1)}if(bN===-1&&bX.length>0){bN=0;F=bp;bX[0].parent().addClass(aV)}aH.click(function(){N.parent(".ui-dialog").css(aD,ad);N.dialog(a0,aD,ad);N.dialog(J)});if(bX.length===0){aH.html(ax)}else{if(bN===-1){bX[0].parent().addClass(aV)}}bu=[];bo=[];cs=b2.find(".ERName .fn").html()||b2.find(".ERName").html();if(!cs||cs===""){bE.val(ai(bL(bP("#title").val())))}else{bE.val(ai((bL(cs))))}bg.val(ai(bL(b2.find(".type").html())));x.val(ai(bL(b2.find(".author").html())));if(x.val()===""){x.val(ai(bP.parseJSON(w.author)))}bx.val(ai(bL(b2.find(".cuisine").html())));bY.val(ai(cb+bL(b2.find(".summary").html())));if(bl>"3"){cc=b2.find('time[itemprop="prepTime"]').html()||"";ay.val(bL(cc));cc=b2.find('time[itemprop="cookTime"]').html()||"";aZ.val(bL(cc))}else{cc=b2.find(".preptime").html()||"";cf=bi.exec(cc);if(cf!==null){ay.val(bL(cf[1]))}else{ay.val("")}cc=b2.find(".cooktime").html()||"";cf=bi.exec(cc);if(cf!==null){aZ.val(bL(cf[1]))}else{aZ.val("")}}br.val(bL(b2.find(".yield").html()));b2.find(".ingredients li").each(function(cu,ct){if(bP(ct).hasClass(aN)){b6+="!"+ai(bL(ct.innerHTML))+"\n"}else{b6+=ai(bL(ct.innerHTML))+"\n"}});bA.val(b6);b2.find(".instructions li, .instructions .ERSeparator").each(function(cu,ct){cl=bP.trim(ct.innerHTML.replace(/^[ 0-9.]*(.*)$/ig,"$1"));if(bP(ct).hasClass(aN)){b5+="!"+cl+"\n"}else{b5+=cl+"\n"}});l.val(ai(bL(b5)));bn.val(bL(b2.find(".servingSize").html()));n.val(bL(b2.find(".calories").html()));aE.val(bL(b2.find(".fat").html()));bH.val(bL(b2.find(".saturatedFat").html()));aK.val(bL(b2.find(".unsaturatedFat").html()));a9.val(bL(b2.find(".transFat").html()));ap.val(bL(b2.find(".carbohydrates").html()));bM.val(bL(b2.find(".sugar").html()));e.val(bL(b2.find(".sodium").html()));D.val(bL(b2.find(".fiber").html()));a1.val(bL(b2.find(".protein").html()));c.val(bL(b2.find(".cholesterol").html()));cl=(bL(b2.find(".ERNotes").html())||"").replace(/<\/p>\n*<p>/ig,"\n\n").replace(/(?:<p>|<\/p>)/ig,"").replace(/<br *\/?>/ig,"\n");if(cl===""&&cj!==""){cl=cj}cl=ai(cl);cl=cl.replace(/\[br(?: ?\/)?\]/ig,"\n");v.val(ai(cl));if(H){if(H.name){bE.val(ai((bL(H.name))))}if(H.author){x.val(ai(H.author))}if(H.summary){bY.val(ai(H.summary))}if(H.yield){br.val(bL(H.yield))}if(H.type){bg.val(ai(bL(H.type)))}if(H.cuisine){bx.val(ai(bL(H.cuisine)))}if(H.prepTime){ay.val(bL(H.prepTime))}if(H.cookTime){aZ.val(bL(H.cookTime))}if(H.summary){bY.val(ai(H.summary))}}b2=ci;bf.parent(".ui-dialog").css(aD,ad);bf.dialog(a0,aD,ad);bf.dialog(J);bf.dialog("option","position","center")}function C(b5){a2=bP(".easyrecipe",aL).length;if(K||a2===0){ae(b5,aF);return}N.parent(".ui-dialog").css(aD,ad);N.dialog(a0,aD,ad);N.dialog(J)}function a7(){bf.dialog(m)}function r(){var b5=confirm("Are you sure you want to delete this recipe?");if(b5){b2.remove();b2=false;A=false}bf.dialog(m)}function al(){var b6=bP("#inpERPaste");var b5,b7=b6.val();b5=B(b7);if(b5.ingredients.length===0&&b5.instructions.length===0){return}W=b7;b6.val("");H={name:g(y(bE.val())),author:g((az(x))),yield:az(br),type:g((az(bg))),cuisine:g((az(bx))),summary:g(az(bY)),servesize:az(bn),prepTime:ay.val(),cookTime:aZ.val()};bf.dialog(m);C(null)}function bO(b6){var b5=bP(b6.target).parent();var b7=b5.parent();if(b5.hasClass("easyrecipeAbove")){b7.before(ak)}else{b7.after(ak)}b5.remove();ah()}function ah(){var b7;var b6;var b5;b6=bP("<div>"+aL[0].body.innerHTML+"</div>");b6.find(".easyrecipeAbove,.easyrecipeBelow").remove();b7=b6.find(".easyrecipe");b7.each(function(){var b8=bP(this);if(b8.parent().hasClass("easyrecipeWrapper")){b8.unwrap()}bc(b8)});b5=b6.html();S.setContent(b5);b7=aL.find(".easyrecipe");b7.on("mousedown",null,aB,ae);aL.find(".ERInsertLine").on(ar,bO)}function bS(cb){var b8;var b6,b5,b9,b7;b9=cb.prev();b7=cb.next();b6=(b9.length===0||b9.hasClass("easyrecipe")||b9.hasClass("easyrecipeWrapper"));if(b6){try{b6=!(cb[0].previousSibling&&cb[0].previousSibling.nodeType===3)}catch(ca){}}b5=(b7.length===0||b7.hasClass("easyrecipe")||b7.hasClass("easyrecipeWrapper"));if(b5){try{b5=!(cb[0].nextSibling&&cb[0].nextSibling.nodeType===3)}catch(ca){}}if(!b6&&!b5){return}cb.wrap('<div class="easyrecipeWrapper mceNonEditable" />');b8=cb.parent();if(b6){b8.prepend('<div class="easyrecipeAbove mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line above" /></div>');b8.find("input").on(ar,bO);bT.push(b8.find(".easyrecipeAbove")[0])}if(b5){b8.append('<div class="easyrecipeBelow mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line below" /></div>');b8.find("input").on(ar,bO)}}function h(b5){bP(".easyrecipeAbove,.easyrecipeBelow",b5).remove();bP(".easyrecipe",b5).unwrap()}function by(){var b5=bP(".easyrecipe",aL);if(b5.length===0){return}b5.on("mousedown",null,aB,ae);ah()}function aX(){var ch,cb="",b8,cg="",b5=0,cl="";var cn,cj,cf,b9,cm,cc,ci,b6=[],ca;var b7,ck,ce,cd;if(!U(ay)){return}if(!U(aZ)){return}b8=bP.trim(ay.val());if(b8!==""){bU=t.exec(b8);cn=bU[1]?parseInt(bU[1],10):0;cj=bU[2]?parseInt(bU[2],10):0;b5=cn*60+cj;cf=cn>0?cn+"H":"";b9=cj>0?cj+"M":"";cg="PT"+cf+b9}else{b8=false}ch=bP.trim(aZ.val());if(ch!==""){bU=t.exec(ch);cn=bU[1]?parseInt(bU[1],10):0;cj=bU[2]?parseInt(bU[2],10):0;cf=cn>0?cn+"H":"";b9=cj>0?cj+"M":"";b5+=cn*60+cj;cb="PT"+cf+b9}else{ch=false}if(b5>0){cn=Math.floor(b5/60);cj=b5%60;cf=cn>0?cn+" hour":"";if(cn>1){cf+="s"}b9=cj>0?cj+" min":"";if(cj>1){b9+="s"}b5=bP.trim(cf+" "+b9);cf=cn>0?cn+"H":"";b9=cj>0?cj+"M":"";cl="PT"+cf+b9}else{b5=false}cm=bA.val().split("\n");for(ci=0;ci<cm.length;ci++){cc=cm[ci];if(cc!==""){if(cc.charAt(0)==="!"){ca=true;cc=cc.substr(1)}else{ca=false}b6.push({ingredient:g(y(cc)),hasHeading:ca})}}cm=l.val().split("\n");ck=[];b7={INSTRUCTIONS:[]};for(ci=0;ci<cm.length;ci++){cc=bP.trim(cm[ci].replace(/^[ 0-9\.]*(.*)$/ig,"$1"));if(cc!==""){if(cc.charAt(0)==="!"){if(b7.INSTRUCTIONS.length>0||b7.heading){ck.push(b7)}cc=cc.substr(1);b7={};b7.INSTRUCTIONS=[];b7.heading=y(cc)}else{b7.INSTRUCTIONS.push({instruction:g(y(cc))})}}}if(b7.INSTRUCTIONS.length>0||b7.heading){ck.push(b7)}cc=az(v);if(cc){if(w.wpVersion<"3.5"){cc="<p>"+cc.replace(/\n\n/ig,"</p><p>").replace(/\n/ig,"<br />")+"</p>"}cc=cc.replace(/\n/g,"[br]")}ce={version:w.version,hasPhoto:F!=="",photoURL:F,name:g(y(bE.val())),author:g((az(x))),preptime:b8,cooktime:ch,totaltime:b5,preptimeISO:cg,cooktimeISO:cb,totaltimeISO:cl,yield:az(br),type:g((az(bg))),cuisine:g((az(bx))),summary:g(az(bY)),servesize:az(bn),calories:az(n),fat:az(aE),satfat:az(bH),unsatfat:az(aK),transfat:az(a9),carbs:az(ap),sugar:az(bM),sodium:az(e),fiber:az(D),protein:az(a1),cholesterol:az(c),notes:g(cc),INGREDIENTS:b6,STEPS:ck};if(ce.name===""){ce.name=false}cd=aY(w.recipeTemplate,ce);if(R){bP(".hrecipe",aL).remove()}if(a4===-1){b2=bP(i,aL)}else{b2=bP(".easyrecipe",aL);if(b2.length>0){b2=bP(b2[a4])}}b2.before(cd);b2.remove();b2=false;bJ.show();A=false;bf.dialog(m);a2=bP(".easyrecipe",aL).length;by()}function bw(b8,b5,b9){var b6;var b7;H=false;if(b5.editorId!==au&&b5.editorId!=="wp_mce_fullscreen"){bP("#"+b5.editorId+"_easyrecipeTest").hide();bP("#"+b5.editorId+"_easyrecipeEdit").hide();bP("#"+b5.editorId+"_easyrecipeAdd").hide();return}if(b5.editorId===au){aL=bP("#"+au+"_ifr").contents();ad=10000;b6=bP("#"+au+"_easyrecipeTest");bJ=bP("#"+au+"_easyrecipeEdit")}else{aL=bP("#wp_mce_fullscreen_ifr").contents();ad=200001;b6=bP("#mce_fullscreen_easyrecipeTest");bJ=bP("#mce_fullscreen_easyrecipeEdit")}bt=bP("body",aL);b7=bP(".easyrecipe",aL);S=tinyMCE.activeEditor;b7.each(function(){bP(this).addClass("mceNonEditable");bP(".ERRatingOuter",this).remove();bP(".ERHDPrint",this).remove();bP(".ERLinkback",this).remove()});a2=b7.length;if(a2>0&&w.testURL!==""){b6.show()}else{b6.hide()}if(a2>0){bJ.show()}else{bJ.hide()}if(!aL.hasERCSS){bP("head",aL).append('<link rel="stylesheet" type="text/css" href="'+w.easyrecipeURL+'/css/easyrecipe-entry.css" />');aL.hasERCSS=true}by()}function aU(){bh.toggleClass("ERNone");bk.toggleClass("ERContract")}function ba(){bv.toggleClass("ERNone");bF.toggleClass("ERContract")}function aR(){if(window.getSelection){return window.getSelection()}if(document.getSelection){return document.getSelection()}if(document.selection){return document.selection.createRange().text}return null}function V(b9,b7){var ca,b6,b8,b5=/(?:<a( .*?")>)?<img( (?:.*?)?src="([^"]*?)"(?:.*)) \/>/i;b6=b5.exec(b7);ca=bP("#ertmp_"+s,aL);if(b6!==null){aa(b6[3],bX.length);b8=aT.substring(0,bj);if(!b6[1]){bu.push(b6[2]);b8+="[img:"+bu.length+"]"}else{bo.push(b6[1]);bu.push(b6[2]);b8+="[url:"+bo.length+"][img:"+bu.length+"][/url]"}b8+=aT.substring(aM);o.val(b8)}o[0].focus();ca.remove()}function k(b8){var b5,b6,b7,cb,ca,b9;if(!w.isEntryDialog){return}b5=bP("#ertmp_"+s,aL);if(typeof b8==="string"){b7=bP(b8)}else{b9=b5.html();if(b9==="link"){b7=b5.parent("a");b5=b7}else{b7=bP(b5.html())}}if(b7.is("a")){b6=b7.attr("href");cb=b7.attr("title");ca=b7.attr("target");cb=cb?' title="'+cb+'"':"";ca=ca?' target="'+ca+'"':"";b8='href="'+b6+'"'+ca+cb;bo.push(b8);o.val(aT.substring(0,bj)+"[url:"+bo.length+"]"+aT.substring(bj,aM)+"[/url]"+aT.substring(aM))}o[0].focus();b5.remove()}function ao(){var b7,b8,b6=false,b5;aw()}function aq(){H=false;C()}function aS(){H=false;ae()}function a5(){if(a2>0&&!bZ){bZ=true;bs.parent(".ui-dialog").css(aD,ad);bs.dialog(a0,aD,ad);bs.dialog(J)}}function aI(ca){var b7,b8,b9,b6;var b5=bP("#wp-preview",ca.target).val();if(b5==="dopreview"){return true}if(a2===0){return true}b9=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden();if(b9){b8=bP("<div>"+S.getContent()+"</div>")}else{b6=bP("#wp-content-editor-container").find("textarea");b8=bP("<div>"+b6.val()+"</div>")}h(bP(".easyrecipeWrapper",b8));bP(".easyrecipe",b8).removeClass("mceNonEditable");b7=bP.trim(b8.html());if(b9){S.setContent(b7)}else{b6.val(b7)}return true}function be(b6){var b5;if(b6.target.innerHTML==""){return}b5=bP(b6.target).find("img").attr("src");if(b5){bW(b5,false)}}function aJ(b5){var b6,b9,b8,b7;b6=b5[0];for(b9=0;b9<b6.addedNodes.length;b9++){b8=bP(b6.addedNodes[b9].innerHTML);b7=b8.find("img").attr("src");if(b7){bW(b7,false);break}}}bP(function(){var ca;var b6;var b9;var b7;var b8;var b5=null;w=EASYRECIPE;if(w.button!==bP.fn.button){b5=bP.fn.button;bP.fn.button=w.button}bf=bP("#easyrecipeEntry");N=bP("#easyrecipeUpgrade");bs=bP("#easyrecipeHTMLWarn");au=w.isGuest?"guestpost":"content";bf.dialog({autoOpen:false,width:655,modal:true,dialogClass:"easyrecipeEntry",beforeClose:function(){if(A){if(!window.confirm("Are you sure you want to close without saving the recipe?")){return false}A=false}return true},close:function(){w.isEntryDialog=false;if(b2&&!P){b2.remove()}b2=false;bP(".easyrecipeEntry").filter(function(){return bP(this).text()===""}).remove()},open:function(){w.isEntryDialog=true;bP(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />');d.tabs({active:0,beforeActivate:an});setTimeout(function(){var cb=bP(".easyrecipeEntry");var cc=cb.offset();if(cc.top<Y){cc.top=Y;cb.offset(cc)}},250)}});bf.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bD=bP("#divERContainer").show();bs.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeHTMLWarn",close:function(){bP(".easyrecipeHTMLWarn").filter(function(){return bP(this).text()===""}).remove()},open:function(){bP(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bs.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bP(".divERHTMLWarnContainer").show();N.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeUpgrade",close:function(){bP(".easyrecipeUpgrade").filter(function(){return bP(this).text()===""}).remove()},open:function(){bP(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});N.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bP(".divERUPGContainer").show();u=bP("#easyrecipeConvert");z=bP("#divERCNVSpinner");bK=bP("#btnERCNVCancel");bz=bP("#btnERCNVOK");z.hide();u.dialog({autoOpen:false,width:390,modal:true,dialogClass:"easyrecipeConvert",close:function(){bP(".easyrecipeConvert").filter(function(){return bP(this).text()===""}).remove()},open:function(){bP(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bP("#divERCNVContainer").show();u.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bP(window).bind("easyrecipeadd",aq);bP(window).bind("easyrecipeedit",aS);bP(window).bind("easyrecipeload",bw);bP(window).bind("easyrecipeimage",V);bP(window).bind("easyrecipeguestimageuploaded",V);bb=bP("#divERNext");X=bP("#btnERButtons");d=bP("#ERDTabs");aH=bP("#divERPhotos");bP("input:submit",".easyrecipeUI").button();f=bP("#ed_toolbar");bE=bP("#inpERName");x=bP("#inpERAuthor");bg=bP("#inpERType");bx=bP("#inpERCuisine");aW=bP("#inpERTags");bY=bP("textarea#taERSummary");bA=bP("textarea#taERIngredients");l=bP("textarea#taERInstructions");ay=bP("#inpERPrepTime");aZ=bP("#inpERCookTime");br=bP("#inpERYield");bn=bP("#inpERServeSize");n=bP("#inpERCalories");aE=bP("#inpERFat");bH=bP("#inpERSatFat");aK=bP("#inpERUnsatFat");a9=bP("#inpERTransFat");ap=bP("#inpERCarbs");bM=bP("#inpERSugar");e=bP("#inpERSodium");D=bP("#inpERFiber");a1=bP("#inpERProtein");c=bP("#inpERCholesterol");v=bP("textarea#taERNotes");E=bP("#divERAddImageURL");b8=bP("#lnkERPhotoURL");bC=bP(".ERTimeError");bV=bP("#divERAdd");bG=bP("#divERChange");M=bP("#divERHeader");bh=bP("#divEROther");bk=bP("#divEROtherLabel");bv=bP("#divERNotes");bF=bP("#divERNotesLabel");at=bP("#ERDPasteTab");aA=bP("#fldERAPUImageURL");bP("#btnERAdd").click(aX);bP("#btnERNext").click(a);bP("#btnERChange").click(aX);bP("#btnERDelete").click(r);bP("#btnERCancel").click(a7);b8.click(function(){N.parent(".ui-dialog").css(aD,ad);N.dialog(a0,aD,ad);N.dialog(J)});bP("#btnERAIUCancel").click(function(){E.hide()});bP("#btnERAIUOK").click(af);bk.click(aU);bF.click(ba);ay.change(function(cb){U(bP(cb.target))});aZ.change(function(cb){U(bP(cb.target))});bP("#btnERPaste").click(al);Y=bP("#wpadminbar").height();a6=bP("#divEREditBtns").on("mousedown","li",ao);bD.find('input[type="text"], textarea').on("blur",function(){aj=null}).on("focus",function(){aj=bP(this)});bP("#wp-link").bind("wpdialogclose",k);bB=C;b0=ae;W=false;w.insertLink=k;w.insertUploadedImage=V;bc=bS;ac=aa;w.addListener=by;bs.find("input").on(ar,function(){bs.dialog(m)});bP("#wp-content-editor-tools").on(ar,"#content-html",a5);bP("#post").on("submit",aI);if(b5!==null){bP.fn.button=b5}ca=bP("#postimagediv").find(".inside");if(window.MutationObserver&&ca.length>0){b6=new MutationObserver(aJ);b6.observe(ca[0],{childList:true})}else{ca.on("DOMSubtreeModified",be)}})}(jQuery));