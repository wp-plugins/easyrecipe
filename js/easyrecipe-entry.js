(function(bK){var H=jQuery.trim;var R,S,bz,bS,bw,k,ax,aW,bn,at;var w,bd,bt,aT,by,N=false,Q,bD,bV,O,f;var bL=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i;var o=/^#([_a-z][_0-9a-z]{0,19})#/im;var b=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m;var bf=/^([^<]*)/,s=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,aB=/^([0-9]+)$/;var bU=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/;var bb,a5,bx,bT,V;var au=/PT(?:([0-9]*)+H)?([0-9]+)+M/i;var ak=/\[(?:img) +(?:[^\]]+?)\]/ig;var P=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i;var a1=/(.*)(?:^| )photo(?: |$)(.*)/ig;var am=/class\s*=\s*"([^"]+)"/ig;var bj=/src\s*=\s*" *([^"]+?) *"/i;var bl=[];var bq=[];var aF='<input type="button" class="ed_button" value="EasyRecipe" />',E="Use the Visual Editor to add or edit an EasyRecipe";var bg,aK,aQ,ah=null,r=0,n,v,bo;var aM='<div class="easyrecipeholder">EasyRecipe</div>',i=".easyrecipeholder",aL="ERSeparator";var bc,M,F,t,aJ=null,bp,ac,bO,aX="option",aC="zIndex",d,W,a9,bR,aG;var ar,y,bF,bv,bQ,bB,L,be,bh,br,bA;var bk,m,aD,bC,aI,a7,ao,bH,e,B,aY,c,u,bE;var aZ=0,a2,J=true,C,az,bI,X,a4;var l="close",aq="click",aN="undefined",I="open",aS="ERPhotoSelected",af="http://www.easyrecipeplugin.com/checkUpdates.php";var aw='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>';var bi,aE=-1,aA=-2,D="",bm,ai="&nbsp;",ba,ab,G;function al(bX,bY){W.show();a4.hide();a9.show();switch(bY.index){case 0:a4.css("right","10px");a4.show();break;case 3:a4.css("right","inherit");a9.hide();a4.show();break;case 4:W.hide();break}}function bG(bX){return bX?bX.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," "):""}function x(bX){return bX?bK("<div />").text(bX).html():""}function ay(bX){return bK.trim(x(bX.val()))||false}function a(bY,bZ){var bX=d.tabs("option","selected");d.tabs("option","selected",++bX)}function ag(bY){var b0,bX=/\[img +(.*?) *\/?\]/i,bZ=/\[url ([^\]]+)\](.*?\[\/url\])/i;b0=bX.exec(bY);while(b0!==null){bq.push(b0[1]);bY=bY.replace(bX,"[img:"+bq.length+"]");b0=bX.exec(bY)}b0=bZ.exec(bY);while(b0!==null){bl.push(b0[1]);bY=bY.replace(bZ,"[url:"+bl.length+"]$2");b0=bZ.exec(bY)}return bY}function g(bY){var b1,b0,bX=/\[img:(\d+)\]/i,bZ=/\[url:(\d+)\](.*?)\[\/url\]/i;b0=bX.exec(bY);while(b0!==null){b1=bq[b0[1]-1];bY=bY.replace(bX,"[img "+b1+"]");b0=bX.exec(bY)}b0=bZ.exec(bY);while(b0!==null){b1=bl[b0[1]-1];bY=bY.replace(bZ,"[url "+b1+"]$2[/url]");b0=bZ.exec(bY)}return bY}function aV(cr,cd){var cj=0,ce=1,bX=2,ct;var ck,cb,b4,ca="",b9="",cm,bY,b1,cl,co;var cn="<!-- START REPEAT ",cv="<!-- START INCLUDEIF ",cu="<!-- END INCLUDEIF ";var b0,bZ,b6,cq,ch,b5,cc,ci,cs,b8;var b2,cg,cp;var b7,cf,b3;ct=cr;cd=cd||{};while(true){cm=ct.length;bY=ct.indexOf("#",ca);if(bY!==-1){cm=bY;b1=cj}cl=ct.indexOf(cn,ca);if(cl!==-1&&cl<cm){cm=cl;b1=ce}co=ct.indexOf(cv,ca);if(co!==-1&&co<cm){cm=co;b1=bX}if(cm===ct.length){return b9+ct.substr(ca)}b0=cm-ca;b9+=ct.substr(ca,b0);ca=cm;switch(b1){case bX:cb=ct.substr(ca,44);b4=bL.exec(cb);if(b4!==null){bZ=b4[1];b6=bZ!=="!";cq=b4[2]}else{break}ch=cu+bZ+cq+" -->";b5=ch.length;cc=ct.indexOf(ch);if(cc===-1){ca++;break}ci=typeof cd[cq]!==aN&&cd[cq]!==false;if(ci===b6){cs="<!-- START INCLUDEIF "+bZ+cq+" -->";b8=cs.length;ct=ct.substr(0,ca)+ct.substr(ca+b8,cc-ca-b8)+ct.substr(cc+b5)}else{ct=ct.substr(0,ca)+ct.substr(cc+b5)}break;case cj:cb=ct.substr(ca,22);b4=o.exec(cb);if(b4===null){b9+="#";ca++;continue}b2=b4[1];if(cd[b2]!==""&&!cd[b2]){b9+="#"+b2+"#";ca+=b2.length+2;continue}b9+=cd[b2];ca+=b2.length+2;break;case ce:cb=ct.substr(ca,45);b4=b.exec(cb);if(b4===null){b9+="<";ca++;continue}cg=b4[1];if(!cd[cg]||!(cd[cg] instanceof Array)){b9+="<";ca++;continue}ca+=cg.length+22;cp=ct.indexOf("<!-- END REPEAT "+cg+" -->",ca);if(cp===-1){b9+="<!-- START REPEAT "+cg+" -->";continue}b7=cp-ca;cf=ct.substr(ca,b7);b3=cd[cg];for(ck=0;ck<b3.length;ck++){b9+=aV(cf,b3[ck])}ca+=cg.length+b7+20;break}}}function T(b1){var bX=bK.trim(b1.val()),bY=0,b0=0,bZ,b2;by.hide();if(bX===""){return true}bO=s.exec(bX);if(bO===null){bO=aB.exec(bX);if(bO===null){by.show();return false}bY=0;b0=bO[1]}else{bY=bO[1]?parseInt(bO[1],10):0;b0=bO[2]?parseInt(bO[2],10):0}if(bY===0&&b0===0){b1.val("")}else{bZ=bY>0?bY+" hour":"";if(bY>1){bZ+="s"}b2=b0>0?b0+" min":"";if(b0>1){b2+="s"}b1.val(bK.trim(bZ+" "+b2))}return true}function p(b1){var bY,bX,bZ,b0="";for(bY=0;bY<b1.length;bY++){bX=b1[bY];if(bX.nodeType===3){bZ=bK.trim(bX.nodeValue);if(bZ!==""){b0+=bZ+"\n"}continue}if(bX.nodeType!==1){continue}if(bX.childNodes.length>0){b0+=p(bX.childNodes)}}return b0}function bM(){bK(i,aJ).remove();var bY=tinyMCE.activeEditor;var bX=R.selection.getNode();if(bX.nodeName==="#document"){bX=bp[0]}if(bX.nodeName.toUpperCase()==="BODY"){if(!bK(bX).hasClass("mceContentBody")){bX=bp[0]}bK(bX).append("&nbsp;"+aM)}else{while(bX.parentNode&&bX.parentNode.nodeName.toUpperCase()!=="BODY"){bX=bX.parentNode}if(!bX.parentNode){bX=bp[0];bK(bX).append("&nbsp;"+aM)}else{if(bX.nodeName.toUpperCase()==="DIV"||bX.nodeName.toUpperCase()==="SPAN"){bK(bX,aJ).after(aM)}else{bK(bX,aJ).before(aM)}}}a2=-1;return bK(i,aJ)}function Y(bX,bZ,bY){}function Z(bY,bZ,bX){switch(bY.type){case"js":bK("head").append(bK('<script type="text/javascript">'+bY.js+"<\/script>"));v[bY.f]();break;case"html":bK(bY.dest).html(bY.html);break}}function bW(){bF.unbind(aq);bv.unbind(aq);t.dialog(l);N=true;bx()}function K(b1,bY){var b0,bX="",bZ=b1.recipe;if(bY!=="success"){t.dialog(l);N=true;bx()}bz.val(bG(bZ.recipe_title));D=bZ.recipe_image;bd.val("");w.val("");bt.val("");aT.val("");bS.val(bG(bZ.summary));bO=au.exec(bZ.prep_time);if(bO!==null){b0=bO[1]?bO[1]+"h ":"";ax.val(b0+bO[2]+"m")}else{ax.val(bG(bZ.prep_time))}bO=au.exec(bZ.cook_time);if(bO!==null){b0=bO[1]?bO[1]+"h ":"";aW.val(b0+bO[2]+"m")}else{aW.val(bG(bZ.cook_time))}bn.val(bG(bZ.yield));m.val(bG(bZ.calories));aD.val(bG(bZ.fat));bk.val(bG(bZ.serving_size));for(b0=0;b0<b1.ingredients.length;b0++){bX+=H(bG(b1.ingredients[b0]))+"\n"}bw.val(bX);k.val(bG(bZ.instructions.replace("\r","")));u.val(bG(bZ.notes));bc.dialog("option","title","Update Recipe");t.dialog(l);bQ.hide();bB.show();ar.hide();if(D!==""){ab(D,bR.length,true)}bV=bM();bc.dialog(aX,aC,ac);bc.dialog(I)}function a0(){y.show();bF.unbind(aq);bv.unbind(aq);var bX={action:"easyrecipeConvert",id:bb,type:a5};bK.post(ajaxurl,bX,K,"json")}function z(b4){var b5,b2,b6,b3=0,bX,b1="",bZ="",bY="",b0="";bX=bK("<div>"+b4+"</div>");b5=p(bX[0].childNodes);b5=b5.split("\n");for(b2=0;b2<b5.length;b2++){b6=bK.trim(b5[b2]);if(b6===""){continue}if(/^(?:instruction|method|cooking method|procedure)/i.test(b6)){b3=2;continue}if(/^Ingredient/i.test(b6)){b3=1;continue}if(/^(?:note|cooking note)s?\s*$/i.test(b6)){b3=3;continue}switch(b3){case 0:b1+=b6+"\n";break;case 1:bZ+=b6+"\n";break;case 2:bY+=b6+"\n";break;case 3:b0+=b6+"\n";break}}return{summary:b1,ingredients:bZ,instructions:bY,notes:b0}}function av(bX){M.dialog(aX,aC,ac);M.dialog(I)}function aa(b0,bX,bY){var b1=function(){var b2,b6,b5,b3,b4=bK.data(this,"index");b2=this.width/150;b6=this.height/112;b2=b2>b6?b2:b6;b5=Math.floor(this.height/b2);b3=Math.floor(this.width/b2);bR[b4].height(b5);bR[b4].width(b3);bR[b4].css("top",(112-b5)/2);bR[b4].attr("src",this.src);if(b4===0){bK("#ERDTabs .divERNoPhotos").remove()}};aG.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+bX+'" /></div>');bR[bX]=bK("#ERPhoto_"+bX,aG);bR[bX].data("src",b0);if(bY){bK(".ERPhoto",aG).removeClass(aS);bR[bX].parent().addClass(aS);bI=bX;D=b0}if(bm===""){bm=b0}var bZ=new Image();bK.data(bZ,"index",bX);bZ.onload=b1;bZ.src=b0}function ae(){aa(az.val(),bR.length,true);az.val("");C.hide();bK(".divERNoPhotos").remove()}function ad(cc,cf){var cg,bX,cb,ca,b6,b5,b7,b8,ch;var b0={},b4="",bY="",bZ="",b9="",ce;if(cf===aE&&aZ!==0){av();return}if(cc&&cc.data===aA){cf=aA;cc=cc.delegateTarget}if(typeof cf===aN&&typeof cc===aN){a2=0}aZ=1;a2=0;bV=bK(".easyrecipe:first",aJ);if(cf!==aE&&bV.length>1){bV=bK(bV[cf]);a2=cf}b7=bK.support.cors?"json":"jsonp";bK.ajax(af,{dataType:b7,data:{v:v.version},success:Z,error:Y});S=false;if(typeof tinyMCE!==aN){if(tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()){S=true}}if(!S){alert("You must use the Visual Editor to add or update an EasyRecipe");return}bz.val("");bd.val("");bt.val("");aT.val("");w.val("");bS.val("");ax.val("");aW.val("");bn.val("");bw.val("");k.val("");bk.val("");m.val("");aD.val("");bC.val("");aI.val("");a7.val("");ao.val("");bH.val("");e.val("");B.val("");aY.val("");c.val("");u.val("");if(cf!==aE&&bV.length===1){bc.dialog("option","title","Update Recipe");ar.hide();bQ.hide();bB.show();O=true}else{bD=R.getContent();if(!N){b6=bU.exec(bD);if(b6){a5=b6[2];bb=b6[3];y.hide();bF.click(bW);bv.click(a0);var b1=a5==="recipeseo"?"RecipeSEO":"ZipList";ca=bK("#txtERCNVText1",t);ca.html(ca.html().replace("#plugin#",b1));aG.html("");bI=-1;bR=[];aG.html(aw);t.dialog(aX,aC,ac);t.dialog(I);return}}if(v.isGuest){w.val(bK("#inpERAuthor").val())}bQ.show();bB.hide();ar.show();bc.dialog("option","title","Add a New Recipe");O=false;if(V!==false){b0=z(V)}else{ce=R.selection.getContent();if(ce.length>20){b0=z(ce)}}if(b0.summary){b4=b0.summary}if(b0.ingredients){bY=b0.ingredients}if(b0.instructions){bZ=b0.instructions}if(b0.notes){b9=b0.notes}bV=bM()}bK("#inpERCuisine").autocomplete({source:bK.parseJSON(v.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');bK("#inpERType").autocomplete({source:bK.parseJSON(v.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');Q=false;if(bK(".hrecipe",aJ).length>0){if(confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")){Q=true}}bi=(cf!==aE)?bV.find(".endeasyrecipe").text():v.version;if(bi===""){bi="2.2"}D=bK('link[itemprop="image"]',bV).attr("href")||"";aG.html("");bI=-1;bm="";bR=[];aJ.find("img").each(function(ci){var cj=false;if(bi<"3"){if(bK(this).hasClass("photo")){cj=true}}else{cj=this.src===D}aa(this.src,ci,cj)});var cd=aJ.contents().text();b6=ak.exec(cd);b8=bR.length;while(b6!==null){var b3,b2=bj.exec(b6[0]);if(b2!==null){b3=b2[1];aa(b3,b8);if(bi>"3"){if(D===b3){bR[b8].parent().addClass(aS);bI=b8}}else{if(P.test(b6[0])){bR[b8].parent().addClass(aS);bI=b8;D=b3}}b8++}b6=ak.exec(cd)}if(D!==""){bX=false;for(cg=0;cg<bR.length;cg++){if(bR[cg].data("src")===D){bX=true;break}}if(!bX){aa(D,bR.length,true)}}if(bI===-1&&bR.length>0){bI=0;D=bm;bR[0].parent().addClass(aS)}aG.click(function(ci){M.dialog(aX,aC,ac);M.dialog(I)});if(bR.length===0){aG.html(aw)}else{if(bI===-1){bR[0].parent().addClass(aS)}}bq=[];bl=[];if(bi>"3"){ch=bV.find(".ERName").html()}else{ch=bV.find(".fn").html()}if(typeof ch===aN||!ch){bz.val(ag(bG(bK("#title").val())))}else{bz.val(ag((bG(ch))))}bd.val(ag(bG(bV.find(".type").html())));w.val(ag(bG(bV.find(".author").html())));if(w.val()===""){w.val(ag(bK.parseJSON(v.author)))}bt.val(ag(bG(bV.find(".cuisine").html())));bS.val(ag(b4+bG(bV.find(".summary").html())));if(bi>"3"){b5=bV.find('time[itemprop="prepTime"]').html()||"";ax.val(bG(b5));b5=bV.find('time[itemprop="cookTime"]').html()||"";aW.val(bG(b5))}else{b5=bV.find(".preptime").html()||"";b6=bf.exec(b5);if(b6!==null){ax.val(bG(b6[1]))}else{ax.val("")}b5=bV.find(".cooktime").html()||"";b6=bf.exec(b5);if(b6!==null){aW.val(bG(b6[1]))}else{aW.val("")}}bn.val(bG(bV.find(".yield").html()));bV.find(".ingredients li").each(function(cj,ci){if(bK(ci).hasClass(aL)){bY+="!"+ag(bG(ci.innerHTML))+"\n"}else{bY+=ag(bG(ci.innerHTML))+"\n"}});bw.val(bY);bV.find(".instructions li, .instructions .ERSeparator").each(function(cj,ci){cb=bK.trim(ci.innerHTML.replace(/^[ 0-9.]*(.*)$/ig,"$1"));if(bK(ci).hasClass(aL)){bZ+="!"+cb+"\n"}else{bZ+=cb+"\n"}});k.val(ag(bG(bZ)));bk.val(bG(bV.find(".servingSize").html()));m.val(bG(bV.find(".calories").html()));aD.val(bG(bV.find(".fat").html()));bC.val(bG(bV.find(".saturatedFat").html()));aI.val(bG(bV.find(".unsaturatedFat").html()));a7.val(bG(bV.find(".transFat").html()));ao.val(bG(bV.find(".carbohydrates").html()));bH.val(bG(bV.find(".sugar").html()));e.val(bG(bV.find(".sodium").html()));B.val(bG(bV.find(".fiber").html()));aY.val(bG(bV.find(".protein").html()));c.val(bG(bV.find(".cholesterol").html()));cb=(bV.find(".ERNotes").html()||"").replace(/<\/p>\n*<p>/ig,"\n\n").replace(/(?:<p>|<\/p>)/ig,"").replace(/<br *\/?>/ig,"\n");if(cb===""&&b9!==""){cb=b9}u.val(ag(cb));if(G){if(G.name){bz.val(ag((bG(G.name))))}if(G.author){w.val(ag(G.author))}if(G.summary){bS.val(ag(G.summary))}if(G.yield){bn.val(bG(G.yield))}if(G.type){bd.val(ag(bG(G.type)))}if(G.cuisine){bt.val(ag(bG(G.cuisine)))}if(G.prepTime){ax.val(bG(G.prepTime))}if(G.cookTime){aW.val(bG(G.cookTime))}if(G.summary){bS.val(ag(G.summary))}}bc.dialog(aX,aC,ac);bc.dialog(I);bc.dialog("option","position","center")}function A(bX){aZ=bK(".easyrecipe",aJ).length;if(J||aZ===0){ad(bX,aE);return}M.dialog(aX,aC,ac);M.dialog(I)}function a6(){bc.dialog(l)}function q(){var bX=confirm("Are you sure you want to delete this recipe?");if(bX){bV.remove();bV=false}bc.dialog(l)}function aj(){var bX,bY=bK("#inpERPaste").val();bX=z(bY);if(bX.ingredients.length===0&&bX.instructions.length===0){return}V=bY;bK("#inpERPaste").val("");G={name:g(x(bz.val())),author:g((ay(w))),yield:ay(bn),type:g((ay(bd))),cuisine:g((ay(bt))),summary:g(ay(bS)),servesize:ay(bk),prepTime:ax.val(),cookTime:aW.val()};bc.dialog(l);A(null)}function bJ(bZ){var bY=bK(bZ.target).parent();var b0=bY.parent();if(bY.hasClass("easyrecipeAbove")){b0.before(ai)}else{b0.after(ai)}bK(".easyrecipeAbove,.easyrecipeBelow",b0).remove();var bX=bK(".easyrecipe",b0).unwrap();ba(bX)}function bN(b1){var bY,bX,b0,bZ;b0=b1.prev();bZ=b1.next();bY=(b0.length===0||b0.hasClass("easyrecipe")||b0.hasClass("easyrecipeWrapper"));if(bY){bY=!(b1[0].previousSibling&&b1[0].previousSibling.nodeType===3)}bX=(bZ.length===0||bZ.hasClass("easyrecipe")||bZ.hasClass("easyrecipeWrapper"));if(bX){bX=!(b1[0].nextSibling&&b1[0].nextSibling.nodeType===3)}if(!bY&&!bX){return}b1.wrap('<div class="easyrecipeWrapper" />');if(bY){b1.parent().prepend('<div class="easyrecipeAbove"><input class="ERInsertLine" type="button" value="Insert line above" /></div>')}if(bX){b1.parent().append('<div class="easyrecipeBelow"><input class="ERInsertLine" type="button" value="Insert line below" /></div>')}bK(".easyrecipeWrapper .ERInsertLine",aJ).on(aq,bJ)}function h(bX){bK(".easyrecipeAbove,.easyrecipeBelow",bX).remove();bK(".easyrecipe",bX).unwrap()}function bu(){var bX=bK(".easyrecipe",aJ);if(bX.length===0){return}bX.on("mousedown",null,aA,ad);h(bK(".easyrecipeWrapper",aJ));bX.each(function(){bN(bK(this))})}function aU(){var b9,b3="",b0,b8="",bX=0,cd="";var cf,cb,b7,b1,ce,b4,ca,bY=[],b2;if(!T(ax)){return}if(!T(aW)){return}b0=bK.trim(ax.val());if(b0!==""){bO=s.exec(b0);cf=bO[1]?parseInt(bO[1],10):0;cb=bO[2]?parseInt(bO[2],10):0;bX=cf*60+cb;b7=cf>0?cf+"H":"";b1=cb>0?cb+"M":"";b8="PT"+b7+b1}else{b0=false}b9=bK.trim(aW.val());if(b9!==""){bO=s.exec(b9);cf=bO[1]?parseInt(bO[1],10):0;cb=bO[2]?parseInt(bO[2],10):0;b7=cf>0?cf+"H":"";b1=cb>0?cb+"M":"";bX+=cf*60+cb;b3="PT"+b7+b1}else{b9=false}if(bX>0){cf=Math.floor(bX/60);cb=bX%60;b7=cf>0?cf+" hour":"";if(cf>1){b7+="s"}b1=cb>0?cb+" min":"";if(cb>1){b1+="s"}bX=bK.trim(b7+" "+b1);b7=cf>0?cf+"H":"";b1=cb>0?cb+"M":"";cd="PT"+b7+b1}else{bX=false}ce=bw.val().split("\n");for(ca=0;ca<ce.length;ca++){b4=ce[ca];if(b4!==""){if(b4.charAt(0)==="!"){b2=true;b4=b4.substr(1)}else{b2=false}bY.push({ingredient:g(x(b4)),hasHeading:b2})}}ce=k.val().split("\n");var cc=[];var bZ={INSTRUCTIONS:[]};for(ca=0;ca<ce.length;ca++){b4=bK.trim(ce[ca].replace(/^[ 0-9\.]*(.*)$/ig,"$1"));if(b4!==""){if(b4.charAt(0)==="!"){if(bZ.INSTRUCTIONS.length>0||bZ.heading){cc.push(bZ)}b4=b4.substr(1);bZ={};bZ.INSTRUCTIONS=[];bZ.heading=x(b4)}else{bZ.INSTRUCTIONS.push({instruction:g(x(b4))})}}}if(bZ.INSTRUCTIONS.length>0||bZ.heading){cc.push(bZ)}b4=ay(u);if(b4){b4="<p>"+b4.replace(/\n\n/ig,"</p><p>").replace(/\n/ig,"<br />")+"</p>"}var b6={version:v.version,hasPhoto:D!=="",photoURL:D,name:g(x(bz.val())),author:g((ay(w))),preptime:b0,cooktime:b9,totaltime:bX,preptimeISO:b8,cooktimeISO:b3,totaltimeISO:cd,yield:ay(bn),type:g((ay(bd))),cuisine:g((ay(bt))),summary:g(ay(bS)),servesize:ay(bk),calories:ay(m),fat:ay(aD),satfat:ay(bC),unsatfat:ay(aI),transfat:ay(a7),carbs:ay(ao),sugar:ay(bH),sodium:ay(e),fiber:ay(B),protein:ay(aY),cholesterol:ay(c),notes:g(b4),INGREDIENTS:bY,STEPS:cc};var b5=aV(v.recipeTemplate,b6);if(Q){bK(".hrecipe",aJ).remove()}if(a2===-1){bV=bK(i,aJ)}else{bV=bK(".easyrecipe",aJ);if(bV.length>0){bV=bK(bV[a2])}}bV.before(b5);bV.remove();bV=false;bE.show();bc.dialog(l);aZ=bK(".easyrecipe",aJ).length;bu()}function bs(b0,bX,b1){G=false;if(bX.editorId!==at&&bX.editorId!=="wp_mce_fullscreen"){bK("#"+bX.editorId+"_easyrecipeTest").hide();bK("#"+bX.editorId+"_easyrecipeEdit").hide();bK("#"+bX.editorId+"_easyrecipeAdd").hide();return}var bY;if(bX.editorId===at){aJ=bK("#"+at+"_ifr").contents();ac=10000;bY=bK("#"+at+"_easyrecipeTest");bE=bK("#"+at+"_easyrecipeEdit")}else{aJ=bK("#wp_mce_fullscreen_ifr").contents();ac=200001;bY=bK("#mce_fullscreen_easyrecipeTest");bE=bK("#mce_fullscreen_easyrecipeEdit")}bp=bK("body",aJ);var bZ=bK(".easyrecipe",aJ);R=tinyMCE.activeEditor;bZ.each(function(){bK(this).addClass("mceNonEditable");bK(".ERRatingOuter",this).remove();bK(".ERHDPrint",this).remove();bK(".ERLinkback",this).remove()});aZ=bZ.length;if(aZ>0&&v.testURL!==""){bY.show()}else{bY.hide()}if(aZ>0){bE.show()}else{bE.hide()}if(!aJ.hasERCSS){bK("head",aJ).append('<link rel="stylesheet" type="text/css" href="'+v.easyrecipeURL+'/css/easyrecipe-entry.css" />');aJ.hasERCSS=true}bu()}function aR(){be.toggleClass("ERNone");bh.toggleClass("ERContract")}function a8(){br.toggleClass("ERNone");bA.toggleClass("ERContract")}function aO(){if(window.getSelection){return window.getSelection()}if(document.getSelection){return document.getSelection()}if(document.selection){return document.selection.createRange().text}return null}function U(b1,bZ){var b2,bY,b0,bX=/(?:<a( .*?")>)?<img( (?:.*?)?src="([^"]*?)"(?:.*)) \/>/i;bY=bX.exec(bZ);b2=bK("#ertmp_"+r,aJ);if(bY!==null){aa(bY[3],bR.length);b0=aQ.substring(0,bg);if(!bY[1]){bq.push(bY[2]);b0+="[img:"+bq.length+"]"}else{bl.push(bY[1]);bq.push(bY[2]);b0+="[url:"+bl.length+"][img:"+bq.length+"][/url]"}b0+=aQ.substring(aK);n.val(b0)}n[0].focus();b2.remove()}function j(b0){var bX,bY,bZ,b2,b1;if(!v.isEntryDialog){return}bX=bK("#ertmp_"+r,aJ);if(typeof b0==="string"){bZ=bK(b0)}else{bZ=bK(bX.html())}if(bZ.is("a")){bY=bZ.attr("href");b2=bZ.attr("title");b1=bZ.attr("target");b2=b2?' title="'+b2+'"':"";b1=b1?' target="'+b1+'"':"";b0='href="'+bY+'"'+b1+b2;bl.push(b0);n.val(aQ.substring(0,bg)+"[url:"+bl.length+"]"+aQ.substring(bg,aK)+"[/url]"+aQ.substring(aK))}n[0].focus();bX.remove()}function an(){av()}function ap(){G=false;A()}function aP(){G=false;ad()}function a3(bX){if(aZ>0){bo.dialog(aX,aC,ac);bo.dialog(I)}}function aH(b1){var bY,bZ,b0,bX;if(aZ===0){return}b0=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden();if(b0){bZ=bK("<div>"+R.getContent()+"</div>")}else{bX=bK("#wp-content-editor-container textarea");bZ=bK("<div>"+bX.val()+"</div>")}h(bK(".easyrecipeWrapper",bZ));bK(".easyrecipe",bZ).removeClass("mceNonEditable");bY=bK.trim(bZ.html());if(b0){R.setContent(bY)}else{bX.val(bY)}return true}function bP(){bc=bK("#easyrecipeEntry");M=bK("#easyrecipeUpgrade");bo=bK("#easyrecipeHTMLWarn");v=EASYRECIPE;at=v.isGuest?"guestpost":"content";bc.dialog({autoOpen:false,width:655,modal:true,dialogClass:"easyrecipeEntry",close:function(){v.isEntryDialog=false;if(bV&&!O){bV.remove()}bV=false;bK(".easyrecipeEntry").filter(function(){if(bK(this).text()===""){return true}return false}).remove()},open:function(bY,bZ){v.isEntryDialog=true;var bX=bK(".easyrecipeEntry").offset();bK(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />');d.tabs({selected:0,select:al});setTimeout(function(){var b0=bK(".easyrecipeEntry");var b1=b0.offset();if(b1.top<X){b1.top=X;b0.offset(b1)}},250)}});bc.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bK("#divERContainer").show();bo.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeHTMLWarn",close:function(){bK(".easyrecipeHTMLWarn").filter(function(){if(bK(this).text()===""){return true}return false}).remove()},open:function(bX,bY){bK(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bo.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bK(".divERHTMLWarnContainer").show();M.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeUpgrade",close:function(){bK(".easyrecipeUpgrade").filter(function(){if(bK(this).text()===""){return true}return false}).remove()},open:function(bX,bY){bK(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});M.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bK(".divERUPGContainer").show();t=bK("#easyrecipeConvert");y=bK("#divERCNVSpinner");bF=bK("#btnERCNVCancel");bv=bK("#btnERCNVOK");y.hide();t.dialog({autoOpen:false,width:390,modal:true,dialogClass:"easyrecipeConvert",close:function(){bK(".easyrecipeConvert").filter(function(){if(bK(this).text()===""){return true}return false}).remove()},open:function(bX,bY){bK(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bK("#divERCNVContainer").show();t.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bK(window).bind("easyrecipeadd",ap);bK(window).bind("easyrecipeedit",aP);bK(window).bind("easyrecipeload",bs);bK(window).bind("easyrecipeimage",U);bK(window).bind("easyrecipeguestimageuploaded",U);a9=bK("#divERNext");W=bK("#btnERButtons");d=bK("#ERDTabs");aG=bK("#divERPhotos");bK("input:submit",".easyrecipeUI").button();f=bK("#ed_toolbar");bz=bK("#inpERName");w=bK("#inpERAuthor");bd=bK("#inpERType");bt=bK("#inpERCuisine");aT=bK("#inpERTags");bS=bK("textarea#taERSummary");bw=bK("textarea#taERIngredients");k=bK("textarea#taERInstructions");ax=bK("#inpERPrepTime");aW=bK("#inpERCookTime");bn=bK("#inpERYield");bk=bK("#inpERServeSize");m=bK("#inpERCalories");aD=bK("#inpERFat");bC=bK("#inpERSatFat");aI=bK("#inpERUnsatFat");a7=bK("#inpERTransFat");ao=bK("#inpERCarbs");bH=bK("#inpERSugar");e=bK("#inpERSodium");B=bK("#inpERFiber");aY=bK("#inpERProtein");c=bK("#inpERCholesterol");u=bK("textarea#taERNotes");C=bK("#divERAddImageURL");by=bK(".ERTimeError");bQ=bK("#divERAdd");bB=bK("#divERChange");L=bK("#divERHeader");be=bK("#divEROther");bh=bK("#divEROtherLabel");br=bK("#divERNotes");bA=bK("#divERNotesLabel");ar=bK("#ERDPasteTab");az=bK("#fldERAPUImageURL");bK("#btnERAdd").click(aU);bK("#btnERNext").click(a);bK("#btnERChange").click(aU);bK("#btnERDelete").click(q);bK("#btnERCancel").click(a6);bK("#lnkERPhotoURL").click(function(){M.dialog(aX,aC,ac);M.dialog(I)});bK("#btnERAIUCancel").click(function(){C.hide()});bK("#btnERAIUOK").click(ae);bh.click(aR);bA.click(a8);bK("#inpERPrepTime").change(function(bX){T(bK(bX.target))});bK("#inpERCookTime").change(function(bX){T(bK(bX.target))});bK("#btnERPaste").click(aj);X=bK("#wpadminbar").height();a4=bK("#divEREditBtns").on("mousedown","#divEREditBtns li",an);bK('#divERContainer input[type="text"], #divERContainer textarea').on("blur",function(){ah=null}).on("focus",function(){ah=bK(this)});bK("#wp-link").bind("wpdialogclose",j);bx=A;bT=ad;V=false;v.insertLink=j;v.insertUploadedImage=U;ba=bN;ab=aa;bK("#easyrecipeHTMLWarn input").on(aq,function(){bo.dialog(l)});bK("#wp-content-editor-tools").on(aq,"#content-html",a3);bK("#post").on("submit",aH)}bK(bP)}(jQuery));