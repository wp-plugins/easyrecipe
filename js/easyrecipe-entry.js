/*! EasyRecipe 3.2.2802 Copyright (c) 2014 BoxHill LLC */
window.EASYRECIPE=window.EASYRECIPE||{},EASYRECIPE.widget=EASYRECIPE.widget||jQuery.widget,EASYRECIPE.button=EASYRECIPE.button||jQuery.fn.button,function(e){function i(e,i){var t;switch(Pi.show(),ht.hide(),Mi.show(),t=i.newTab?i.newTab.index():i.index){case 0:ht.css("right","10px"),ht.show();break;case 3:ht.css("right","inherit"),Mi.hide(),ht.show();break;case 4:Pi.hide()}}function t(){Et.off("change",t),ln=!0}function n(e){return e?(e+="",e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")):""}function a(i){return i?e("<div />").text(i).html():""}function r(i){return e.trim(a(i.val()))||!1}function s(){var e=Ai.tabs("option","active");Ai.tabs("option","active",++e)}function o(e){var i,t=/\[img +(.*?) *\/?\]/i,n=/\[url ([^\]]+)\](.*?\[\/url\])/i;for(i=t.exec(e);null!==i;)Dt.push(i[1]),e=e.replace(t,"[img:"+Dt.length+"]"),i=t.exec(e);for(i=n.exec(e);null!==i;)Lt.push(i[1]),e=e.replace(n,"[url:"+Lt.length+"]$2"),i=n.exec(e);return e}function l(e){var i,t,n=/\[img:(\d+)\]/i,a=/\[url:(\d+)\](.*?)\[\/url\]/i;for(t=n.exec(e);null!==t;)i=Dt[t[1]-1],e=e.replace(n,"[img "+i+"]"),t=n.exec(e);for(t=a.exec(e);null!==t;)i=Lt[t[1]-1],e=e.replace(a,"[url "+i+"]$2[/url]"),t=a.exec(e);return e}function c(e,i){var t,n,a,r,s,o,l,d,p,u,h,v,g,f,m,y,E,R,b,w,C,T,I,N,x,S=0,k=1,U=2,_=0,A="",P="<!-- START REPEAT ",M="<!-- START INCLUDEIF ",O="<!-- END INCLUDEIF ";for(t=e,i=i||{};;){if(s=t.length,o=t.indexOf("#",_),-1!==o&&(s=o,l=S),d=t.indexOf(P,_),-1!==d&&s>d&&(s=d,l=k),p=t.indexOf(M,_),-1!==p&&s>p&&(s=p,l=U),s===t.length)return A+t.substr(_);switch(u=s-_,A+=t.substr(_,u),_=s,l){case U:if(a=t.substr(_,44),r=wt.exec(a),null===r)break;if(h=r[1],v="!"!==h,g=r[2],f=O+h+g+" -->",m=f.length,y=t.indexOf(f),-1===y){_++;break}E=typeof i[g]!==Kt&&i[g]!==!1,E===v?(R="<!-- START INCLUDEIF "+h+g+" -->",b=R.length,t=t.substr(0,_)+t.substr(_+b,y-_-b)+t.substr(y+m)):t=t.substr(0,_)+t.substr(y+m);break;case S:if(a=t.substr(_,22),r=Ct.exec(a),null===r){A+="#",_++;continue}if(w=r[1],""!==i[w]&&!i[w]){A+="#"+w+"#",_+=w.length+2;continue}A+=i[w],_+=w.length+2;break;case k:if(a=t.substr(_,45),r=Tt.exec(a),null===r){A+="<",_++;continue}if(C=r[1],!(i[C]&&i[C]instanceof Array)){A+="<",_++;continue}if(_+=C.length+22,T=t.indexOf("<!-- END REPEAT "+C+" -->",_),-1===T){A+="<!-- START REPEAT "+C+" -->";continue}for(I=T-_,N=t.substr(_,I),x=i[C],n=0;n<x.length;n++)A+=c(N,x[n]);_+=C.length+I+20}}}function d(i){var t,n,a=e.trim(i.val()),r=0,s=0;if(li.hide(),""===a)return!0;if(_i=Nt.exec(a),null===_i){if(_i=xt.exec(a),null===_i)return li.show(),!1;r=0,s=_i[1]}else r=_i[1]?parseInt(_i[1],10):0,s=_i[2]?parseInt(_i[2],10):0;return 0===r&&0===s?i.val(""):(t=r>0?r+" hour":"",r>1&&(t+="s"),n=s>0?s+" min":"",s>1&&(n+="s"),i.val(e.trim(t+" "+n))),!0}function p(i){var t,n,a,r="";for(t=0;t<i.length;t++)n=i[t],3!==n.nodeType?1===n.nodeType&&n.childNodes.length>0&&(r+=p(n.childNodes)):(a=e.trim(n.nodeValue),""!==a&&(r+=a+"\n"));return r}function u(){var i;if(e(Yt,Vt).remove(),i=J.selection.getNode(),"#document"===i.nodeName&&(i=ki[0]),"BODY"===i.nodeName.toUpperCase())e(i).hasClass("mceContentBody")||(i=ki[0]),e(i).append("&nbsp;"+jt);else{for(;i.parentNode&&"BODY"!==i.parentNode.nodeName.toUpperCase();)i=i.parentNode;i.parentNode?"DIV"===i.nodeName.toUpperCase()||"SPAN"===i.nodeName.toUpperCase()?e(i,Vt).after(jt):e(i,Vt).before(jt):(i=ki[0],e(i).append("&nbsp;"+jt))}return lt=-1,e(Yt,Vt)}function h(){}function v(i){switch(i.type){case"js":e("head").append(e('<script type="text/javascript">'+i.js+"</script>")),Ti[i.f]();break;case"html":e(i.dest).html(i.html)}}function g(){zi.unbind(Zt),Fi.unbind(Zt),Si.dialog(Gt),bt=!0,mi()}function f(i,t){var a,r,s,o="";for(r=i.recipe,"success"!==t&&(Si.dialog(Gt),bt=!0,mi()),Z.val(n(r.recipe_title)),r.rating&&e.isNumeric(r.rating)&&G.val(r.rating),rn=r.recipe_image,ri.val(""),ai.val(r.author?n(r.author):""),si.val(r.cuisine||""),ri.val(r.mealType||""),oi.val(""),K.val(n(r.summary)),_i=_t.exec(r.prep_time),null!==_i?(a=_i[1]?_i[1]+"h ":"",ei.val(a+_i[2]+"m")):ei.val(n(r.prep_time)),_i=_t.exec(r.cook_time),null!==_i?(a=_i[1]?_i[1]+"h ":"",ii.val(a+_i[2]+"m")):ii.val(n(r.cook_time)),ti.val(n(r["yield"])),Qi.val(n(r.serving_size)),r.nutrition?(s=r.nutrition,Gi.val(n(s.calories)),Zi.val(n(s.totalFat)),Ki.val(n(s.saturatedFat)),qi.val(n(s.unsaturatedFat)),Xi.val(n(s.transFat)),et.val(n(s.totalCarbohydrates)),it.val(n(s.sugars)),tt.val(n(s.sodium)),nt.val(n(s.dietaryFiber)),at.val(n(s.protein)),rt.val(n(s.cholesterol))):(Gi.val(n(r.calories)),Zi.val(n(r.fat))),a=0;a<i.ingredients.length;a++)o+=Rt(n(i.ingredients[a]))+"\n";q.val(o),X.val(n(r.instructions.replace("\r",""))),st.val(n(r.notes)),Ni.dialog("option","title","Update Recipe"),Si.dialog(Gt),ji.hide(),Yi.show(),Di.hide(),""!==rn&&mt(rn,Oi.length,!0),pi=u(),Ni.parent(".ui-dialog").css($t,Ui),Ni.dialog(Bt,$t,Ui),Ni.dialog(qt)}function m(){var i;Hi.show(),zi.unbind(Zt),Fi.unbind(Zt),i={action:"easyrecipeConvert",id:gi,type:fi},e.post(ajaxurl,i,f,"json")}function y(i){var t,n,a,r,s,o,l,c,d,u,h,v,g,f=0,m="",y="",E="",R="",b=["instruction","method","cooking method","procedure","direction"],w=["ingredients?"],C=["note","cooking note"];for(h=e.parseJSON(Ti.ingredients),v=e.parseJSON(Ti.instructions),g=e.parseJSON(Ti.notes),-1===e.inArray(h,w)&&w.push(h),o="^\\s*(?:"+w.join("|")+")",d=new RegExp(o,"i"),-1===e.inArray(v,b)&&w.push(v),s="^\\s*(?:"+b.join("|")+")",c=new RegExp(s,"i"),-1===e.inArray(g,C)&&C.push(g),l="^\\s*(?:"+C.join("|")+")\\s*$",u=new RegExp(l,"i"),r=e("<div>"+i+"</div>"),t=p(r[0].childNodes),t=t.split("\n"),n=0;n<t.length;n++)if(a=e.trim(t[n]),""!==a)if(c.test(a))f=2;else if(d.test(a))f=1;else if(u.test(a))f=3;else switch(f){case 0:m+=a+"\n";break;case 1:y+=a+"\n";break;case 2:E+=a+"\n";break;case 3:R+=a+"\n"}return{summary:m,ingredients:y,instructions:E,notes:R}}function E(){xi.parent(".ui-dialog").css($t,Ui),xi.dialog(Bt,$t,Ui),xi.dialog(qt)}function R(i,t,n){var a,r=function(){var i,t,n,a,r=e.data(this,"index");i=this.width/150,t=this.height/112,i=i>t?i:t,n=Math.floor(this.height/i),a=Math.floor(this.width/i),Oi[r].height(n),Oi[r].width(a),Oi[r].css("top",(112-n)/2),Oi[r].attr("src",this.src),0===r&&e("#ERDTabs").find(".divERNoPhotos").remove()};Li.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+t+'" /></div>'),Oi[t]=e("#ERPhoto_"+t,Li),Oi[t].data("src",i),n&&(e(".ERPhoto",Li).removeClass(Xt),Oi[t].parent().addClass(Xt),pt=t,rn=i),""===gt&&(gt=i),a=new Image,e.data(a,"index",t),a.onload=r,a.src=i}function b(){R(dt.val(),Oi.length,!0),dt.val(""),ct.hide(),e(".divERNoPhotos").remove()}function w(e,i){var t,n=!1;for(t=0;t<Oi.length;t++)if(Oi[t].data("src")===e){n=!0;break}n||R(e,Oi.length,i)}function C(i,a){var r,s,l,c,d,p,f,b,C,T,I,N,x,S,k,U,_,A={},P="",M="",O="",L="";if(!i||1===i.which){if(a===nn&&0!==Jt)return void E();if(i&&i.data===an&&(a=an,i=i.delegateTarget),typeof a===Kt&&typeof i===Kt&&(lt=0),Jt=1,lt=0,pi=e(".easyrecipe:first",Vt),a!==nn&&pi.length>1&&(pi=e(pi[a]),lt=a),s=0,I=e.support.cors?"json":"jsonp",e.ajax(en,{dataType:I,data:{v:Ti.version,p:s,u:Ti.wpurl},success:v,error:h}),Q=!1,typeof tinyMCE!==Kt&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()&&(Q=!0),!Q)return void alert("You must use the Visual Editor to add or update an EasyRecipe");if(Z.val(""),ri.val(""),si.val(""),oi.val(""),ai.val(""),K.val(""),ei.val(""),ii.val(""),ti.val(""),q.val(""),X.val(""),Qi.val(""),Gi.val(""),Zi.val(""),Ki.val(""),qi.val(""),Xi.val(""),et.val(""),it.val(""),tt.val(""),nt.val(""),at.val(""),rt.val(""),st.val(""),a!==nn&&1===pi.length)Ni.dialog("option","title","Update Recipe"),Di.hide(),ji.hide(),Yi.show(),ui=!0;else{if(di=J.getContent(),!bt&&(C=St.exec(di)||kt.exec(di)||Ut.exec(di),C||(r=e("#hasRecipe").is(":checked")),C||r))return r?(fi="recipress",gi=Ti.postID):(fi=C[2],gi=C[3]),Hi.hide(),zi.click(g),Fi.click(m),p=Ot[fi],b=e("#txtERCNVText1",Si),b.html(b.html().replace("#plugin#",p)),Li.html(""),pt=-1,Oi=[],Li.html(tn),Si.parent(".ui-dialog").css($t,Ui),Si.dialog(Bt,$t,Ui),void Si.dialog(qt);Ti.isGuest&&(k=e("#inpERAuthor").val()||"",ai.val(k)),ji.show(),Yi.hide(),Di.show(),Ni.dialog("option","title","Add a New Recipe"),ui=!1,Ei!==!1?A=y(Ei):(S=J.selection.getContent(),S.length>20&&(A=y(S))),A.summary&&(P=A.summary),A.ingredients&&(M=A.ingredients),A.instructions&&(O=A.instructions),A.notes&&(L=A.notes),pi=u()}for(U=pi,pi=e("<div>"+pi.html()+"</div>"),e("#inpERCuisine").autocomplete({source:e.parseJSON(Ti.cuisines)}).autocomplete("widget").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),e("#inpERType").autocomplete({source:e.parseJSON(Ti.recipeTypes)}).autocomplete("widget").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),ln=!1,Et.off("change",t).on("change",t),ci=!1,e(".hrecipe",Vt).length>0&&confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")&&(ci=!0),vt=a!==nn?pi.find(".endeasyrecipe").text():Ti.version,""===vt&&(vt="2.2"),rn=e('link[itemprop="image"]',pi).attr("href")||"",Li.html(""),pt=-1,gt="",Oi=[],Vt.find("img").each(function(i){var t=!1;"3">vt?e(this).hasClass("photo")&&(t=!0):t=this.src===rn,R(this.src,i,t)}),d=Vt.contents().text(),C=At.exec(d),N=Oi.length;null!==C;)c=Mt.exec(C[0]),null!==c&&(l=c[1],R(l,N),vt>"3"?rn===l&&(Oi[N].parent().addClass(Xt),pt=N):Pt.test(C[0])&&(Oi[N].parent().addClass(Xt),pt=N,rn=l),N++),C=At.exec(d);""!==rn&&w(rn,!0),vi=e("#set-post-thumbnail").find("img").attr("src"),vi&&w(vi,-1===pt),-1===pt&&Oi.length>0&&(pt=0,rn=gt,Oi[0].parent().addClass(Xt)),Li.click(function(){xi.parent(".ui-dialog").css($t,Ui),xi.dialog(Bt,$t,Ui),xi.dialog(qt)}),0===Oi.length?Li.html(tn):-1===pt&&Oi[0].parent().addClass(Xt),Dt=[],Lt=[],x=pi.find(".ERName .fn").html()||pi.find(".ERName").html(),Z.val(x&&""!==x?o(n(x)):o(n(e("#title").val()))),ri.val(o(n(pi.find(".type").html()))),ai.val(o(n(pi.find(".author").html()))),""===ai.val()&&ai.val(o(e.parseJSON(Ti.author))),si.val(o(n(pi.find(".cuisine").html()))),K.val(o(P+n(pi.find(".summary").html()))),vt>"3"?(T=pi.find('time[itemprop="prepTime"]').html()||"",ei.val(n(T)),T=pi.find('time[itemprop="cookTime"]').html()||"",ii.val(n(T))):(T=pi.find(".preptime").html()||"",C=It.exec(T),ei.val(null!==C?n(C[1]):""),T=pi.find(".cooktime").html()||"",C=It.exec(T),ii.val(null!==C?n(C[1]):"")),ti.val(n(pi.find(".yield").html())),pi.find(".ingredients li").each(function(i,t){M+=e(t).hasClass(Wt)?"!"+o(n(t.innerHTML))+"\n":o(n(t.innerHTML))+"\n"}),q.val(M),pi.find(".instructions li, .instructions .ERSeparator").each(function(i,t){f=e.trim(t.innerHTML.replace(/^[ 0-9.]*(.*)$/gi,"$1")),O+=e(t).hasClass(Wt)?"!"+f+"\n":f+"\n"}),X.val(o(n(O))),Qi.val(n(pi.find(".servingSize").html())),Gi.val(n(pi.find(".calories").html())),Zi.val(n(pi.find(".fat").html())),Ki.val(n(pi.find(".saturatedFat").html())),qi.val(n(pi.find(".unsaturatedFat").html())),Xi.val(n(pi.find(".transFat").html())),et.val(n(pi.find(".carbohydrates").html())),it.val(n(pi.find(".sugar").html())),tt.val(n(pi.find(".sodium").html())),nt.val(n(pi.find(".fiber").html())),at.val(n(pi.find(".protein").html())),rt.val(n(pi.find(".cholesterol").html())),_=U.parent().prop("data-rating"),G.val(e.isNumeric(_)?_:"5"),f=(n(pi.find(".ERNotes").html())||"").replace(/<\/p>\n*<p>/gi,"\n\n").replace(/(?:<p>|<\/p>)/gi,"").replace(/<br *\/?>/gi,"\n"),""===f&&""!==L&&(f=L),f=o(f),f=f.replace(/\[br(?: ?\/)?\]/gi,"\n"),st.val(o(f)),yt&&(yt.name&&Z.val(o(n(yt.name))),yt.author&&ai.val(o(yt.author)),yt.summary&&K.val(o(yt.summary)),yt["yield"]&&ti.val(n(yt["yield"])),yt.type&&ri.val(o(n(yt.type))),yt.cuisine&&si.val(o(n(yt.cuisine))),yt.prepTime&&ei.val(n(yt.prepTime)),yt.cookTime&&ii.val(n(yt.cookTime)),yt.summary&&K.val(o(yt.summary))),pi=U,Ni.parent(".ui-dialog").css($t,Ui),Ni.dialog(Bt,$t,Ui),Ni.dialog(qt),Ni.dialog("option","position","center")}}function T(i){return Jt=e(".easyrecipe",Vt).length,Qt||0===Jt?void C(i,nn):(xi.parent(".ui-dialog").css($t,Ui),xi.dialog(Bt,$t,Ui),void xi.dialog(qt))}function I(){Ni.dialog(Gt)}function N(){var e=confirm("Are you sure you want to delete this recipe?");e&&(pi.remove(),pi=!1,ln=!1),Ni.dialog(Gt)}function x(){var i,t=e("#inpERPaste"),n=t.val();i=y(n),(0!==i.ingredients.length||0!==i.instructions.length)&&(Ei=n,t.val(""),yt={name:l(a(Z.val())),author:l(r(ai)),"yield":r(ti),type:l(r(ri)),cuisine:l(r(si)),summary:l(r(K)),servesize:r(Qi),prepTime:ei.val(),cookTime:ii.val()},ln=!1,Ni.dialog(Gt),T(null))}function S(i){var t=e(i.target).parent(),n=t.parent();t.hasClass("easyrecipeAbove")?n.before(sn):n.after(sn),t.remove(),k()}function k(){var i,t,n;t=e("<div>"+Vt[0].body.innerHTML+"</div>"),t.find(".easyrecipeAbove,.easyrecipeBelow").remove(),i=t.find(".easyrecipe"),i.each(function(){var i=e(this);i.parent().hasClass("easyrecipeWrapper")&&i.unwrap(),ft(i)}),n=t.html(),J.setContent(n),i=Vt.find(".easyrecipe"),i.on("mousedown",null,an,C),Vt.find(".ERInsertLine").on(Zt,S)}function U(e){var i,t,n,a,r;if(a=e.prev(),r=e.next(),t=0===a.length||a.hasClass("easyrecipe")||a.hasClass("easyrecipeWrapper"))try{t=!(e[0].previousSibling&&3===e[0].previousSibling.nodeType)}catch(s){}if(n=0===r.length||r.hasClass("easyrecipe")||r.hasClass("easyrecipeWrapper"))try{n=!(e[0].nextSibling&&3===e[0].nextSibling.nodeType)}catch(s){}(t||n)&&(e.wrap('<div class="easyrecipeWrapper mceNonEditable" />'),i=e.parent(),t&&(i.prepend('<div class="easyrecipeAbove mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line above" /></div>'),i.find("input").on(Zt,S),on.push(i.find(".easyrecipeAbove")[0])),n&&(i.append('<div class="easyrecipeBelow mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line below" /></div>'),i.find("input").on(Zt,S)))}function _(i){e(".easyrecipeAbove,.easyrecipeBelow",i).remove(),e(".easyrecipe",i).unwrap()}function A(){var i=e(".easyrecipe",Vt);0!==i.length&&(i.on("mousedown",null,an,C),k())}function P(){var i,t,n,s,o,p,u,h,v,g,f,m,y,E,R="",b="",w=0,C="",T=[];if(d(ei)&&d(ii)){for(t=e.trim(ei.val()),""!==t?(_i=Nt.exec(t),n=_i[1]?parseInt(_i[1],10):0,s=_i[2]?parseInt(_i[2],10):0,w=60*n+s,o=n>0?n+"H":"",p=s>0?s+"M":"",b="PT"+o+p):t=!1,i=e.trim(ii.val()),""!==i?(_i=Nt.exec(i),n=_i[1]?parseInt(_i[1],10):0,s=_i[2]?parseInt(_i[2],10):0,o=n>0?n+"H":"",p=s>0?s+"M":"",w+=60*n+s,R="PT"+o+p):i=!1,w>0?(n=Math.floor(w/60),s=w%60,o=n>0?n+" hour":"",n>1&&(o+="s"),p=s>0?s+" min":"",s>1&&(p+="s"),w=e.trim(o+" "+p),o=n>0?n+"H":"",p=s>0?s+"M":"",C="PT"+o+p):w=!1,u=q.val().split("\n"),v=0;v<u.length;v++)h=u[v],""!==h&&("!"===h.charAt(0)?(g=!0,h=h.substr(1)):g=!1,T.push({ingredient:l(a(h)),hasHeading:g}));for(u=X.val().split("\n"),m=[],f={INSTRUCTIONS:[]},v=0;v<u.length;v++)h=e.trim(u[v].replace(/^[ 0-9\.]*(.*)$/gi,"$1")),""!==h&&("!"===h.charAt(0)?((f.INSTRUCTIONS.length>0||f.heading)&&m.push(f),h=h.substr(1),f={},f.INSTRUCTIONS=[],f.heading=a(h)):f.INSTRUCTIONS.push({instruction:l(a(h))}));(f.INSTRUCTIONS.length>0||f.heading)&&m.push(f),h=r(st),h&&(h=h.replace(/\n/g,"[br]")),y={version:Ti.version,hasPhoto:""!==rn,photoURL:rn,name:l(a(Z.val())),author:l(r(ai)),preptime:t,cooktime:i,totaltime:w,preptimeISO:b,cooktimeISO:R,totaltimeISO:C,"yield":r(ti),type:l(r(ri)),cuisine:l(r(si)),summary:l(r(K)),servesize:r(Qi),calories:r(Gi),fat:r(Zi),satfat:r(Ki),unsatfat:r(qi),transfat:r(Xi),carbs:r(et),sugar:r(it),sodium:r(tt),fiber:r(nt),protein:r(at),cholesterol:r(rt),notes:l(h),rating:G.length?G.val():"0",INGREDIENTS:T,STEPS:m},""===y.name&&(y.name=!1),E=c(Ti.recipeTemplate,y),ci&&e(".hrecipe",Vt).remove(),-1===lt?pi=e(Yt,Vt):(pi=e(".easyrecipe",Vt),pi.length>0&&(pi=e(pi[lt]))),pi.before(E),pi.remove(),pi=!1,ot.show(),ln=!1,Ni.dialog(Gt),Jt=e(".easyrecipe",Vt).length,A()}}function M(i,t){var n,a;if(yt=!1,tinymce.majorVersion>"3"){if(t.id!==ni&&"wp_mce_fullscreen"!==t.id)return e("#"+t.controlManager.buttons.easyrecipeTest._id).hide(),e("#"+t.controlManager.buttons.easyrecipeEdit._id).hide(),void e("#"+t.controlManager.buttons.easyrecipeAdd._id).hide();t.id===ni?(Vt=e("#"+ni+"_ifr").contents(),Ui=1e4,n=e("#"+t.controlManager.buttons.easyrecipeTest._id),ot=e("#"+t.controlManager.buttons.easyrecipeEdit._id)):(Vt=e("#wp_mce_fullscreen_ifr").contents(),Ui=200001,n=e("#mce_fullscreen_easyrecipeTest"),ot=e("#mce_fullscreen_easyrecipeEdit"))}else{if(t.editorId!==ni&&"wp_mce_fullscreen"!==t.editorId)return e("#"+t.editorId+"_easyrecipeTest").hide(),e("#"+t.editorId+"_easyrecipeEdit").hide(),void e("#"+t.editorId+"_easyrecipeAdd").hide();t.editorId===ni?(Vt=e("#"+ni+"_ifr").contents(),Ui=1e4,n=e("#"+ni+"_easyrecipeTest"),ot=e("#"+ni+"_easyrecipeEdit")):(Vt=e("#wp_mce_fullscreen_ifr").contents(),Ui=200001,n=e("#mce_fullscreen_easyrecipeTest"),ot=e("#mce_fullscreen_easyrecipeEdit"))}ki=e("body",Vt),a=e(".easyrecipe",Vt),J=tinyMCE.activeEditor,a.each(function(){e(this).addClass("mceNonEditable"),e(".ERRatingOuter",this).remove(),e(".ERHDPrint",this).remove(),e(".ERLinkback",this).remove()}),Jt=a.length,Jt>0&&""!==Ti.testURL?n.show():n.hide(),Jt>0?ot.show():ot.hide(),Vt.hasERCSS||(e("head",Vt).append('<link rel="stylesheet" type="text/css" href="'+Ti.easyrecipeURL+'/css/easyrecipe-entry.css" />'),Vt.hasERCSS=!0),A()}function O(){Vi.toggleClass("ERNone"),Bi.toggleClass("ERContract")}function L(){$i.toggleClass("ERNone"),Ji.toggleClass("ERContract")}function D(i){var t,n,a,r;t=e("#ertmp_"+Ft,Vt),n=i.title?' title="'+i.title+'"':"",a=i.target?' target="'+i.target+'"':"",r='href="'+i.href+'"'+a+n,Lt.push(r),Ci.val(wi.substring(0,Ri)+"[url:"+Lt.length+"]"+wi.substring(Ri,bi)+"[/url]"+wi.substring(bi)),Ci[0].focus(),t.remove()}function H(i){var t,n,a,r,s,o;Ti.isEntryDialog&&(t=e("#ertmp_"+Ft,Vt),"string"==typeof i?a=e(i):(o=t.html(),"link"===o?(a=t.parent("a"),t=a):a=e(t.html())),a.is("a")&&(n=a.attr("href"),r=a.attr("title"),s=a.attr("target"),r=r?' title="'+r+'"':"",s=s?' target="'+s+'"':"",i='href="'+n+'"'+s+r,Lt.push(i),Ci.val(wi.substring(0,Ri)+"[url:"+Lt.length+"]"+wi.substring(Ri,bi)+"[/url]"+wi.substring(bi))),Ci[0].focus(),t.remove())}function z(e,i){var t,n,a,r,s,o;n=e.sizes[i.size],a=n.url,s=n.width,o=n.height,R(a,Oi.length),t=wi.substring(0,Ri),Dt.push('src="'+a+'" width="'+s+'" height="'+o+'"class="align'+i.align+'"'),"none"===i.link?t+="[img:"+Dt.length+"]":("file"===i.link?r=a:"post"===i.link?r=e.link:"custom"===i.link&&(r=i.linkUrl),Lt.push('href="'+r+'"'),t+="[url:"+Lt.length+"][img:"+Dt.length+"][/url]"),t+=wi.substring(bi),Ci.val(t),Ci[0].focus()}function F(){E()}function j(){yt=!1,T()}function Y(){yt=!1,C()}function W(){Jt>0&&!Ti.noHTMLWarn&&(Ti.noHTMLWarn=!0,Ii.parent(".ui-dialog").css($t,Ui),Ii.dialog(Bt,$t,Ui),Ii.dialog(qt))}function V(i){var t,n,a,r,s=e("#wp-preview",i.target).val();return"dopreview"===s?!0:0===Jt?!0:(a=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden(),a?n=e("<div>"+J.getContent()+"</div>"):(r=e("#wp-content-editor-container").find("textarea"),n=e("<div>"+r.val()+"</div>")),_(e(".easyrecipeWrapper",n)),e(".easyrecipe",n).removeClass("mceNonEditable"),t=e.trim(n.html()),a?J.setContent(t):r.val(t),!0)}function B(i){var t;""!=i.target.innerHTML&&(t=e(i.target).find("img").attr("src"),t&&w(t,!1))}function $(i){var t,n,a,r;for(t=i[0],n=0;n<t.addedNodes.length;n++)if(a=e(t.addedNodes[n].innerHTML),r=a.find("img").attr("src")){w(r,!1);break}}var J,Q,G,Z,K,q,X,ei,ii,ti,ni,ai,ri,si,oi,li,ci,di,pi,ui,hi,vi,gi,fi,mi,yi,Ei,Ri,bi,wi,Ci,Ti,Ii,Ni,xi,Si,ki,Ui,_i,Ai,Pi,Mi,Oi,Li,Di,Hi,zi,Fi,ji,Yi,Wi,Vi,Bi,$i,Ji,Qi,Gi,Zi,Ki,qi,Xi,et,it,tt,nt,at,rt,st,ot,lt,ct,dt,pt,ut,ht,vt,gt,ft,mt,yt,Et,Rt=jQuery.trim,bt=!1,wt=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i,Ct=/^#([_a-z][_0-9a-z]{0,19})#/im,Tt=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m,It=/^([^<]*)/,Nt=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,xt=/^([0-9]+)$/,St=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/,kt=/(.*)\[(yumprint)-recipe\s+id='(\d+)'\](.*)/i,Ut=/(.*)\[(gmc)_recipe\s+([0-9]+)\](.*)/,_t=/PT(?:([0-9]*)+H)?([0-9]+)+M/i,At=/\[(?:img) +(?:[^\]]+?)\]/gi,Pt=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i,Mt=/src\s*=\s*" *([^"]+?) *"/i,Ot={recipeseo:"Recipe SEO",ziplist:"ZipList",zlrecipe:"ZipList",yumprint:"Yumprint Recipe Card",recipress:"ReciPress",gmc:"GetMeCooking"},Lt=[],Dt=[],Ht="Switch to the Visual Editor to add or edit an EasyRecipe",zt=null,Ft=0,jt='<div class="easyrecipeholder">EasyRecipe</div>',Yt=".easyrecipeholder",Wt="ERSeparator",Vt=null,Bt="option",$t="zIndex",Jt=0,Qt=!0,Gt="close",Zt="click",Kt="undefined",qt="open",Xt="ERPhotoSelected",en="http://www.easyrecipeplugin.com/checkUpdates.php",tn='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>',nn=-1,an=-2,rn="",sn="&nbsp;",on=[],ln=!1;e(function(){var t,n,a,r=null;Ti=EASYRECIPE,Ti.button!==e.fn.button&&(r=e.fn.button,e.fn.button=Ti.button),Ni=e("#easyrecipeEntry"),xi=e("#easyrecipeUpgrade"),Ii=e("#easyrecipeHTMLWarn"),ni=Ti.isGuest?"guestpost":"content",Ni.dialog({autoOpen:!1,width:655,modal:!0,dialogClass:"easyrecipeEntry",beforeClose:function(){if(ln){if(!window.confirm("Are you sure you want to close without saving the recipe?"))return!1;ln=!1}return!0},close:function(){Ti.isEntryDialog=!1,pi&&!ui&&pi.remove(),pi=!1,e(".easyrecipeEntry").filter(function(){return""===e(this).text()}).remove()},open:function(){Ti.isEntryDialog=!0,e(".ui-widget-overlay").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),Ai.tabs({active:0,beforeActivate:i}),setTimeout(function(){var i=e(".easyrecipeEntry"),t=i.offset();t.top<ut&&(t.top=ut,i.offset(t))},250)}}),Ni.parent(".ui-dialog").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),Et=e("#divERContainer").show(),Ii.dialog({autoOpen:!1,width:420,modal:!0,dialogClass:"easyrecipeHTMLWarn",close:function(){e(".easyrecipeHTMLWarn").filter(function(){return""===e(this).text()}).remove()},open:function(){e(".ui-widget-overlay").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />')}}),Ii.parent(".ui-dialog").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),e(".divERHTMLWarnContainer").show(),xi.dialog({autoOpen:!1,width:420,modal:!0,dialogClass:"easyrecipeUpgrade",close:function(){e(".easyrecipeUpgrade").filter(function(){return""===e(this).text()}).remove()},open:function(){e(".ui-widget-overlay").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />')}}),xi.parent(".ui-dialog").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),e(".divERUPGContainer").show(),Si=e("#easyrecipeConvert"),Hi=e("#divERCNVSpinner"),zi=e("#btnERCNVCancel"),Fi=e("#btnERCNVOK"),Hi.hide(),Si.dialog({autoOpen:!1,width:390,modal:!0,dialogClass:"easyrecipeConvert",close:function(){e(".easyrecipeConvert").filter(function(){return""===e(this).text()}).remove()},open:function(){e(".ui-widget-overlay").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />')}}),e("#divERCNVContainer").show(),Si.parent(".ui-dialog").wrap('<div id="easyrecipeUI" class="easyrecipeUI" />'),e(window).bind("easyrecipeadd",j),e(window).bind("easyrecipeedit",Y),e(window).bind("easyrecipeload",M),e(window).bind("easyrecipeimage",z),e(window).bind("easyrecipeguestimageuploaded",z),Mi=e("#divERNext"),Pi=e("#btnERButtons"),Ai=e("#ERDTabs"),Li=e("#divERPhotos"),e("input:submit",".easyrecipeUI").button(),hi=e("#ed_toolbar"),G=e("#inpERRating"),Z=e("#inpERName"),ai=e("#inpERAuthor"),ri=e("#inpERType"),si=e("#inpERCuisine"),oi=e("#inpERTags"),K=e("textarea#taERSummary"),q=e("textarea#taERIngredients"),X=e("textarea#taERInstructions"),ei=e("#inpERPrepTime"),ii=e("#inpERCookTime"),ti=e("#inpERYield"),Qi=e("#inpERServeSize"),Gi=e("#inpERCalories"),Zi=e("#inpERFat"),Ki=e("#inpERSatFat"),qi=e("#inpERUnsatFat"),Xi=e("#inpERTransFat"),et=e("#inpERCarbs"),it=e("#inpERSugar"),tt=e("#inpERSodium"),nt=e("#inpERFiber"),at=e("#inpERProtein"),rt=e("#inpERCholesterol"),st=e("textarea#taERNotes"),ct=e("#divERAddImageURL"),a=e("#lnkERPhotoURL"),li=e(".ERTimeError"),ji=e("#divERAdd"),Yi=e("#divERChange"),Wi=e("#divERHeader"),Vi=e("#divEROther"),Bi=e("#divEROtherLabel"),$i=e("#divERNotes"),Ji=e("#divERNotesLabel"),Di=e("#ERDPasteTab"),dt=e("#fldERAPUImageURL"),e("#btnERAdd").click(P),e("#btnERNext").click(s),e("#btnERChange").click(P),e("#btnERDelete").click(N),e("#btnERCancel").click(I),a.click(function(){xi.parent(".ui-dialog").css($t,Ui),xi.dialog(Bt,$t,Ui),xi.dialog(qt)}),e("#btnERAIUCancel").click(function(){ct.hide()}),e("#btnERAIUOK").click(b),Bi.click(O),Ji.click(L),ei.change(function(i){d(e(i.target))}),ii.change(function(i){d(e(i.target))}),e("#btnERPaste").click(x),ut=e("#wpadminbar").height(),ht=e("#divEREditBtns").on("mousedown","li",F),Et.find('input[type="text"], textarea').on("blur",function(){zt=null}).on("focus",function(){zt=e(this)}),e("#wp-link").bind("wpdialogclose",H),Ti.insertLink=D,mi=T,yi=C,Ei=!1,Ti.insertUploadedImage=z,ft=U,mt=R,Ti.addListener=A,Ii.find("input").on(Zt,function(){Ii.dialog(Gt)}),e("#wp-content-editor-tools").on(Zt,"#content-html",W),e("#post").on("submit",V),null!==r&&(e.fn.button=r),t=e("#postimagediv").find(".inside"),window.MutationObserver&&t.length>0?(n=new MutationObserver($),n.observe(t[0],{childList:!0})):t.on("DOMSubtreeModified",B),window.QTags&&QTags.addButton("easyrecipe","EasyRecipe",function(){alert(Ht)},"","","",900)})}(jQuery);