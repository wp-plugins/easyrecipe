if(typeof EASYRECIPE==="undefined"){var EASYRECIPE={}}if(!EASYRECIPE.widget){EASYRECIPE.widget=jQuery.widget}if(!EASYRECIPE.button){EASYRECIPE.button=jQuery.fn.button}(function(bH){var G=jQuery.trim;var Q,R,bw,bO,bt,k,av,aU,bk,aq;var w,ba,bq,aR,bv,M=false,P,bA,bS,N,f;var bI=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i;var o=/^#([_a-z][_0-9a-z]{0,19})#/im;var b=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m;var bc=/^([^<]*)/,s=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,az=/^([0-9]+)$/;var bR=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/;var aD=/(.*)\[(yumprint)-recipe id='(\d+)'\](.*)/i;var a8,a2,bu,bQ,U;var ar=/PT(?:([0-9]*)+H)?([0-9]+)+M/i;var aj=/\[(?:img) +(?:[^\]]+?)\]/ig;var O=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i;var bg=/src\s*=\s*" *([^"]+?) *"/i;var bT={recipeseo:"Recipe SEO",ziplist:"ZipList",yumprint:"Yumprint Recipe Card"};var bi=[];var bn=[];var bd,aI,aO,ag=null,r=0,n,v,bl;var aK='<div class="easyrecipeholder">EasyRecipe</div>',i=".easyrecipeholder",aJ="ERSeparator";var a9,L,E,t,aH=null,bm,ab,bL,aV="option",aA="zIndex",d,V,a6,bN,aE;var ap,y,bC,bs,bM,by,K,bb,be,bo,bx;var bh,m,aB,bz,aG,a4,am,bE,e,B,aW,c,u,bB;var aX=0,bP=false,aZ,I=true,C,ax,bF,W,a1;var l="close",ao="click",aL="undefined",H="open",aQ="ERPhotoSelected",ae="http://www.easyrecipeplugin.com/checkUpdates.php";var au='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>';var bf,aC=-1,ay=-2,D="",bj,ah="&nbsp;",a7,aa,F;function ak(bV,bW){V.show();a1.hide();a6.show();switch(bW.index){case 0:a1.css("right","10px");a1.show();break;case 3:a1.css("right","inherit");a6.hide();a1.show();break;case 4:V.hide();break}}function bD(bV){if(!bV){return""}bV+="";return bV.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")}function x(bV){return bV?bH("<div />").text(bV).html():""}function aw(bV){return bH.trim(x(bV.val()))||false}function a(bW,bX){var bV=d.tabs("option","selected");d.tabs("option","selected",++bV)}function af(bW){var bY,bV=/\[img +(.*?) *\/?\]/i,bX=/\[url ([^\]]+)\](.*?\[\/url\])/i;bY=bV.exec(bW);while(bY!==null){bn.push(bY[1]);bW=bW.replace(bV,"[img:"+bn.length+"]");bY=bV.exec(bW)}bY=bX.exec(bW);while(bY!==null){bi.push(bY[1]);bW=bW.replace(bX,"[url:"+bi.length+"]$2");bY=bX.exec(bW)}return bW}function g(bW){var bZ,bY,bV=/\[img:(\d+)\]/i,bX=/\[url:(\d+)\](.*?)\[\/url\]/i;bY=bV.exec(bW);while(bY!==null){bZ=bn[bY[1]-1];bW=bW.replace(bV,"[img "+bZ+"]");bY=bV.exec(bW)}bY=bX.exec(bW);while(bY!==null){bZ=bi[bY[1]-1];bW=bW.replace(bX,"[url "+bZ+"]$2[/url]");bY=bX.exec(bW)}return bW}function aT(cp,cb){var ch=0,cc=1,bV=2,cr;var ci,b9,b2,b8=0,b7="",ck,bW,bZ,cj,cm;var cl="<!-- START REPEAT ",ct="<!-- START INCLUDEIF ",cs="<!-- END INCLUDEIF ";var bY,bX,b4,co,cf,b3,ca,cg,cq,b6;var b0,ce,cn;var b5,cd,b1;cr=cp;cb=cb||{};while(true){ck=cr.length;bW=cr.indexOf("#",b8);if(bW!==-1){ck=bW;bZ=ch}cj=cr.indexOf(cl,b8);if(cj!==-1&&cj<ck){ck=cj;bZ=cc}cm=cr.indexOf(ct,b8);if(cm!==-1&&cm<ck){ck=cm;bZ=bV}if(ck===cr.length){return b7+cr.substr(b8)}bY=ck-b8;b7+=cr.substr(b8,bY);b8=ck;switch(bZ){case bV:b9=cr.substr(b8,44);b2=bI.exec(b9);if(b2!==null){bX=b2[1];b4=bX!=="!";co=b2[2]}else{break}cf=cs+bX+co+" -->";b3=cf.length;ca=cr.indexOf(cf);if(ca===-1){b8++;break}cg=typeof cb[co]!==aL&&cb[co]!==false;if(cg===b4){cq="<!-- START INCLUDEIF "+bX+co+" -->";b6=cq.length;cr=cr.substr(0,b8)+cr.substr(b8+b6,ca-b8-b6)+cr.substr(ca+b3)}else{cr=cr.substr(0,b8)+cr.substr(ca+b3)}break;case ch:b9=cr.substr(b8,22);b2=o.exec(b9);if(b2===null){b7+="#";b8++;continue}b0=b2[1];if(cb[b0]!==""&&!cb[b0]){b7+="#"+b0+"#";b8+=b0.length+2;continue}b7+=cb[b0];b8+=b0.length+2;break;case cc:b9=cr.substr(b8,45);b2=b.exec(b9);if(b2===null){b7+="<";b8++;continue}ce=b2[1];if(!cb[ce]||!(cb[ce] instanceof Array)){b7+="<";b8++;continue}b8+=ce.length+22;cn=cr.indexOf("<!-- END REPEAT "+ce+" -->",b8);if(cn===-1){b7+="<!-- START REPEAT "+ce+" -->";continue}b5=cn-b8;cd=cr.substr(b8,b5);b1=cb[ce];for(ci=0;ci<b1.length;ci++){b7+=aT(cd,b1[ci])}b8+=ce.length+b5+20;break}}}function S(bZ){var bV=bH.trim(bZ.val()),bW=0,bY=0,bX,b0;bv.hide();if(bV===""){return true}bL=s.exec(bV);if(bL===null){bL=az.exec(bV);if(bL===null){bv.show();return false}bW=0;bY=bL[1]}else{bW=bL[1]?parseInt(bL[1],10):0;bY=bL[2]?parseInt(bL[2],10):0}if(bW===0&&bY===0){bZ.val("")}else{bX=bW>0?bW+" hour":"";if(bW>1){bX+="s"}b0=bY>0?bY+" min":"";if(bY>1){b0+="s"}bZ.val(bH.trim(bX+" "+b0))}return true}function p(bZ){var bW,bV,bX,bY="";for(bW=0;bW<bZ.length;bW++){bV=bZ[bW];if(bV.nodeType===3){bX=bH.trim(bV.nodeValue);if(bX!==""){bY+=bX+"\n"}continue}if(bV.nodeType!==1){continue}if(bV.childNodes.length>0){bY+=p(bV.childNodes)}}return bY}function bJ(){var bV;bH(i,aH).remove();bV=Q.selection.getNode();if(bV.nodeName==="#document"){bV=bm[0]}if(bV.nodeName.toUpperCase()==="BODY"){if(!bH(bV).hasClass("mceContentBody")){bV=bm[0]}bH(bV).append("&nbsp;"+aK)}else{while(bV.parentNode&&bV.parentNode.nodeName.toUpperCase()!=="BODY"){bV=bV.parentNode}if(!bV.parentNode){bV=bm[0];bH(bV).append("&nbsp;"+aK)}else{if(bV.nodeName.toUpperCase()==="DIV"||bV.nodeName.toUpperCase()==="SPAN"){bH(bV,aH).after(aK)}else{bH(bV,aH).before(aK)}}}aZ=-1;return bH(i,aH)}function X(bV,bX,bW){}function Y(bV){switch(bV.type){case"js":bH("head").append(bH('<script type="text/javascript">'+bV.js+"<\/script>"));v[bV.f]();break;case"html":bH(bV.dest).html(bV.html);break}}function bU(){bC.unbind(ao);bs.unbind(ao);t.dialog(l);M=true;bu()}function J(b0,bW){var bZ,bV="";var bY,bX;bY=b0.recipe;if(bW!=="success"){t.dialog(l);M=true;bu()}bw.val(bD(bY.recipe_title));D=bY.recipe_image;ba.val("");if(bY.author){w.val(bD(bY.author))}else{w.val("")}bq.val("");aR.val("");bO.val(bD(bY.summary));bL=ar.exec(bY.prep_time);if(bL!==null){bZ=bL[1]?bL[1]+"h ":"";av.val(bZ+bL[2]+"m")}else{av.val(bD(bY.prep_time))}bL=ar.exec(bY.cook_time);if(bL!==null){bZ=bL[1]?bL[1]+"h ":"";aU.val(bZ+bL[2]+"m")}else{aU.val(bD(bY.cook_time))}bk.val(bD(bY.yield));bh.val(bD(bY.serving_size));if(bY.nutrition){bX=bY.nutrition;m.val(bD(bX.calories));aB.val(bD(bX.totalFat));bz.val(bD(bX.saturatedFat));aG.val(bD(bX.unsaturatedFat));a4.val(bD(bX.transFat));am.val(bD(bX.totalCarbohydrates));bE.val(bD(bX.sugars));e.val(bD(bX.sodium));B.val(bD(bX.dietaryFiber));aW.val(bD(bX.protein));c.val(bD(bX.cholesterol))}else{m.val(bD(bY.calories));aB.val(bD(bY.fat))}for(bZ=0;bZ<b0.ingredients.length;bZ++){bV+=G(bD(b0.ingredients[bZ]))+"\n"}bt.val(bV);k.val(bD(bY.instructions.replace("\r","")));u.val(bD(bY.notes));a9.dialog("option","title","Update Recipe");t.dialog(l);bM.hide();by.show();ap.hide();if(D!==""){aa(D,bN.length,true)}bS=bJ();a9.dialog(aV,aA,ab);a9.dialog(H)}function aY(){var bV;y.show();bC.unbind(ao);bs.unbind(ao);bV={action:"easyrecipeConvert",id:a8,type:a2};bH.post(ajaxurl,bV,J,"json")}function z(b5){var b4,ce,b6,b0=0,ca,bZ="",bV="",bW="",b2="";var b3=["instruction","method","cooking method","procedure"];var cf=["ingredients?"];var bX=["note","cooking note"];var cg;var cb;var bY;var cc,b7,b9;var cd,b1,b8;cd=bH.parseJSON(v.ingredients);b1=bH.parseJSON(v.instructions);b8=bH.parseJSON(v.notes);if(bH.inArray(cd,cf)===-1){cf.push(cd)}cb="^\\s*(?:"+cf.join("|")+")";b7=new RegExp(cb,"i");if(bH.inArray(b1,b3)===-1){cf.push(b1)}cg="^\\s*(?:"+b3.join("|")+")";cc=new RegExp(cg,"i");if(bH.inArray(b8,bX)===-1){bX.push(b8)}bY="^\\s*(?:"+bX.join("|")+")\\s*$";b9=new RegExp(bY,"i");ca=bH("<div>"+b5+"</div>");b4=p(ca[0].childNodes);b4=b4.split("\n");for(ce=0;ce<b4.length;ce++){b6=bH.trim(b4[ce]);if(b6===""){continue}if(cc.test(b6)){b0=2;continue}if(b7.test(b6)){b0=1;continue}if(b9.test(b6)){b0=3;continue}switch(b0){case 0:bZ+=b6+"\n";break;case 1:bV+=b6+"\n";break;case 2:bW+=b6+"\n";break;case 3:b2+=b6+"\n";break}}return{summary:bZ,ingredients:bV,instructions:bW,notes:b2}}function at(){L.dialog(aV,aA,ab);L.dialog(H)}function Z(bY,bV,bW){var bX;var bZ=function(){var b0,b4,b3,b1,b2=bH.data(this,"index");b0=this.width/150;b4=this.height/112;b0=b0>b4?b0:b4;b3=Math.floor(this.height/b0);b1=Math.floor(this.width/b0);bN[b2].height(b3);bN[b2].width(b1);bN[b2].css("top",(112-b3)/2);bN[b2].attr("src",this.src);if(b2===0){bH("#ERDTabs").find(".divERNoPhotos").remove()}};aE.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+bV+'" /></div>');bN[bV]=bH("#ERPhoto_"+bV,aE);bN[bV].data("src",bY);if(bW){bH(".ERPhoto",aE).removeClass(aQ);bN[bV].parent().addClass(aQ);bF=bV;D=bY}if(bj===""){bj=bY}bX=new Image();bH.data(bX,"index",bV);bX.onload=bZ;bX.src=bY}function ad(){Z(ax.val(),bN.length,true);ax.val("");C.hide();bH(".divERNoPhotos").remove()}function ac(ca,cd){var cf;var b3,b0;var cb;var bZ;var ce,bV,b9,b8,b4,b2,b5,b6,cg;var bY={},b1="",bX="",bW="",b7="",cc;if(cd===aC&&aX!==0){at();return}if(ca&&ca.data===ay){cd=ay;ca=ca.delegateTarget}if(typeof cd===aL&&typeof ca===aL){aZ=0}aX=1;aZ=0;bS=bH(".easyrecipe:first",aH);if(cd!==aC&&bS.length>1){bS=bH(bS[cd]);aZ=cd}cf=0;b5=bH.support.cors?"json":"jsonp";bH.ajax(ae,{dataType:b5,data:{v:v.version,p:cf,u:v.wpurl},success:Y,error:X});R=false;if(typeof tinyMCE!==aL){if(tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()){R=true}}if(!R){alert("You must use the Visual Editor to add or update an EasyRecipe");return}bw.val("");ba.val("");bq.val("");aR.val("");w.val("");bO.val("");av.val("");aU.val("");bk.val("");bt.val("");k.val("");bh.val("");m.val("");aB.val("");bz.val("");aG.val("");a4.val("");am.val("");bE.val("");e.val("");B.val("");aW.val("");c.val("");u.val("");if(cd!==aC&&bS.length===1){a9.dialog("option","title","Update Recipe");ap.hide();bM.hide();by.show();N=true}else{bA=Q.getContent();if(!M){b4=bR.exec(bA)||aD.exec(bA);if(b4){a2=b4[2];a8=b4[3];y.hide();bC.click(bU);bs.click(aY);bZ=bT[a2];b8=bH("#txtERCNVText1",t);b8.html(b8.html().replace("#plugin#",bZ));aE.html("");bF=-1;bN=[];aE.html(au);t.dialog(aV,aA,ab);t.dialog(H);return}}if(v.isGuest){w.val(bH("#inpERAuthor").val())}bM.show();by.hide();ap.show();a9.dialog("option","title","Add a New Recipe");N=false;if(U!==false){bY=z(U)}else{cc=Q.selection.getContent();if(cc.length>20){bY=z(cc)}}if(bY.summary){b1=bY.summary}if(bY.ingredients){bX=bY.ingredients}if(bY.instructions){bW=bY.instructions}if(bY.notes){b7=bY.notes}bS=bJ()}bH("#inpERCuisine").autocomplete({source:bH.parseJSON(v.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');bH("#inpERType").autocomplete({source:bH.parseJSON(v.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');P=false;if(bH(".hrecipe",aH).length>0){if(confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")){P=true}}bf=(cd!==aC)?bS.find(".endeasyrecipe").text():v.version;if(bf===""){bf="2.2"}D=bH('link[itemprop="image"]',bS).attr("href")||"";aE.html("");bF=-1;bj="";bN=[];aH.find("img").each(function(ch){var ci=false;if(bf<"3"){if(bH(this).hasClass("photo")){ci=true}}else{ci=this.src===D}Z(this.src,ch,ci)});cb=aH.contents().text();b4=aj.exec(cb);b6=bN.length;while(b4!==null){b0=bg.exec(b4[0]);if(b0!==null){b3=b0[1];Z(b3,b6);if(bf>"3"){if(D===b3){bN[b6].parent().addClass(aQ);bF=b6}}else{if(O.test(b4[0])){bN[b6].parent().addClass(aQ);bF=b6;D=b3}}b6++}b4=aj.exec(cb)}if(D!==""){bV=false;for(ce=0;ce<bN.length;ce++){if(bN[ce].data("src")===D){bV=true;break}}if(!bV){Z(D,bN.length,true)}}if(bF===-1&&bN.length>0){bF=0;D=bj;bN[0].parent().addClass(aQ)}aE.click(function(){L.dialog(aV,aA,ab);L.dialog(H)});if(bN.length===0){aE.html(au)}else{if(bF===-1){bN[0].parent().addClass(aQ)}}bn=[];bi=[];cg=bS.find(".ERName .fn").html()||bS.find(".ERName").html();if(!cg||cg===""){bw.val(af(bD(bH("#title").val())))}else{bw.val(af((bD(cg))))}ba.val(af(bD(bS.find(".type").html())));w.val(af(bD(bS.find(".author").html())));if(w.val()===""){w.val(af(bH.parseJSON(v.author)))}bq.val(af(bD(bS.find(".cuisine").html())));bO.val(af(b1+bD(bS.find(".summary").html())));if(bf>"3"){b2=bS.find('time[itemprop="prepTime"]').html()||"";av.val(bD(b2));b2=bS.find('time[itemprop="cookTime"]').html()||"";aU.val(bD(b2))}else{b2=bS.find(".preptime").html()||"";b4=bc.exec(b2);if(b4!==null){av.val(bD(b4[1]))}else{av.val("")}b2=bS.find(".cooktime").html()||"";b4=bc.exec(b2);if(b4!==null){aU.val(bD(b4[1]))}else{aU.val("")}}bk.val(bD(bS.find(".yield").html()));bS.find(".ingredients li").each(function(ci,ch){if(bH(ch).hasClass(aJ)){bX+="!"+af(bD(ch.innerHTML))+"\n"}else{bX+=af(bD(ch.innerHTML))+"\n"}});bt.val(bX);bS.find(".instructions li, .instructions .ERSeparator").each(function(ci,ch){b9=bH.trim(ch.innerHTML.replace(/^[ 0-9.]*(.*)$/ig,"$1"));if(bH(ch).hasClass(aJ)){bW+="!"+b9+"\n"}else{bW+=b9+"\n"}});k.val(af(bD(bW)));bh.val(bD(bS.find(".servingSize").html()));m.val(bD(bS.find(".calories").html()));aB.val(bD(bS.find(".fat").html()));bz.val(bD(bS.find(".saturatedFat").html()));aG.val(bD(bS.find(".unsaturatedFat").html()));a4.val(bD(bS.find(".transFat").html()));am.val(bD(bS.find(".carbohydrates").html()));bE.val(bD(bS.find(".sugar").html()));e.val(bD(bS.find(".sodium").html()));B.val(bD(bS.find(".fiber").html()));aW.val(bD(bS.find(".protein").html()));c.val(bD(bS.find(".cholesterol").html()));b9=(bD(bS.find(".ERNotes").html())||"").replace(/<\/p>\n*<p>/ig,"\n\n").replace(/(?:<p>|<\/p>)/ig,"").replace(/<br *\/?>/ig,"\n");if(b9===""&&b7!==""){b9=b7}u.val(af(b9));if(F){if(F.name){bw.val(af((bD(F.name))))}if(F.author){w.val(af(F.author))}if(F.summary){bO.val(af(F.summary))}if(F.yield){bk.val(bD(F.yield))}if(F.type){ba.val(af(bD(F.type)))}if(F.cuisine){bq.val(af(bD(F.cuisine)))}if(F.prepTime){av.val(bD(F.prepTime))}if(F.cookTime){aU.val(bD(F.cookTime))}if(F.summary){bO.val(af(F.summary))}}a9.dialog(aV,aA,ab);a9.dialog(H);a9.dialog("option","position","center")}function A(bV){aX=bH(".easyrecipe",aH).length;if(I||aX===0){ac(bV,aC);return}L.dialog(aV,aA,ab);L.dialog(H)}function a3(){a9.dialog(l)}function q(){var bV=confirm("Are you sure you want to delete this recipe?");if(bV){bS.remove();bS=false}a9.dialog(l)}function ai(){var bW=bH("#inpERPaste");var bV,bX=bW.val();bV=z(bX);if(bV.ingredients.length===0&&bV.instructions.length===0){return}U=bX;bW.val("");F={name:g(x(bw.val())),author:g((aw(w))),yield:aw(bk),type:g((aw(ba))),cuisine:g((aw(bq))),summary:g(aw(bO)),servesize:aw(bh),prepTime:av.val(),cookTime:aU.val()};a9.dialog(l);A(null)}function bG(bW){var bV=bH(bW.target).parent();var bX=bV.parent();if(bV.hasClass("easyrecipeAbove")){bX.before(ah)}else{bX.after(ah)}bH(".easyrecipeAbove,.easyrecipeBelow",bX).remove();a7(bH(".easyrecipe",bX).unwrap())}function bK(bZ){var bW,bV,bY,bX;bY=bZ.prev();bX=bZ.next();bW=(bY.length===0||bY.hasClass("easyrecipe")||bY.hasClass("easyrecipeWrapper"));if(bW){bW=!(bZ[0].previousSibling&&bZ[0].previousSibling.nodeType===3)}bV=(bX.length===0||bX.hasClass("easyrecipe")||bX.hasClass("easyrecipeWrapper"));if(bV){bV=!(bZ[0].nextSibling&&bZ[0].nextSibling.nodeType===3)}if(!bW&&!bV){return}bZ.wrap('<div class="easyrecipeWrapper" />');if(bW){bZ.parent().prepend('<div class="easyrecipeAbove"><input class="ERInsertLine" type="button" value="Insert line above" /></div>')}if(bV){bZ.parent().append('<div class="easyrecipeBelow"><input class="ERInsertLine" type="button" value="Insert line below" /></div>')}bH(".easyrecipeWrapper .ERInsertLine",aH).on(ao,bG)}function h(bV){bH(".easyrecipeAbove,.easyrecipeBelow",bV).remove();bH(".easyrecipe",bV).unwrap()}function br(){var bV=bH(".easyrecipe",aH);if(bV.length===0){return}bV.on("mousedown",null,ay,ac);h(bH(".easyrecipeWrapper",aH));bV.each(function(){bK(bH(this))})}function aS(){var b7,b1="",bY,b6="",bV=0,cb="";var cd,b9,b5,bZ,cc,b2,b8,bW=[],b0;var bX,ca,b4,b3;if(!S(av)){return}if(!S(aU)){return}bY=bH.trim(av.val());if(bY!==""){bL=s.exec(bY);cd=bL[1]?parseInt(bL[1],10):0;b9=bL[2]?parseInt(bL[2],10):0;bV=cd*60+b9;b5=cd>0?cd+"H":"";bZ=b9>0?b9+"M":"";b6="PT"+b5+bZ}else{bY=false}b7=bH.trim(aU.val());if(b7!==""){bL=s.exec(b7);cd=bL[1]?parseInt(bL[1],10):0;b9=bL[2]?parseInt(bL[2],10):0;b5=cd>0?cd+"H":"";bZ=b9>0?b9+"M":"";bV+=cd*60+b9;b1="PT"+b5+bZ}else{b7=false}if(bV>0){cd=Math.floor(bV/60);b9=bV%60;b5=cd>0?cd+" hour":"";if(cd>1){b5+="s"}bZ=b9>0?b9+" min":"";if(b9>1){bZ+="s"}bV=bH.trim(b5+" "+bZ);b5=cd>0?cd+"H":"";bZ=b9>0?b9+"M":"";cb="PT"+b5+bZ}else{bV=false}cc=bt.val().split("\n");for(b8=0;b8<cc.length;b8++){b2=cc[b8];if(b2!==""){if(b2.charAt(0)==="!"){b0=true;b2=b2.substr(1)}else{b0=false}bW.push({ingredient:g(x(b2)),hasHeading:b0})}}cc=k.val().split("\n");ca=[];bX={INSTRUCTIONS:[]};for(b8=0;b8<cc.length;b8++){b2=bH.trim(cc[b8].replace(/^[ 0-9\.]*(.*)$/ig,"$1"));if(b2!==""){if(b2.charAt(0)==="!"){if(bX.INSTRUCTIONS.length>0||bX.heading){ca.push(bX)}b2=b2.substr(1);bX={};bX.INSTRUCTIONS=[];bX.heading=x(b2)}else{bX.INSTRUCTIONS.push({instruction:g(x(b2))})}}}if(bX.INSTRUCTIONS.length>0||bX.heading){ca.push(bX)}b2=aw(u);if(b2&&v.wpVersion<"3.5"){b2="<p>"+b2.replace(/\n\n/ig,"</p><p>").replace(/\n/ig,"<br />")+"</p>"}b4={version:v.version,hasPhoto:D!=="",photoURL:D,name:g(x(bw.val())),author:g((aw(w))),preptime:bY,cooktime:b7,totaltime:bV,preptimeISO:b6,cooktimeISO:b1,totaltimeISO:cb,yield:aw(bk),type:g((aw(ba))),cuisine:g((aw(bq))),summary:g(aw(bO)),servesize:aw(bh),calories:aw(m),fat:aw(aB),satfat:aw(bz),unsatfat:aw(aG),transfat:aw(a4),carbs:aw(am),sugar:aw(bE),sodium:aw(e),fiber:aw(B),protein:aw(aW),cholesterol:aw(c),notes:g(b2),INGREDIENTS:bW,STEPS:ca};if(b4.name===""){b4.name=false}b3=aT(v.recipeTemplate,b4);if(P){bH(".hrecipe",aH).remove()}if(aZ===-1){bS=bH(i,aH)}else{bS=bH(".easyrecipe",aH);if(bS.length>0){bS=bH(bS[aZ])}}bS.before(b3);bS.remove();bS=false;bB.show();a9.dialog(l);aX=bH(".easyrecipe",aH).length;br()}function bp(bY,bV,bZ){var bW;var bX;F=false;if(bV.editorId!==aq&&bV.editorId!=="wp_mce_fullscreen"){bH("#"+bV.editorId+"_easyrecipeTest").hide();bH("#"+bV.editorId+"_easyrecipeEdit").hide();bH("#"+bV.editorId+"_easyrecipeAdd").hide();return}if(bV.editorId===aq){aH=bH("#"+aq+"_ifr").contents();ab=10000;bW=bH("#"+aq+"_easyrecipeTest");bB=bH("#"+aq+"_easyrecipeEdit")}else{aH=bH("#wp_mce_fullscreen_ifr").contents();ab=200001;bW=bH("#mce_fullscreen_easyrecipeTest");bB=bH("#mce_fullscreen_easyrecipeEdit")}bm=bH("body",aH);bX=bH(".easyrecipe",aH);Q=tinyMCE.activeEditor;bX.each(function(){bH(this).addClass("mceNonEditable");bH(".ERRatingOuter",this).remove();bH(".ERHDPrint",this).remove();bH(".ERLinkback",this).remove()});aX=bX.length;if(aX>0&&v.testURL!==""){bW.show()}else{bW.hide()}if(aX>0){bB.show()}else{bB.hide()}if(!aH.hasERCSS){bH("head",aH).append('<link rel="stylesheet" type="text/css" href="'+v.easyrecipeURL+'/css/easyrecipe-entry.css" />');aH.hasERCSS=true}br()}function aP(){bb.toggleClass("ERNone");be.toggleClass("ERContract")}function a5(){bo.toggleClass("ERNone");bx.toggleClass("ERContract")}function aM(){if(window.getSelection){return window.getSelection()}if(document.getSelection){return document.getSelection()}if(document.selection){return document.selection.createRange().text}return null}function T(bZ,bX){var b0,bW,bY,bV=/(?:<a( .*?")>)?<img( (?:.*?)?src="([^"]*?)"(?:.*)) \/>/i;bW=bV.exec(bX);b0=bH("#ertmp_"+r,aH);if(bW!==null){Z(bW[3],bN.length);bY=aO.substring(0,bd);if(!bW[1]){bn.push(bW[2]);bY+="[img:"+bn.length+"]"}else{bi.push(bW[1]);bn.push(bW[2]);bY+="[url:"+bi.length+"][img:"+bn.length+"][/url]"}bY+=aO.substring(aI);n.val(bY)}n[0].focus();b0.remove()}function j(bY){var bV,bW,bX,b1,b0,bZ;if(!v.isEntryDialog){return}bV=bH("#ertmp_"+r,aH);if(typeof bY==="string"){bX=bH(bY)}else{bZ=bV.html();if(bZ==="link"){bX=bV.parent("a");bV=bX}else{bX=bH(bV.html())}}if(bX.is("a")){bW=bX.attr("href");b1=bX.attr("title");b0=bX.attr("target");b1=b1?' title="'+b1+'"':"";b0=b0?' target="'+b0+'"':"";bY='href="'+bW+'"'+b0+b1;bi.push(bY);n.val(aO.substring(0,bd)+"[url:"+bi.length+"]"+aO.substring(bd,aI)+"[/url]"+aO.substring(aI))}n[0].focus();bV.remove()}function al(){var bX,bY,bW=false,bV;at()}function an(){F=false;A()}function aN(){F=false;ac()}function a0(){if(aX>0&&!bP){bP=true;bl.dialog(aV,aA,ab);bl.dialog(H)}}function aF(b0){var bX,bY,bZ,bW;var bV=bH("#wp-preview",b0.target).val();if(bV==="dopreview"){return true}if(aX===0){return true}bZ=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden();if(bZ){bY=bH("<div>"+Q.getContent()+"</div>")}else{bW=bH("#wp-content-editor-container").find("textarea");bY=bH("<div>"+bW.val()+"</div>")}h(bH(".easyrecipeWrapper",bY));bH(".easyrecipe",bY).removeClass("mceNonEditable");bX=bH.trim(bY.html());if(bZ){Q.setContent(bX)}else{bW.val(bX)}return true}bH(function(){var bW;var bV=null;v=EASYRECIPE;if(v.button!==bH.fn.button){bV=bH.fn.button;bH.fn.button=v.button}a9=bH("#easyrecipeEntry");L=bH("#easyrecipeUpgrade");bl=bH("#easyrecipeHTMLWarn");aq=v.isGuest?"guestpost":"content";a9.dialog({autoOpen:false,width:655,modal:true,dialogClass:"easyrecipeEntry",close:function(){v.isEntryDialog=false;if(bS&&!N){bS.remove()}bS=false;bH(".easyrecipeEntry").filter(function(){return bH(this).text()===""}).remove()},open:function(){v.isEntryDialog=true;bH(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />');d.tabs({selected:0,select:ak});setTimeout(function(){var bX=bH(".easyrecipeEntry");var bY=bX.offset();if(bY.top<W){bY.top=W;bX.offset(bY)}},250)}});a9.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bH("#divERContainer").show();bl.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeHTMLWarn",close:function(){bH(".easyrecipeHTMLWarn").filter(function(){return bH(this).text()===""}).remove()},open:function(){bH(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bl.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bH(".divERHTMLWarnContainer").show();L.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeUpgrade",close:function(){bH(".easyrecipeUpgrade").filter(function(){return bH(this).text()===""}).remove()},open:function(){bH(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});L.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bH(".divERUPGContainer").show();t=bH("#easyrecipeConvert");y=bH("#divERCNVSpinner");bC=bH("#btnERCNVCancel");bs=bH("#btnERCNVOK");y.hide();t.dialog({autoOpen:false,width:390,modal:true,dialogClass:"easyrecipeConvert",close:function(){bH(".easyrecipeConvert").filter(function(){return bH(this).text()===""}).remove()},open:function(){bH(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bH("#divERCNVContainer").show();t.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bH(window).bind("easyrecipeadd",an);bH(window).bind("easyrecipeedit",aN);bH(window).bind("easyrecipeload",bp);bH(window).bind("easyrecipeimage",T);bH(window).bind("easyrecipeguestimageuploaded",T);a6=bH("#divERNext");V=bH("#btnERButtons");d=bH("#ERDTabs");aE=bH("#divERPhotos");bH("input:submit",".easyrecipeUI").button();f=bH("#ed_toolbar");bw=bH("#inpERName");w=bH("#inpERAuthor");ba=bH("#inpERType");bq=bH("#inpERCuisine");aR=bH("#inpERTags");bO=bH("textarea#taERSummary");bt=bH("textarea#taERIngredients");k=bH("textarea#taERInstructions");av=bH("#inpERPrepTime");aU=bH("#inpERCookTime");bk=bH("#inpERYield");bh=bH("#inpERServeSize");m=bH("#inpERCalories");aB=bH("#inpERFat");bz=bH("#inpERSatFat");aG=bH("#inpERUnsatFat");a4=bH("#inpERTransFat");am=bH("#inpERCarbs");bE=bH("#inpERSugar");e=bH("#inpERSodium");B=bH("#inpERFiber");aW=bH("#inpERProtein");c=bH("#inpERCholesterol");u=bH("textarea#taERNotes");C=bH("#divERAddImageURL");bW=bH("#lnkERPhotoURL");bv=bH(".ERTimeError");bM=bH("#divERAdd");by=bH("#divERChange");K=bH("#divERHeader");bb=bH("#divEROther");be=bH("#divEROtherLabel");bo=bH("#divERNotes");bx=bH("#divERNotesLabel");ap=bH("#ERDPasteTab");ax=bH("#fldERAPUImageURL");bH("#btnERAdd").click(aS);bH("#btnERNext").click(a);bH("#btnERChange").click(aS);bH("#btnERDelete").click(q);bH("#btnERCancel").click(a3);bW.click(function(){L.dialog(aV,aA,ab);L.dialog(H)});bH("#btnERAIUCancel").click(function(){C.hide()});bH("#btnERAIUOK").click(ad);be.click(aP);bx.click(a5);av.change(function(bX){S(bH(bX.target))});aU.change(function(bX){S(bH(bX.target))});bH("#btnERPaste").click(ai);W=bH("#wpadminbar").height();a1=bH("#divEREditBtns").on("mousedown","li",al);bH('#divERContainer input[type="text"], #divERContainer textarea').on("blur",function(){ag=null}).on("focus",function(){ag=bH(this)});bH("#wp-link").bind("wpdialogclose",j);bu=A;bQ=ac;U=false;v.insertLink=j;v.insertUploadedImage=T;a7=bK;aa=Z;v.addListener=br;bl.find("input").on(ao,function(){bl.dialog(l)});bH("#wp-content-editor-tools").on(ao,"#content-html",a0);bH("#post").on("submit",aF);if(bV!==null){bH.fn.button=bV}})}(jQuery));