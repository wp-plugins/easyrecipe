(function(h){var f,k;tinymce.create("tinymce.plugins.EasyRecipe",{init:function(e,l){f=tinymce.VK||tinymce.util.VK;l=l.replace(/js$/g,"images/");e.onSaveContent.add(function(d,a){});e.onLoadContent.add(function(d,a){"mce_fullscreen"!==d.editorId&&h(window).trigger("easyrecipeload",[d,a])});e.onSetContent.add(function(d,a){"mce_fullscreen"!==d.editorId||a.initial||h(window).trigger("easyrecipeload",[d,a])});e.addButton("easyrecipeEdit",{title:"Edit an EasyRecipe",image:l+"chef20edit.png",onclick:function(){h(window).trigger("easyrecipeedit")}});
e.addButton("easyrecipeAdd",{title:"Add an EasyRecipe",image:l+"chef20add.png",onclick:function(){h(window).trigger("easyrecipeadd")}});e.addButton("easyrecipeTest",{title:"Test Rich Snippet Formatting at Google",image:l+"google.png",onclick:function(){""!==k.testURL&&window.open("http://www.google.com/webmasters/tools/richsnippets?url="+k.testURL)}});e.onKeyDown.addToTop(function(d,a){function e(a){var b;if(1===a.nodeType){if((b=a.getAttribute(p))&&"inherit"!==b)return b;b=a.contentEditable;if("inherit"!==
b)return b}return null}function k(a){for(var b;a;){if(b=e(a))return"false"===b?a:null;a=a.parentNode}}function l(a){var b,c;if(n.isCollapsed()){b=n.getRng(!0);c=b.startContainer;b=b.startOffset;var g;a:{for(g=c;g;){if(g.id===q)break a;g=g.parentNode}g=void 0}c=g||c;if(k(c))return!1;if(3==c.nodeType&&(a?0<b:b<c.nodeValue.length))return!0;1==c.nodeType&&(c=c.childNodes[b]||c);a:{b=d.schema.getNonEmptyElements();for(g=new tinymce.dom.TreeWalker(c,d.getBody());(c=a?g.prev():g.next())&&!b[c.nodeName.toLowerCase()]&&
!(3===c.nodeType&&0<tinymce.trim(c.nodeValue).length);)if("false"===e(c)){a=!0;break a}a=k(c)?!0:!1}if(a)return!1}return!0}var m,n=d.selection,q="mce_noneditablecaret",p="data-mce-contenteditable";return a.keyCode!=f.BACKSPACE&&a.keyCode!=f.DELETE||l(a.keyCode==f.BACKSPACE)?a.keyCode!=f.LEFT&&a.keyCode!=f.RIGHT&&a.keyCode!=f.UP&&a.keyCode!=f.DOWN&&(m=d.selection.getNode(),m=h(m),m.hasClass("mceNonEditable"))?tinymce.dom.Event.cancel(a):!0:(a.preventDefault(),!1)});e.onBeforeExecCommand.add(function(d,
a,e,f){if("mceInsertLink"===a&&k.isEntryDialog)return k.insertLink(f),!1;"mceInsertContent"===a&&(a=d.selection.getNode(),a=h(a),a=a.hasClass("easyrecipe")?a:a.parents(".easyrecipe"),0<a.length&&(a=h("<p>Stuff</p>").insertAfter(a),d.selection.select(a[0])));return!0});e.onPreProcess.add(function(d,a){a.get&&h(".value-title, .ERRatingInner",a.node).html("#ERDeleteMe#")});e.onPostProcess.add(function(d,a){a.get&&(a.content=a.content.replace(/#ERDeleteMe#/ig," "))})},getInfo:function(){return{longname:"EasyRecipe",
author:"The Orgasmic Chef",authorurl:"http://www.orgasmicchef.com",infourl:"http://www.easyrecipeplugin.com/",version:"1.2"}}});k=EASYRECIPE;tinymce.PluginManager.add("easyrecipe",tinymce.plugins.EasyRecipe)})(jQuery);
