(function(f){var h,k;tinymce.create("tinymce.plugins.EasyRecipe",{init:function(d,l){h=tinymce.VK||tinymce.util.VK;l=l.replace(/js$/g,"images/");d.onSaveContent.add(function(b,a){});d.onLoadContent.add(function(b,a){"mce_fullscreen"!==b.editorId&&f(window).trigger("easyrecipeload",[b,a])});d.onSetContent.add(function(b,a){"mce_fullscreen"!==b.editorId||a.initial||f(window).trigger("easyrecipeload",[b,a])});d.addButton("easyrecipeEdit",{title:"Edit an EasyRecipe",image:l+"chef20edit.png",onclick:function(){f(window).trigger("easyrecipeedit")}});
d.addButton("easyrecipeAdd",{title:"Add an EasyRecipe",image:l+"chef20add.png",onclick:function(){f(window).trigger("easyrecipeadd")}});d.addButton("easyrecipeTest",{title:"Test Rich Snippet Formatting at Google",image:l+"google.png",onclick:function(){""!==k.testURL&&window.open("http://www.google.com/webmasters/tools/richsnippets?url="+k.testURL)}});d.onKeyDown.addToTop(function(b,a){function d(a){var b;if(1===a.nodeType){if((b=a.getAttribute(p))&&"inherit"!==b)return b;b=a.contentEditable;if("inherit"!==
b)return b}return null}function k(a){for(var b;a;){if(b=d(a))return"false"===b?a:null;a=a.parentNode}}function l(a){var g,c;if(n.isCollapsed()){g=n.getRng(!0);c=g.startContainer;g=g.startOffset;var e;a:{for(e=c;e;){if(e.id===q)break a;e=e.parentNode}e=void 0}c=e||c;if(k(c))return!1;if(3==c.nodeType&&(a?0<g:g<c.nodeValue.length))return!0;1==c.nodeType&&(c=c.childNodes[g]||c);a:{g=b.schema.getNonEmptyElements();for(e=new tinymce.dom.TreeWalker(c,b.getBody());(c=a?e.prev():e.next())&&!g[c.nodeName.toLowerCase()]&&
!(3===c.nodeType&&0<tinymce.trim(c.nodeValue).length);)if("false"===d(c)){a=!0;break a}a=k(c)?!0:!1}if(a)return!1}return!0}var m,n=b.selection,q="mce_noneditablecaret",p="data-mce-contenteditable";return a.keyCode!=h.BACKSPACE&&a.keyCode!=h.DELETE||l(a.keyCode==h.BACKSPACE)?a.keyCode!=h.LEFT&&a.keyCode!=h.RIGHT&&a.keyCode!=h.UP&&a.keyCode!=h.DOWN&&(m=b.selection.getNode(),m=f(m),m.hasClass("mceNonEditable"))?tinymce.dom.Event.cancel(a):!0:(a.preventDefault(),!1)});d.on("BeforeExecCommand",function(b){var a;
"mceInsertLink"===b.command&&k.isEntryDialog?(k.insertLink(b.value),b.preventDefault()):("mceInsertContent"===b.command&&(a=d.selection.getNode(),a=f(a),a=a.hasClass("easyrecipe")?a:a.parents(".easyrecipe"),0<a.length&&(a=f("<p>Stuff</p>").insertAfter(a),d.selection.select(a[0]))),"mceInsertLink"===b.command&&b.preventDefault())});d.onBeforeExecCommand.add(function(b,a,d,f){});d.onPreProcess.add(function(b,a){a.get&&f(".value-title, .ERRatingInner",a.node).html("#ERDeleteMe#")});d.onPostProcess.add(function(b,
a){a.get&&(a.content=a.content.replace(/#ERDeleteMe#/ig," "))})},getInfo:function(){return{longname:"EasyRecipe",author:"The Orgasmic Chef",authorurl:"http://www.orgasmicchef.com",infourl:"http://www.easyrecipeplugin.com/",version:"1.2"}}});k=EASYRECIPE;tinymce.PluginManager.add("easyrecipe",tinymce.plugins.EasyRecipe)})(jQuery);
