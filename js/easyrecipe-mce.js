/*! EasyRecipe 3.2.2929 Copyright (c) 2015 BoxHill LLC */
!function(e){var n,t,o="mceNonEditable",i=null,a=!1;tinymce.create("tinymce.plugins.EasyRecipe",{init:function(r,c){n=tinymce.VK||tinymce.util.VK,c=c.replace(/js$/g,"images/"),r.onSaveContent.add(function(){}),r.onLoadContent.add(function(n,t){"mce_fullscreen"!==n.editorId&&e(window).trigger("easyrecipeload",[n,t])}),r.onSetContent.add(function(n,t){"mce_fullscreen"!==n.editorId||t.initial||e(window).trigger("easyrecipeload",[n,t])}),r.addButton("easyrecipeEdit",{title:"Edit an EasyRecipe",image:c+"chef20edit.png",onclick:function(){e(window).trigger("easyrecipeedit")}}),r.addButton("easyrecipeAdd",{title:"Add an EasyRecipe",image:c+"chef20add.png",onclick:function(){e(window).trigger("easyrecipeadd")}}),r.addButton("easyrecipeTest",{title:"Test Rich Snippet Formatting at Google",image:c+"google.png",onclick:function(){""!==t.testURL&&window.open("http://www.google.com/webmasters/tools/richsnippets?url="+t.testURL)}}),r.onKeyDown.addToTop(function(r,c){var d,s,l,g,u,p;if(c.keyCode===n.BACKSPACE){if(p=r.dom.getParent(r.selection.getStart(),function(e){return r.dom.hasClass(e,o)}),u=r.dom.getParent(r.selection.getEnd(),function(e){return r.dom.hasClass(e,o)}),p||u)return tinymce.dom.Event.cancel(c)}else if(c.keyCode===n.DELETE){if(l=r.selection.getNode(),g=e(l),g.hasClass(o))return tinymce.dom.Event.cancel(c);if(i=e(l.nextSibling),!i.hasClass(o))return!0;if(s=r.selection.getRng(),d=s.endContainer.length||0,console.log("offset: "+s.endOffset+"  len: "+d),s.endOffset===d)return tinymce.dom.Event.cancel(c);if("P"===l.parentNode.nodeName&&1==l.parentNode.children.length&&!a&&e(l.parentNode.nextSibling).hasClass(o))return l.parentNode.parentNode.removeChild(l.parentNode),t.addListener(),tinymce.dom.Event.cancel(c)}return!0}),r.onKeyUp.addToTop(function(i,r){var c,d,s;r.keyCode===n.DELETE?(s=i.selection.getNode(),-1!==e(s).text().indexOf("_ERSTOP_")&&(i.undoManager.undo(),t.addListener()),c=e("#ERStop",i.getDoc()),c.remove(),a=!1):r.keyCode===n.BACKSPACE&&(c=i.dom.getParent(i.selection.getStart(),function(e){return i.dom.hasClass(e,o)}),d=i.dom.getParent(i.selection.getEnd(),function(e){return i.dom.hasClass(e,o)}),(c||d)&&(i.undoManager.undo(),t.addListener()))}),r.onBeforeExecCommand.add(function(n,o,i,a){var r,c,d,s;return"mceInsertLink"===o&&t.isEntryDialog&&"string"!==e.type(a)?(t.insertLink(a),!1):("mceInsertContent"===o&&(r=n.selection.getNode(),c=e(r),d=c.hasClass("easyrecipe")?c:c.parents(".easyrecipe"),d.length>0&&(s=e("<p>Stuff</p>").insertAfter(d),n.selection.select(s[0]))),!0)}),r.onPreProcess.add(function(n,t){t.get&&e(".value-title, .ERRatingInner",t.node).html("#ERDeleteMe#")}),r.onPostProcess.add(function(e,n){n.get&&(n.content=n.content.replace(/#ERDeleteMe#/gi," "))})},getInfo:function(){return{longname:"EasyRecipe",author:"The Orgasmic Chef",authorurl:"http://www.orgasmicchef.com",infourl:"http://www.easyrecipeplugin.com/",version:"1.2"}}}),t=EASYRECIPE,tinymce.PluginManager.add("easyrecipe",tinymce.plugins.EasyRecipe)}(jQuery);