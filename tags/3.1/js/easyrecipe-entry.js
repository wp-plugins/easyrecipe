(function $main(bG){var H=jQuery.trim;var R,S,bv,bO,bs,k,ax,aV,bk,at;var w,ba,bp,aS,bu,N=false,Q,bz,bR,O,f;var bH=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i;var o=/^#([_a-z][_0-9a-z]{0,19})#/im;var b=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m;var bc=/^([^<]*)/,s=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,aB=/^([0-9]+)$/;var bQ=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)\](.*)/;var a8,a2,bt,bP,V;var au=/PT(?:([0-9]*)+H)?([0-9]+)+M/i;var ak=/\[(?:img) +(?:[^\]]+?)\]/ig;var P=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i;var a0=/(.*)(?:^| )photo(?: |$)(.*)/ig;var am=/class\s*=\s*"([^"]+)"/ig;var bg=/src\s*=\s*" *([^"]+?) *"/i;var bi=[];var bm=[];var aF='<input type="button" class="ed_button" value="EasyRecipe" />',E="Use the Visual Editor to add or edit an EasyRecipe";var bd,aJ,aP,ah=null,r=0,n,v;var aL='<div class="easyrecipeholder">EasyRecipe</div>',i=".easyrecipeholder",aK="ERSeparator";var a9,M,F,t,aI=null,bl,ac,bK,aW="option",aC="zIndex",d,W,a6,bN,aG;var ar,y,bB,br,bM,bx,L,bb,be,bn,bw;var bh,m,aD,by,aH,a4,ao,bD,e,B,aX,c,u,bA;var aY,J=true,C,az,bE,X,a1;var l="close",aq="click",aM="undefined",I="open",aR="ERPhotoSelected",af="http://www.easyrecipeplugin.com/checkUpdates.php";var aw='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>';var bf,aE=-1,aA=-2,D="",bj,ai="&nbsp;",a7,ab,G;function al(bT,bU){W.show();a1.hide();a6.show();switch(bU.index){case 0:a1.css("right","10px");a1.show();break;case 3:a1.css("right","inherit");a6.hide();a1.show();break;case 4:W.hide();break}}function bC(bT){return bT?bT.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," "):""}function x(bT){return bT?bG("<div />").text(bT).html():""}function ay(bT){return bG.trim(x(bT.val()))||false}function a(bU,bV){var bT=d.tabs("option","selected");d.tabs("option","selected",++bT)}function ag(bU){var bW,bT=/\[img +(.*?) *\/?\]/i,bV=/\[url ([^\]]+)\](.*?\[\/url\])/i;bW=bT.exec(bU);while(bW!==null){bm.push(bW[1]);bU=bU.replace(bT,"[img:"+bm.length+"]");bW=bT.exec(bU)}bW=bV.exec(bU);while(bW!==null){bi.push(bW[1]);bU=bU.replace(bV,"[url:"+bi.length+"]$2");bW=bV.exec(bU)}return bU}function g(bU){var bX,bW,bT=/\[img:(\d+)\]/i,bV=/\[url:(\d+)\](.*?)\[\/url\]/i;bW=bT.exec(bU);while(bW!==null){bX=bm[bW[1]-1];bU=bU.replace(bT,"[img "+bX+"]");bW=bT.exec(bU)}bW=bV.exec(bU);while(bW!==null){bX=bi[bW[1]-1];bU=bU.replace(bV,"[url "+bX+"]$2[/url]");bW=bV.exec(bU)}return bU}function aU(cn,b9){var cf=0,ca=1,bT=2,cp;var cg,b7,b0,b6="",b5="",ci,bU,bX,ch,ck;var cj="<!-- START REPEAT ",cr="<!-- START INCLUDEIF ",cq="<!-- END INCLUDEIF ";var bW,bV,b2,cm,cd,b1,b8,ce,co,b4;var bY,cc,cl;var b3,cb,bZ;cp=cn;b9=b9||{};while(true){ci=cp.length;bU=cp.indexOf("#",b6);if(bU!==-1){ci=bU;bX=cf}ch=cp.indexOf(cj,b6);if(ch!==-1&&ch<ci){ci=ch;bX=ca}ck=cp.indexOf(cr,b6);if(ck!==-1&&ck<ci){ci=ck;bX=bT}if(ci===cp.length){return b5+cp.substr(b6)}bW=ci-b6;b5+=cp.substr(b6,bW);b6=ci;switch(bX){case bT:b7=cp.substr(b6,44);b0=bH.exec(b7);if(b0!==null){bV=b0[1];b2=bV!=="!";cm=b0[2]}else{break}cd=cq+bV+cm+" -->";b1=cd.length;b8=cp.indexOf(cd);if(b8===-1){b6++;break}ce=typeof b9[cm]!==aM&&b9[cm]!==false;if(ce===b2){co="<!-- START INCLUDEIF "+bV+cm+" -->";b4=co.length;cp=cp.substr(0,b6)+cp.substr(b6+b4,b8-b6-b4)+cp.substr(b8+b1)}else{cp=cp.substr(0,b6)+cp.substr(b8+b1)}break;case cf:b7=cp.substr(b6,22);b0=o.exec(b7);if(b0===null){b5+="#";b6++;continue}bY=b0[1];if(b9[bY]!==""&&!b9[bY]){b5+="#"+bY+"#";b6+=bY.length+2;continue}b5+=b9[bY];b6+=bY.length+2;break;case ca:b7=cp.substr(b6,45);b0=b.exec(b7);if(b0===null){b5+="<";b6++;continue}cc=b0[1];if(!b9[cc]||!(b9[cc] instanceof Array)){b5+="<";b6++;continue}b6+=cc.length+22;cl=cp.indexOf("<!-- END REPEAT "+cc+" -->",b6);if(cl===-1){b5+="<!-- START REPEAT "+cc+" -->";continue}b3=cl-b6;cb=cp.substr(b6,b3);bZ=b9[cc];for(cg=0;cg<bZ.length;cg++){b5+=aU(cb,bZ[cg])}b6+=cc.length+b3+20;break}}}function T(bX){var bT=bG.trim(bX.val()),bU=0,bW=0,bV,bY;bu.hide();if(bT===""){return true}bK=s.exec(bT);if(bK===null){bK=aB.exec(bT);if(bK===null){bu.show();return false}bU=0;bW=bK[1]}else{bU=bK[1]?parseInt(bK[1],10):0;bW=bK[2]?parseInt(bK[2],10):0}if(bU===0&&bW===0){bX.val("")}else{bV=bU>0?bU+" hour":"";if(bU>1){bV+="s"}bY=bW>0?bW+" min":"";if(bW>1){bY+="s"}bX.val(bG.trim(bV+" "+bY))}return true}function p(bX){var bU,bT,bV,bW="";for(bU=0;bU<bX.length;bU++){bT=bX[bU];if(bT.nodeType===3){bV=bG.trim(bT.nodeValue);if(bV!==""){bW+=bV+"\n"}continue}if(bT.nodeType!==1){continue}if(bT.childNodes.length>0){bW+=p(bT.childNodes)}}return bW}function bI(){bG(i,aI).remove();var bU=tinyMCE.activeEditor;var bT=R.selection.getNode();if(bT.nodeName==="#document"){bT=bl[0]}if(bT.nodeName.toUpperCase()==="BODY"){if(!bG(bT).hasClass("mceContentBody")){bT=bl[0]}bG(bT).append("&nbsp;"+aL)}else{while(bT.parentNode&&bT.parentNode.nodeName.toUpperCase()!=="BODY"){bT=bT.parentNode}if(!bT.parentNode){bT=bl[0];bG(bT).append("&nbsp;"+aL)}else{if(bT.nodeName.toUpperCase()==="DIV"||bT.nodeName.toUpperCase()==="SPAN"){bG(bT,aI).after(aL)}else{bG(bT,aI).before(aL)}}}return bG(i,aI)}function Y(bT,bV,bU){}function Z(bU,bV,bT){switch(bU.type){case"js":bG("head").append(bG('<script type="text/javascript">'+bU.js+"<\/script>"));v[bU.f]();break;case"html":bG(bU.dest).html(bU.html);break}}function bS(){bB.unbind(aq);br.unbind(aq);t.dialog(l);N=true;bt()}function K(bX,bU){var bW,bT="",bV=bX.recipe;if(bU!=="success"){t.dialog(l);N=true;bt()}bv.val(bC(bV.recipe_title));D=bV.recipe_image;ba.val("");w.val("");bp.val("");aS.val("");bO.val(bC(bV.summary));bK=au.exec(bV.prep_time);if(bK!==null){bW=bK[1]?bK[1]+"h ":"";ax.val(bW+bK[2]+"m")}else{ax.val(bC(bV.prep_time))}bK=au.exec(bV.cook_time);if(bK!==null){bW=bK[1]?bK[1]+"h ":"";aV.val(bW+bK[2]+"m")}else{aV.val(bC(bV.cook_time))}bk.val(bC(bV.yield));m.val(bC(bV.calories));aD.val(bC(bV.fat));bh.val(bC(bV.serving_size));for(bW=0;bW<bX.ingredients.length;bW++){bT+=H(bC(bX.ingredients[bW]))+"\n"}bs.val(bT);k.val(bC(bV.instructions.replace("\r","")));u.val(bC(bV.notes));a9.dialog("option","title","Update Recipe");t.dialog(l);bM.hide();bx.show();ar.hide();if(D!==""){ab(D,bN.length,true)}bR=bI();a9.dialog(aW,aC,ac);a9.dialog(I)}function aZ(){y.show();bB.unbind(aq);br.unbind(aq);var bT={action:"EasyRecipeConvert",id:a8,type:a2};bG.post(ajaxurl,bT,K,"json")}function z(b0){var b1,bY,b2,bZ=0,bT,bX="",bV="",bU="",bW="";bT=bG("<div>"+b0+"</div>");b1=p(bT[0].childNodes);b1=b1.split("\n");for(bY=0;bY<b1.length;bY++){b2=bG.trim(b1[bY]);if(b2===""){continue}if(/^(?:instruction|method|cooking method|procedure)/i.test(b2)){bZ=2;continue}if(/^Ingredient/i.test(b2)){bZ=1;continue}if(/^(?:note|cooking note)s?\s*$/i.test(b2)){bZ=3;continue}switch(bZ){case 0:bX+=b2+"\n";break;case 1:bV+=b2+"\n";break;case 2:bU+=b2+"\n";break;case 3:bW+=b2+"\n";break}}return{summary:bX,ingredients:bV,instructions:bU,notes:bW}}function av(bT){M.dialog(aW,aC,ac);M.dialog(I)}function aa(bW,bT,bU){var bX=function(){var bY,b2,b1,bZ,b0=bG.data(this,"index");bY=this.width/150;b2=this.height/112;bY=bY>b2?bY:b2;b1=Math.floor(this.height/bY);bZ=Math.floor(this.width/bY);bN[b0].height(b1);bN[b0].width(bZ);bN[b0].css("top",(112-b1)/2);bN[b0].attr("src",this.src);if(b0===0){bG("#ERDTabs .divERNoPhotos").remove()}};aG.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+bT+'" /></div>');bN[bT]=bG("#ERPhoto_"+bT,aG);bN[bT].data("src",bW);if(bU){bG(".ERPhoto",aG).removeClass(aR);bN[bT].parent().addClass(aR);bE=bT;D=bW}if(bj===""){bj=bW}var bV=new Image();bG.data(bV,"index",bT);bV.onload=bX;bV.src=bW}function ae(){aa(az.val(),bN.length,true);az.val("");C.hide();bG(".divERNoPhotos").remove()}function ad(b8,cb){var cc,bT,b7,b6,b2,b1,b3,b4,cd;var bW={},b0="",bU="",bV="",b5="",ca;if(cb===aE&&aY!==0){av();return}if(b8&&b8.data===aA){cb=aA;b8=b8.delegateTarget}aY=1;bR=bG(".easyrecipe:first",aI);if(cb!==aE&&bR.length>1){bR=bG(bR[cb])}b3=bG.support.cors?"json":"jsonp";bG.ajax(af,{dataType:b3,data:{v:v.version},success:Z,error:Y});S=false;if(typeof tinyMCE!==aM){if(tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()){S=true}}if(!S){alert("You must use the Visual Editor to add or update an EasyRecipe");return}bv.val("");ba.val("");bp.val("");aS.val("");w.val("");bO.val("");ax.val("");aV.val("");bk.val("");bs.val("");k.val("");bh.val("");m.val("");aD.val("");by.val("");aH.val("");a4.val("");ao.val("");bD.val("");e.val("");B.val("");aX.val("");c.val("");u.val("");if(cb!==aE&&bR.length===1){a9.dialog("option","title","Update Recipe");ar.hide();bM.hide();bx.show();O=true}else{bz=R.getContent();if(!N){b2=bQ.exec(bz);if(b2){a2=b2[2];a8=b2[3];y.hide();bB.click(bS);br.click(aZ);var bX=a2==="recipeseo"?"RecipeSEO":"ZipList";b6=bG("#txtERCNVText1",t);b6.html(b6.html().replace("#plugin#",bX));aG.html("");bE=-1;bN=[];aG.html(aw);t.dialog(aW,aC,ac);t.dialog(I);return}}if(v.isGuest){w.val(bG("#inpERAuthor").val())}bM.show();bx.hide();ar.show();a9.dialog("option","title","Add a New Recipe");O=false;if(V!==false){bW=z(V)}else{ca=R.selection.getContent();if(ca.length>20){bW=z(ca)}}if(bW.summary){b0=bW.summary}if(bW.ingredients){bU=bW.ingredients}if(bW.instructions){bV=bW.instructions}if(bW.notes){b5=bW.notes}bR=bI()}bG("#inpERCuisine").autocomplete({source:bG.parseJSON(v.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');bG("#inpERType").autocomplete({source:bG.parseJSON(v.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />');Q=false;if(bG(".hrecipe",aI).length>0){if(confirm("This post is already hrecipe microformatted\n\nDo you want me to try to convert it to an EasyRecipe?")){Q=true}}bf=(cb!==aE)?bR.find(".endeasyrecipe").text():v.version;if(bf===""){bf="2.2"}D=bG('link[itemprop="image"]',bR).attr("href")||"";aG.html("");bE=-1;bj="";bN=[];aI.find("img").each(function(ce){var cf=false;if(bf<"3"){if(bG(this).hasClass("photo")){cf=true}}else{cf=this.src===D}aa(this.src,ce,cf)});var b9=aI.contents().text();b2=ak.exec(b9);b4=bN.length;while(b2!==null){var bZ,bY=bg.exec(b2[0]);if(bY!==null){bZ=bY[1];aa(bZ,b4);if(bf>"3"){if(D===bZ){bN[b4].parent().addClass(aR);bE=b4}}else{if(P.test(b2[0])){bN[b4].parent().addClass(aR);bE=b4;D=bZ}}b4++}b2=ak.exec(b9)}if(D!==""){bT=false;for(cc=0;cc<bN.length;cc++){if(bN[cc].data("src")===D){bT=true;break}}if(!bT){aa(D,bN.length,true)}}if(bE===-1&&bN.length>0){bE=0;D=bj;bN[0].parent().addClass(aR)}aG.click(function(ce){M.dialog(aW,aC,ac);M.dialog(I)});if(bN.length===0){aG.html(aw)}else{if(bE===-1){bN[0].parent().addClass(aR)}}bm=[];bi=[];if(bf>"3"){cd=bR.find(".ERName").html()}else{cd=bR.find(".fn").html()}if(typeof cd===aM||!cd){bv.val(ag(bC(bG("#title").val())))}else{bv.val(ag((bC(cd))))}ba.val(ag(bC(bR.find(".type").html())));w.val(ag(bC(bR.find(".author").html())));if(w.val()===""){w.val(ag(bG.parseJSON(v.author)))}bp.val(ag(bC(bR.find(".cuisine").html())));bO.val(ag(b0+bC(bR.find(".summary").html())));if(bf>"3"){b1=bR.find('time[itemprop="prepTime"]').html()||"";ax.val(bC(b1));b1=bR.find('time[itemprop="cookTime"]').html()||"";aV.val(bC(b1))}else{b1=bR.find(".preptime").html()||"";b2=bc.exec(b1);if(b2!==null){ax.val(bC(b2[1]))}else{ax.val("")}b1=bR.find(".cooktime").html()||"";b2=bc.exec(b1);if(b2!==null){aV.val(bC(b2[1]))}else{aV.val("")}}bk.val(bC(bR.find(".yield").html()));bR.find(".ingredients li").each(function(cf,ce){if(bG(ce).hasClass(aK)){bU+="!"+ag(bC(ce.innerHTML))+"\n"}else{bU+=ag(bC(ce.innerHTML))+"\n"}});bs.val(bU);bR.find(".instructions li, .instructions .ERSeparator").each(function(cf,ce){b7=bG.trim(ce.innerHTML.replace(/^[ 0-9.]*(.*)$/ig,"$1"));if(bG(ce).hasClass(aK)){bV+="!"+b7+"\n"}else{bV+=b7+"\n"}});k.val(ag(bC(bV)));bh.val(bC(bR.find(".servingSize").html()));m.val(bC(bR.find(".calories").html()));aD.val(bC(bR.find(".fat").html()));by.val(bC(bR.find(".saturatedFat").html()));aH.val(bC(bR.find(".unsaturatedFat").html()));a4.val(bC(bR.find(".transFat").html()));ao.val(bC(bR.find(".carbohydrates").html()));bD.val(bC(bR.find(".sugar").html()));e.val(bC(bR.find(".sodium").html()));B.val(bC(bR.find(".fiber").html()));aX.val(bC(bR.find(".protein").html()));c.val(bC(bR.find(".cholesterol").html()));b7=(bR.find(".ERNotes").html()||"").replace(/<\/p>\n*<p>/ig,"\n\n").replace(/(?:<p>|<\/p>)/ig,"").replace(/<br *\/?>/ig,"\n");if(b7===""&&b5!==""){b7=b5}u.val(ag(b7));if(G){if(G.name){bv.val(ag((bC(G.name))))}if(G.author){w.val(ag(G.author))}if(G.summary){bO.val(ag(G.summary))}if(G.yield){bk.val(bC(G.yield))}if(G.type){ba.val(ag(bC(G.type)))}if(G.cuisine){bp.val(ag(bC(G.cuisine)))}if(G.prepTime){ax.val(bC(G.prepTime))}if(G.cookTime){aV.val(bC(G.cookTime))}if(G.summary){bO.val(ag(G.summary))}}a9.dialog(aW,aC,ac);a9.dialog(I);a9.dialog("option","position","center")}function A(bT){aY=bG(".easyrecipe",aI).length;if(J||aY===0){ad(bT,aE);return}M.dialog(aW,aC,ac);M.dialog(I)}function a3(){a9.dialog(l)}function q(){var bT=confirm("Are you sure you want to delete this recipe?");if(bT){bR.remove();bR=false}a9.dialog(l)}function aj(){var bT,bU=bG("#inpERPaste").val();bT=z(bU);if(bT.ingredients.length===0&&bT.instructions.length===0){return}V=bU;bG("#inpERPaste").val("");G={name:g(x(bv.val())),author:g((ay(w))),yield:ay(bk),type:g((ay(ba))),cuisine:g((ay(bp))),summary:g(ay(bO)),servesize:ay(bh),prepTime:ax.val(),cookTime:aV.val()};a9.dialog(l);A(null)}function bF(bV){var bU=bG(bV.target).parent();var bW=bU.parent();if(bU.hasClass("easyrecipeAbove")){bW.before(ai)}else{bW.after(ai)}bG(".easyrecipeAbove,.easyrecipeBelow",bW).remove();var bT=bG(".easyrecipe",bW).unwrap();a7(bT)}function bJ(bX){var bU,bT,bW,bV;bW=bX.prev();bV=bX.next();bU=(bW.length===0||bW.hasClass("easyrecipe")||bW.hasClass("easyrecipeWrapper"));if(bU){bU=!(bX[0].previousSibling&&bX[0].previousSibling.nodeType===3)}bT=(bV.length===0||bV.hasClass("easyrecipe")||bV.hasClass("easyrecipeWrapper"));if(bT){bT=!(bX[0].nextSibling&&bX[0].nextSibling.nodeType===3)}if(!bU&&!bT){return}bX.wrap('<div class="easyrecipeWrapper" />');if(bU){bX.parent().prepend('<div class="easyrecipeAbove"><input class="ERInsertLine" type="button" value="Insert line above" /></div>')}if(bT){bX.parent().append('<div class="easyrecipeBelow"><input class="ERInsertLine" type="button" value="Insert line below" /></div>')}bG(".easyrecipeWrapper .ERInsertLine",aI).on(aq,bF)}function h(bT){bG(".easyrecipeAbove,.easyrecipeBelow",bT).remove();bG(".easyrecipe",bT).unwrap()}function bq(){var bT=bG(".easyrecipe",aI);if(bT.length===0){return}bT.on("mousedown",null,aA,ad);h(bG(".easyrecipeWrapper",aI));bT.each(function(){bJ(bG(this))})}function aT(){var b5,bZ="",bW,b4="",bT=0,b9="";var cb,b7,b3,bX,ca,b0,b6,bU=[],bY;if(!T(ax)){return}if(!T(aV)){return}bW=bG.trim(ax.val());if(bW!==""){bK=s.exec(bW);cb=bK[1]?parseInt(bK[1],10):0;b7=bK[2]?parseInt(bK[2],10):0;bT=cb*60+b7;b3=cb>0?cb+"H":"";bX=b7>0?b7+"M":"";b4="PT"+b3+bX}else{bW=false}b5=bG.trim(aV.val());if(b5!==""){bK=s.exec(b5);cb=bK[1]?parseInt(bK[1],10):0;b7=bK[2]?parseInt(bK[2],10):0;b3=cb>0?cb+"H":"";bX=b7>0?b7+"M":"";bT+=cb*60+b7;bZ="PT"+b3+bX}else{b5=false}if(bT>0){cb=Math.floor(bT/60);b7=bT%60;b3=cb>0?cb+" hour":"";if(cb>1){b3+="s"}bX=b7>0?b7+" min":"";if(b7>1){bX+="s"}bT=bG.trim(b3+" "+bX);b3=cb>0?cb+"H":"";bX=b7>0?b7+"M":"";b9="PT"+b3+bX}else{bT=false}ca=bs.val().split("\n");for(b6=0;b6<ca.length;b6++){b0=ca[b6];if(b0!==""){if(b0.charAt(0)==="!"){bY=true;b0=b0.substr(1)}else{bY=false}bU.push({ingredient:g(x(b0)),hasHeading:bY})}}ca=k.val().split("\n");var b8=[];var bV={INSTRUCTIONS:[]};for(b6=0;b6<ca.length;b6++){b0=bG.trim(ca[b6].replace(/^[ 0-9\.]*(.*)$/ig,"$1"));if(b0!==""){if(b0.charAt(0)==="!"){if(bV.INSTRUCTIONS.length>0||bV.heading){b8.push(bV)}b0=b0.substr(1);bV={};bV.INSTRUCTIONS=[];bV.heading=x(b0)}else{bV.INSTRUCTIONS.push({instruction:g(x(b0))})}}}if(bV.INSTRUCTIONS.length>0||bV.heading){b8.push(bV)}b0=ay(u);if(b0){b0="<p>"+b0.replace(/\n\n/ig,"</p><p>").replace(/\n/ig,"<br />")+"</p>"}var b2={version:v.version,hasPhoto:D!=="",photoURL:D,name:g(x(bv.val())),author:g((ay(w))),preptime:bW,cooktime:b5,totaltime:bT,preptimeISO:b4,cooktimeISO:bZ,totaltimeISO:b9,yield:ay(bk),type:g((ay(ba))),cuisine:g((ay(bp))),summary:g(ay(bO)),servesize:ay(bh),calories:ay(m),fat:ay(aD),satfat:ay(by),unsatfat:ay(aH),transfat:ay(a4),carbs:ay(ao),sugar:ay(bD),sodium:ay(e),fiber:ay(B),protein:ay(aX),cholesterol:ay(c),notes:g(b0),INGREDIENTS:bU,STEPS:b8};var b1=aU(v.recipeTemplate,b2);if(Q){bG(".hrecipe",aI).remove()}bR.before(b1);bR.remove();bR=false;bA.show();a9.dialog(l);bq()}function bo(bW,bT,bX){G=false;if(bT.editorId!==at&&bT.editorId!=="wp_mce_fullscreen"){bG("#"+bT.editorId+"_easyrecipeTest").hide();bG("#"+bT.editorId+"_easyrecipeEdit").hide();bG("#"+bT.editorId+"_easyrecipeAdd").hide();return}var bU;if(bT.editorId===at){aI=bG("#"+at+"_ifr").contents();ac=10000;bU=bG("#"+at+"_easyrecipeTest");bA=bG("#"+at+"_easyrecipeEdit")}else{aI=bG("#wp_mce_fullscreen_ifr").contents();ac=200001;bU=bG("#mce_fullscreen_easyrecipeTest");bA=bG("#mce_fullscreen_easyrecipeEdit")}bl=bG("body",aI);var bV=bG(".easyrecipe",aI);R=tinyMCE.activeEditor;bV.each(function(){bG(this).addClass("mceNonEditable");bG(".ERRatingOuter",this).remove();bG(".ERHDPrint",this).remove();bG(".ERLinkback",this).remove()});aY=bV.length;if(aY>0&&v.testURL!==""){bU.show()}else{bU.hide()}if(aY>0){bA.show()}else{bA.hide()}if(!aI.hasERCSS){bG("head",aI).append('<link rel="stylesheet" type="text/css" href="'+v.easyrecipeURL+'/css/easyrecipe-entry.css" />');aI.hasERCSS=true}bq()}function aQ(){bb.toggleClass("ERNone");be.toggleClass("ERContract")}function a5(){bn.toggleClass("ERNone");bw.toggleClass("ERContract")}function aN(){if(window.getSelection){return window.getSelection()}if(document.getSelection){return document.getSelection()}if(document.selection){return document.selection.createRange().text}return null}function U(bX,bV){var bY,bU,bW,bT=/(?:<a( .*?")>)?<img( (?:.*?)?src="([^"]*?)"(?:.*)) \/>/i;bU=bT.exec(bV);bY=bG("#"+r,aI);if(bU!==null){aa(bU[3],bN.length);bW=aP.substring(0,bd);if(!bU[1]){bm.push(bU[2]);bW+="[img:"+bm.length+"]"}else{bi.push(bU[1]);bm.push(bU[2]);bW+="[url:"+bi.length+"][img:"+bm.length+"][/url]"}bW+=aP.substring(aJ);n.val(bW)}n[0].focus();bY.remove()}function j(bW){var bT,bU,bV,bY,bX;if(!v.isEntryDialog){return}bT=bG("#ertmp_"+r,aI);if(typeof bW==="string"){bV=bG(bW)}else{bV=bG(bT.html())}if(bV.is("a")){bU=bV.attr("href");bY=bV.attr("title");bX=bV.attr("target");bY=bY?' title="'+bY+'"':"";bX=bX?' target="'+bX+'"':"";bW='href="'+bU+'"'+bX+bY;bi.push(bW);n.val(aP.substring(0,bd)+"[url:"+bi.length+"]"+aP.substring(bd,aJ)+"[/url]"+aP.substring(aJ))}n[0].focus();bT.remove()}function an(){av()}function ap(){G=false;A()}function aO(){G=false;ad()}function bL(){a9=bG("#easyrecipeEntry");M=bG("#easyrecipeUpgrade");v=EASYRECIPE;at=v.isGuest?"guestpost":"content";a9.dialog({autoOpen:false,width:655,modal:true,dialogClass:"easyrecipeEntry",close:function(){v.isEntryDialog=false;if(bR&&!O){bR.remove()}bR=false;bG(".easyrecipeEntry").filter(function(){if(bG(this).text()===""){return true}return false}).remove()},open:function(bU,bV){v.isEntryDialog=true;var bT=bG(".easyrecipeEntry").offset();bG(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />');d.tabs({selected:0,select:al});setTimeout(function(){var bW=bG(".easyrecipeEntry");var bX=bW.offset();if(bX.top<X){bX.top=X;bW.offset(bX)}},250)}});a9.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bG("#divERContainer").show();M.dialog({autoOpen:false,width:420,modal:true,dialogClass:"easyrecipeUpgrade",close:function(){bG(".easyrecipeUpgrade").filter(function(){if(bG(this).text()===""){return true}return false}).remove()},open:function(bT,bU){bG(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});M.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bG(".divERUPGContainer").show();t=bG("#easyrecipeConvert");y=bG("#divERCNVSpinner");bB=bG("#btnERCNVCancel");br=bG("#btnERCNVOK");y.hide();t.dialog({autoOpen:false,width:390,modal:true,dialogClass:"easyrecipeConvert",close:function(){bG(".easyrecipeConvert").filter(function(){if(bG(this).text()===""){return true}return false}).remove()},open:function(bT,bU){bG(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});bG("#divERCNVContainer").show();t.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');bG(window).bind("easyrecipeadd",ap);bG(window).bind("easyrecipeedit",aO);bG(window).bind("easyrecipeload",bo);bG(window).bind("easyrecipeimage",U);bG(window).bind("easyrecipeguestimageuploaded",U);a6=bG("#divERNext");W=bG("#btnERButtons");d=bG("#ERDTabs");aG=bG("#divERPhotos");bG("input:submit",".easyrecipeUI").button();f=bG("#ed_toolbar");bv=bG("#inpERName");w=bG("#inpERAuthor");ba=bG("#inpERType");bp=bG("#inpERCuisine");aS=bG("#inpERTags");bO=bG("textarea#taERSummary");bs=bG("textarea#taERIngredients");k=bG("textarea#taERInstructions");ax=bG("#inpERPrepTime");aV=bG("#inpERCookTime");bk=bG("#inpERYield");bh=bG("#inpERServeSize");m=bG("#inpERCalories");aD=bG("#inpERFat");by=bG("#inpERSatFat");aH=bG("#inpERUnsatFat");a4=bG("#inpERTransFat");ao=bG("#inpERCarbs");bD=bG("#inpERSugar");e=bG("#inpERSodium");B=bG("#inpERFiber");aX=bG("#inpERProtein");c=bG("#inpERCholesterol");u=bG("textarea#taERNotes");C=bG("#divERAddImageURL");bu=bG(".ERTimeError");bM=bG("#divERAdd");bx=bG("#divERChange");L=bG("#divERHeader");bb=bG("#divEROther");be=bG("#divEROtherLabel");bn=bG("#divERNotes");bw=bG("#divERNotesLabel");ar=bG("#ERDPasteTab");az=bG("#fldERAPUImageURL");bG("#btnERAdd").click(aT);bG("#btnERNext").click(a);bG("#btnERChange").click(aT);bG("#btnERDelete").click(q);bG("#btnERCancel").click(a3);bG("#lnkERPhotoURL").click(function(){M.dialog(aW,aC,ac);M.dialog(I)});bG("#btnERAIUCancel").click(function(){C.hide()});bG("#btnERAIUOK").click(ae);be.click(aQ);bw.click(a5);bG("#inpERPrepTime").change(function(bT){T(bG(bT.target))});bG("#inpERCookTime").change(function(bT){T(bG(bT.target))});bG("#btnERPaste").click(aj);X=bG("#wpadminbar").height();a1=bG("#divEREditBtns").on("mousedown","#divEREditBtns li",an);bG('#divERContainer input[type="text"], #divERContainer textarea').on("blur",function(){ah=null}).on("focus",function(){ah=bG(this)});bG("#wp-link").bind("wpdialogclose",j);bt=A;bP=ad;V=false;v.insertLink=j;v.insertUploadedImage=U;a7=bJ;ab=aa}bG(bL)}(jQuery));